---
title: This schema shows all available roles (including system and custom roles) under the current tenant.
order: 5
---

# This view keeps track of the total Body size of the HTTP response.

## Continue traversing backwards until the next non-missing value is encountered.

### Frame is a subset of the current partition, which further subdivides windows in the partition.

| `UNION` will de-duplicate the merged result set.&#xA;`UNION ALL` will retain the same data in the merged result set.&#xA;`EXCEPT` will make the difference between the two result sets, return all non-duplicate values not found in the right query from the left query.&#xA;`INTERSECT` returns the intersection of the two result sets (that means, all non-duplicate values are returned by both queries). | Calculate the skewness value of the specified dimension after the two-dimensional statistical aggregation, and the method is `population`.                  | This schema is only visible to the Owner of the current tenant. |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------- |
| BIGINT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | COUNT(field) Returns the number of non-null values.                                                                                      | 8字节                                                                             |
| BIGINT UNSIGNED                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | This schema displays information about the role of the current user under the current tenant.                                                               | 8字节                                                                             |
| BOOLEAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Stream QUERY statements are persisted and are cancelled by [KILL QUERY](#kill-query).                                                                       | 1字节                                                                             |
| TIMESTAMP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Status of SQL, including: ACCEPTING,DISPATCHING,ANALYZING,OPTMIZING,SCHEDULING                                                                              | 8字节                                                                             |
| STRING                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | This schema allows you to query information about all users in the cluster.                                                                                 | ***                                                                             |
| DOUBLE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | WHERE sets conditions on the selected column before the GROUP BY clause, while HAVING clause sets conditions on the group generated by the GROUP BY clause. | 8字节                                                                             |

#### ROLLUP generates all grouping sets that are meaningful in this hierarchy. Whenever the value of column_1 changes, it will generate a subtotal line;

Calculate the ratio of Gauge change and time change.

| This is the first step in analyzing the Gauge data. Create intermediate aggregates using gauge_agg,&#xA;The other functions then use the intermediate aggregated data for their calculations. | Changing to an existing series is not supported (all tag column values make up series).                                                                                                                                                                    | The covariance after aggregation of 2-D statistics is calculated. |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------- |
| BINARY                                                                                                                                                                                                                                             | This schema shows all permissions on db that have been granted to the specified role under the tenant.                                                                                                                                                                        | **Start the CLI**                                                                 |
| INTERVAL                                                                                                                                                                                                                                           | The precedence levels of the operators are given in the following table. Operators at higher levels are evaluated before operators at lower levels. In the following table, 1 represents the highest level and 8 represents the lowest level. | Field Name                                                                        |
| ARRAY                                                                                                                                                                                                                                              | For non-owner elements, only the records for the corresponding role are displayed.                                                                                                                                                                                            | `INTERVAL '1 YEAR'` One year(12 months)                        |

#### The SELECT clause of a stream query does not support `JOIN`.

| Get Gauge changes over a period of time. This is simply increment, calculated by subtracting the last value seen from the first value. | SHARD: represents the number of data partitions, defaults to 1. | Calculate the number of data rows after two-dimensional statistical aggregation                                                                                                |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| BIGINT                                                                                                                                                                 | \[{+\-}\]123                             | For regular users, only the part of the table in USAGE_SCHEMA that belongs to the current user tenant will be visible.                    |
| BIGINT UNSIGNED                                                                                                                                                        | \[+]123                                    | All records of this schema are visible to all members of the current tenant.                                                                                   |
| DOUBLE                                                                                                                                                                 | 123.45                                                                          | The database belongs to a tenant. When a tenant is created, the database is automatically created and visible to all members under the tenant. |
| BOOLEAN                                                                                                                                                                | {true \| false \| t \| f}                                                                       |                                                                                                                                                                                |
| STRING                                                                                                                                                                 | 'abc'                                                                                           | The CLUSTER_SCHEMA database belongs to the cluster, only the administrator users have the access to the database.                         |
| TIMESTAMP                                                                                                                                                              | TIMESTAMP '1900-01-01T12:00:00Z'                                | Join Operation                                                                                                                                                                 |
| Geometry                                                                                                                                                               | Name of the system role that the custom role inherits from, or NULL if it is a system role      | candlestick_agg gets the open and close price of the stock and the high price.                                                            |
| --                                                                                                                                                                     | NULL                                                                                            | At present, we support altering common tables.                                                                                                                 |

#### To further study CnosDB, this section will provide sample data for you to download and teach you how to import data into the database. The data sources referenced in the following chapters are all from this sample data.

If the VALUES list requires an expression, please use the [INSERT SELECT](./sql.md#insert-query-results-insert-select) syntax.

`EXPLAIN ANALYZE VERBOSE` executes the query and displays a more detailed execution plan, including the number of rows read.

You can use the ROLLUP option in a single query to generate multiple group sets.

In order to query more efficiently, the order of each row may not be the same for queries without specified sorting.

Generate intermediate aggregate data CandleStackData from the original quote query.

- The SQL statement above is equivalent to inserting the following k-v pairs into the database.
- Instruction
- Download Data
- You can use the keyword `AS` to alias a column expression or table.
- Get the highest price.
- This schema can be used to query information about all tenants in the cluster.

Get the lowest price.

```sql
SELECT CAST (1 AS TIMESTAMP);
```

```
+-------------------------------+
| Int64(1)                      |
+-------------------------------+
| 1970-01-01T00:00:00.000000001 |
+-------------------------------+
```

#### For non-owner members, only the SQL submitted by the current member is displayed.

#### Alter Column: alter the column definition. Currently supports changing column names and modifying compression algorithms for columns.

1. All records of this schema are visible to the owner of the current tenant.
2. All records of this schema are visible to the Owner of the current tenant.
3. Executing the following command in the shell will generate a local data file named oceanic_station in Line Protocol format.
4. Based on the 2-D statistical aggregation, the slope of the linear fitting line is calculated.
5. Specify the order of rows in the partition.
6. Record the accepted data size through the Coordinator.
7. Delay deletion is cancelled and the tenant returns to normal.
8. algorithm specifies the algorithm for computing hash. Only md5, sha224, sha256, sha384, sha512, blake2s, blake2b, blake3 are supported.
9. The coefficient of determination after 2D statistical aggregation is calculated.
10. 8 Bytes
11. This schema shows the membership information under the tenant.
12. Function Names
13. Function Names
14. The return values of functions sha224, sha256, sha384, sha512 belong to this type.

Given a system or a value that switches between discrete states,

For example, you can use the compact_state_agg function to keep track of the system.
User name

#### Geometry

#### WKT

Show all databases or all tables or SQL in progress.
Required by time addition or subtraction and function data_bin's parameters.
Tenant ID

#### REPLICA: represents the number of replicas of data in the cluster, defaults to 1 (the number of replicas is not larger than the number of distributed data nodes).

```
Precedence
```

| begin_time: This is optional and specifies the start time of the period.                                                                                                                                                                                                                                                                                              | Get the duration, the time of the last Gauge minus the time of the first Gauge. |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------- |
| CUBE creates a grouping set for each possible combination of the specified expression set. First, GROUP BY (A, B, C), then (A, B), (A, C), (A), (B, C), (B), (C), and finally GROUP BY the entire table.                                              | `POINT (<x1> <y1>)`                                                                             |
| When with AFTER, it is delayed deletion, which will be deleted after the specified time. The time supports days (d), hours (h), and minutes (m), such as 10d, 50h, 100m. When there is no unit, the default is day. The tenant is not visible and unavailable during the delayed deletion period. | `LINESTRING (<x1> <y1>, <x2> <y2>, ...)`                                                        |
| begin_time: This is optional and specifies the start time of the period.                                                                                                                                                                                                                                                                                              | `POLYGON ((<x1> <y1>, <x2> <y2>, ...))`                                                         |
| 多点                                                                                                                                                                                                                                                                                                                                                                                                                         | `MULTIPOINT (<x1> <y1>, <x2> <y2>, ...)`                                                        |
| Common users can access only the tenant information of the current session.                                                                                                                                                                                                                                                                                                                                | `MULTILINESTRING ((<x1> <y1>, <x2> <y2>, ...), (<x1> <y1>, <x2> <y2>, ...))`                    |
| Note that the INSERT statement is recorded in (#ht).                                                                                                                                                                                                                                                                                                                                    | `MULTIPOLYGON (((<x1> <y1>, <x2> <y2>, ...)), ((<x1> <y1>, <x2> <y2>, ...)))`                   |
| When data is written to the source table, the streaming query is triggered.                                                                                                                                                                                                                                                                                                                                | `GEOMETRYCOLLECTION (<geometry tag1> <wkt data1>, <geometry tag2> <wkt data2>, ...)`            |

#### -- Column definitions can not be specified for PARQUET filesCREATE EXTERNAL TABLE [ IF NOT EXISTS ] tb_name&#xA;( field_definition [, field_definition] ... ) tb_option;field_definition:&#xA;column_name data_type [ NULL ]tb_option: {&#xA;STORED AS { PARQUET | JSON | CSV | AVRO }&#xA;| [ WITH HEADER ROW ]&#xA;| [ DELIMITER 'a_single_char' ]&#xA;| [ PARTITIONED BY ( column_name, [, ... ] ) ]&#xA;| LOCATION '/path/to/file'&#xA;}

| Record the number of times the output data passes through the Coordinator.                                                                                       | **Function**: Return the number of rows retrieved in the selected element. | ROLLUP assumes a hierarchy between input columns.                                                                                                                                                                          |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| This view records the Body size of the HTTP request.                                                                                                             | ![](/img/sql/SFA_Point.svg.png)                                                                            | POINT (30 10)                                                                                                                                                                                                           |
| **Notice**: Only resources that are delayed deletion and during the delayed deletion period can be recovered by executing the RECOVER statement. | ![](/img/sql/102px-SFA_LineString.svg.png)                                                                 | LINESTRING (30 10, 10 30, 40 40)                                                                                                                                                                                        |
| CnosDB supports updating the tag column value to NULL.                                                                                                           | ![](/img/sql/SFA_Polygon.svg.png)                                                                          | POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))                                                                                                                                                        |
|                                                                                                                                                                                  | ![](/img/sql/SFA_Polygon_with_hole.svg.png)                                                                | POLYGON ((35 10, 45 45, 15 40, 10 20, 35 10), (20 30, 35 35, 30 20, 20 30))                                                                                                       |
| 多点                                                                                                                                                                               | ![](/img/sql/SFA_MultiPoint.svg.png)                                                                       | MULTIPOINT ((10 40), (40 30), (20 20), (30 10))                                                                                             |
|                                                                                                                                                                                  |                                                                                                            | MULTIPOINT (10 40, 40 30, 20 20, 30 10)                                                                                                                                                                                 |
| Common users can access only the tenant information of the current session.                                                                                      | ![](/img/sql/102px-SFA_MultiLineString.svg.png)                                                            | MULTILINESTRING ((10 10, 20 20, 10 40), (40 40, 30 30, 40 20, 30 10))                                                                                                             |
| A stream query statement is triggered when data is written.                                                                                                      | ![](/img/sql/SFA_MultiPolygon.svg.png)                                                                     | MULTIPOLYGON (((30 20, 45 40, 10 40, 30 20)), ((15 5, 40 10, 10 20, 5 10, 15 5)))                                                           |
|                                                                                                                                                                                  | ![](/img/sql/SFA_MultiPolygon_with_hole.svg.png)                                                           | MULTIPOLYGON (((40 40, 20 45, 45 30, 40 40)), ((20 35, 10 30, 10 10, 30 5, 45 20, 20 35), (30 20, 20 15, 20 25, 30 20))) |
| For system administrators, the entire table in USAGE_SCHEMA is visible.                                                                     | ![](/img/sql/SFA_GeometryCollection.svg.png)                                                               | GEOMETRYCOLLECTION (POINT (40 10), LINESTRING (10 10, 20 20, 10 40), POLYGON ((40 40, 20 45, 45 30, 40 40)))                                |

### Interval type is STRING, which will be resolved to time interval.

#### Get the volume weighted average price.

```sql
CREATE DATABASE [IF NOT EXISTS] db_name [WITH db_options];

db_options:
    db_option ...

db_option: {
      TTL value
    | SHARD value
    | VNODE_DURATION value
    | REPLICA value
    | PRECISION {'ms' | 'us' | 'ns'}
}
```

#### **Function**: Assign a unique sequence number (starting from 1) to each row according to the row order in the window partition.

1. Get the opening price.
2. User name
3. todo
4. User name
5. Get the total volume.

#### It is important to note that the LOCF method can introduce certain biases, especially when the data after the missing value changes drastically. Therefore, when using LOCF to fill in missing values, it is necessary to carefully consider the characteristics of the data and the purpose of the analysis to ensure that the filled values can reasonably reflect the actual situation.

```sql
> CREATE DATABASE oceanic_station;
Query took 0.062 seconds.
```

### The first offset line of the current line in the offset `offset PRECEDING` ROWS mode. The first offset value of the current value in the RANGE mode.

#### This database, which belongs to a Tenant, is automatically created when a tenant is created and is visible to all members under the tenant.

```sql
SHOW DATABASES;
```

#### CnosDB store the shema information in two specific databases:

```
+-----------------+
| database_name   |
+-----------------+
| oceanic_station |
| public          |
+-----------------+
```

### The next offset line of the current line in the `offset FOLLOWING` ROWS mode. The next offset value of the current value in the RANGE mode.

Calculate the increment of value in the time series.

Count the duration of a state, or count the duration of a state in a certain period of time.

```sql
\c dbname
```

```
public ❯ \c oceanic_station
oceanic_station ❯
```

### interval_time: This is optional and specifies the duration of the time interval or infinity if not specified.

#### This schema stores information about all tables under the tenant.

```sql
DROP DATABASE [IF EXISTS] db_name [AFTER '7d'];
```

删除数据库会将指定database的所有table数据及元数据全部删除。

**Function**: x returns the approximate percentage (TDigest) of the weighted input value, where w is the weight column expression and p is a floating point 64 between 0 and 1 inclusive.

Common users can access only the tenant information of the current session.延迟删除期间数据库不可见且不可用。

#### This schema records the amount of disk space, in bytes, occupied by each vnode in the cluster.

```sql
RECOVER DATABASE [IF EXISTS] db_name;
```

取消延迟删除，数据库恢复正常状态。

Distance between two points.

#### `1997-01-31 09:26:56`     # Close to RCF3339, replace T by space, and no time zone is specified, the accuracy is on the order of seconds

```sql
Syntax
```

### Overwriting occurs when duplicate k-v pairs occur in the same field.

#### Record the output data size through the Coordinator.

```sql
ALTER DATABASE db_name [alter_db_options]

alter_db_options:
    SET db_option

db_option: {
      TTL value
    | SHARD value
    | VNODE_DURATION value
    | REPLICA value
}
```

#### **Function**: Replace all search items with replace.

```sql
ALTER DATABASE oceanic_station SET TTL '30d';
```

### When not with AFTER, it will be deleted immediately.

#### LOCATION: represents the location of the associated file.

```sql
DESCRIBE DATABASE dbname;
```

#### CnosDB supports `INNER JOIN`、`LEFT OUTER JOIN`、`RIGHT OUTER JOIN`、`FULL OUTER JOIN`.

```sql
DESCRIBE DATABASE oceanic_station;
```

```
+-----+-------+----------------+---------+-----------+
| ttl | shard | vnode_duration | replica | precision |
+-----+-------+----------------+---------+-----------+
| INF | 1     | 365 Days       | 1       | NS        |
+-----+-------+----------------+---------+-----------+
```

## Copies the value of the non-missing value to the location of the missing value.

### Last Observation Carried Forward (LOCF) is a method for filling in missing values using the most recent observable values. The specific treatment is as follows:

Given a system or value that switches between discrete states, the transitions between states are tracked.

If a complex expression has more than one operator, operator precedence determines the sequence of operations. The order of execution may have a noticeable effect on the resulting value.

### If the next non-missing value is encountered, steps 1 and 2 are repeated to copy the value of that non-missing value to the missing value location.

#### The data is read-only and cannot be DML operated or indexed.

```sql
CREATE TABLE [IF NOT EXISTS] tb_name
(field_definition [, field_definition ] ... [, TAGS(tg_name [, tg_name] ...)]);

field_definition:
    column_name data_type [field_codec_type]
    
field_codec_type:
    CODEC(code_type)
```

#### Gets the last value of one column sorted by another.

1. Comparing expressions for inequality
2. This function is used to perform Gap filling within the time window and to fillin the missing values using the "Last Observation Carried Forward" (LOCF) operation.
3. Point to line distance.
4. Point

- BIGINT/BIGINT UNSIGNED: DELTA, QUANTILE, SDT, DEADBAND, NULL
- DOUBLE: GORILLA, QUANTILE, SDT, DEADBAND, NULL
- STRING: SNAPPY, ZSTD, GZIP, BZIP, ZLIB, NULL
- BOOLEAN: BITPACK, NULL

Role name

#### The core idea of linear interpolation is to assume that the relationship between the known data points is linear, and then estimate the value of the unknown data points according to the linear relationship between the known data points. Specifically, linear interpolation deduces the ordinates of unknown data points by using the linear rate of change between the ordinates of known data points.

```sql
CREATE TABLE air (
   visibility DOUBLE,
   temperature DOUBLE,
   pressure DOUBLE,
   TAGS(station)
);
```

```
Query took 0.033 seconds.
```

### Timestamp, the keyword TIMESTAMP indicates that the following string constant need to be interpreted as TIMESTAMP type.

#### Get the value corresponding to the largest timestamp in the Gauge.

```sql
Time Stamp
```

#### Gets the first value of one column sorted by another.

1. Calculates the latest instantaneous change in Gauge. This is equal to the last value value minus the penultimate value.
2. Example:

#### Sort the results by the referenced expression. Ascending (ASC) is used by default. Sort in descending order by adding DESC after the expression of ORDER BY.

1. Calculate the intercept of y after 2D statistical aggregation.
2. Calculate the standard deviation of the specified dimension after the two-dimensional statistical aggregation, and the method is `population`.
3. User name
4. Tenant name
5. Nmuber of shards

#### **Function**: Split str according to delim, and return the nth part.

```sql
CREATE EXTERNAL TABLE cpu (
     cpu_hz  DECIMAL(10,6) NOT NULL,
     temp  DOUBLE NOT NULL,
     version_num  BIGINT NOT NULL,
     is_old  BOOLEAN NOT NULL,
     weight  DECIMAL(12,7) NOT NULL
)
STORED AS CSV
WITH HEADER ROW
LOCATION 'tests/data/csv/cpu.csv';
```

```
Query took 0.031 seconds.
```

### interval_time: This is optional; it specifies the duration of the time interval or infinity if not specified.

#### This schema stores tenant database information.

```sql
DROP TABLE [ IF EXISTS ] tb_name;
```

#### Calculate the variance of the specified dimension after aggregating the two-dimensional statistics, and the method is `population`.

```sql
DROP TABLE IF EXISTS air;
```

```
Query took 0.033 seconds.
```

### Calculate the standard deviation of the specified dimension after two-dimensional statistical aggregation, and the method is `sample`.

#### **Function**: Returns the rank (jump rank) of a value relative to all values in the partition.

```sql
SHOW TABLES;
```

#### Execute the \w command, followed by the absolute path of the data file or the working path relative to cnosdb-cli.

```sql
SHOW TABLES;
```

```
+------------+
| table_name |
+------------+
| air        |
| sea        |
| wind       |
+------------+
```

### The CTE defined in the WITH clause can only be used for other CTEs in the same WITH clause defined later.&#xA;Suppose A is the first CTE in the clause and B is the second CTE in the clause:

外部表和普通表的模式都可以使用该语句查看。

#### Current row in `CURRENT ROW` ROWS  mode.Current value in RANGE mode.

```sql
DESCRIBE DATABASE table_name;
```

#### ALTER TABLE tb_name alter_table_option;alter_table_option: {&#xA;ADD TAG col_name&#xA;| ADD FIELD col_name [CODEC(code_type)]&#xA;| ALTER col_name SET CODEC(code_type)&#xA;| DROP col_name&#xA;| RENAME COLUMN col_name TO new_col_name&#xA;}

```sql
DESCRIBE TABLE air;
```

```
+-------------+-----------------------+-------------+-------------------+
| column_name | data_type             | column_type | compression_codec |
+-------------+-----------------------+-------------+-------------------+
| time        | TIMESTAMP(NANOSECOND) | TIME        | DEFAULT           |
| station     | STRING                | TAG         | DEFAULT           |
| pressure    | DOUBLE                | FIELD       | DEFAULT           |
| temperature | DOUBLE                | FIELD       | DEFAULT           |
| visibility  | DOUBLE                | FIELD       | DEFAULT           |
+-------------+-----------------------+-------------+-------------------+
```

### The first row of the partition in `UNBOUND PRECEDING` ROWS mode. The first value of the partition ORDER BY expression in RANGE mode.

The correlation after aggregation of two-dimensional statistics is calculated.

**Function**: The function trims a string by removing leading and trailing spaces or by removing characters that match an optional specified string.

1. 1 Byte
2. Common users can access only the tenant information of the current session.
3. +08:00 represents the East 8th District

#### `1997-01-31T09:26:56.123` # Close to RCF3339, no time zone is specified, defaults to UTC

```sql
Show the result
```

> 不支持修改 `time` 列名。
> Description

#### resolution: Bigint, the approximate number of points to return ((Timestamp, value) pair), determines the horizontal resolution of the resulting plot.

```sql
ALTER TABLE air ADD TAG height;
ALTER TABLE air ADD FIELD humidity DOUBLE CODEC(DEFAULT);
ALTER TABLE air ALTER humidity SET CODEC(QUANTILE);
ALTER TABLE air DROP humidity;
ALTER TABLE air RENAME COLUMN height to height_v2;
```

## The last row of partition in `UNBOUND FOLLOWING` ROWS mode.The last value of ORDER BY expression in RANGE mode.

Count the duration of the 'running' state starting 2020-01-01 11:00:00.

Calculate the average of the specified dimensions after the aggregation of 2-D statistics.

### **INSERT**

#### Analyze Gauge data. Unlike Counter, Gauge can be decreased or increased.

```sql
INSERT [INTO] tb_name [ ( column_name [, ...] ) ] VALUES (  const [, ...] ) [, ...] | query; 
```

This is equivalent to inserting the following k-v pairs into the database.

-state: Any
Instructions

This is equivalent to inserting the following k-v pairs into the database.

If you need to track the activity of your system based on heartbeat signals, consider using the heartbeat_agg function.

Policy

The time stamp is based on RCF3339 standard.

### If the compression algorithm is not specified when creating a table, the system default compression algorithm is used.

Name of the role granted

#### **Function**: Returns the rank (consecutive rank) of a value relative to all values in the partition.

```sql
CREATE TABLE air (
    visibility DOUBLE,
    temperature DOUBLE,
    pressure DOUBLE,
    TAGS(station)
);
```

```
Query took 0.027 seconds.
```

```sql
INSERT INTO air (TIME, station, visibility, temperature, pressure) VALUES
                (1666165200290401000, 'XiaoMaiDao', 56, 69, 77);
```

```
+------+
| rows |
+------+
| 1    |
+------+
Query took 0.044 seconds.
```

```sql
INSERT INTO air (TIME, station, visibility, temperature, pressure) VALUES
                ('2022-10-19 06:40:00', 'XiaoMaiDao', 55, 68, 76);
```

```
+------+
| rows |
+------+
| 1    |
+------+
Query took 0.032 seconds.
```

```sql
SELECT * FROM air;
```

```
+----------------------------+------------+------------+-------------+-----------+
| time                       | station    | visibility | temperature | pressure |
+----------------------------+------------+------------+-------------+-----------+
| 2022-10-18 22:40:00        | XiaoMaiDao | 55         | 68          | 76        |
| 2022-10-19 07:40:00.290401 | XiaoMaiDao | 56         | 69          | 77        |
+----------------------------+------------+------------+-------------+-----------+
```

Similar to ROLLUP, CUBE is an extension of the GROUP BY clause. It allows you to generate subtotals for all combinations of grouping columns specified in the GROUP BY clause.

User name

### If RANGE is specified, the ORDER BY clause must be specified. The window calculates the offset in the unit of the value of the ORDER BY expression.

Whether administrator

#### The keyword `FULL JOIN` or `FULL OUTER JOIN` defines a full connection, which is actually the union of LEFT OUTER JOIN and RIGHT OUTER JOIN. It will display all the rows on the left and right of the join, and will generate null values where either side of the join does not match.

```sql
INSERT INTO air (TIME, station, visibility, temperature, pressure) VALUES
                ('2022-10-19 05:40:00', 'XiaoMaiDao', 55, 68, 76), 
                ('2022-10-19 04:40:00', 'XiaoMaiDao', 55, 68, 76);
```

```
+------+
| rows |
+------+
| 2    |
+------+
Query took 0.037 seconds.
```

```sql
SELECT * FROM air;
```

```
+----------------------------+------------+------------+-------------+-----------+
| time                       | station    | visibility | temperature | pressure |
+----------------------------+------------+------------+-------------+-----------+
| 2022-10-18 20:40:00        | XiaoMaiDao | 55         | 68          | 76        |
| 2022-10-18 21:40:00        | XiaoMaiDao | 55         | 68          | 76        |
| 2022-10-18 22:40:00        | XiaoMaiDao | 55         | 68          | 76        |
| 2022-10-19 07:40:00.290401 | XiaoMaiDao | 56         | 69          | 77        |
+----------------------------+------------+------------+-------------+-----------+
```

### Multi-polygon

Number of replica

#### Define a right join with the keyword `RIGHT JOIN` or `RIGHT OUTER JOIN` . This join includes all the rows in the right table. If there are no matching rows in the left table, the left side of the join is null.

```sql
8 Bytes
```

```
Query took 0.027 seconds.
```

```sql
Multi-polygon
```

```
+------+
| rows |
+------+
| 4    |
+------+
Query took 0.045 seconds.
```

```sql
SELECT * FROM air_visibility;
```

```
+----------------------------+------------+------------+
| time                       | station    | visibility |
+----------------------------+------------+------------+
| 2022-10-18 20:40:00        | XiaoMaiDao | 55         |
| 2022-10-18 21:40:00        | XiaoMaiDao | 55         |
| 2022-10-18 22:40:00        | XiaoMaiDao | 55         |
| 2022-10-19 07:40:00.290401 | XiaoMaiDao | 56         |
+----------------------------+------------+------------+
```

### If ROWS is specified, the window will calculate the offset in row units.

[//]: # "2.3"

Instructions

```
CREATE TABLE air (
    visibility DOUBLE,
    temperature DOUBLE,
    pressure DOUBLE,
    TAGS(station)
);
INSERT INTO air (TIME, station, visibility, temperature) VALUES
(1666165200290401000, 'XiaoMaiDao', 56, 69);
```

Geometry-collection

| key                                                    | visibility-value | temperature-value | pressure-value |
| ------------------------------------------------------ | ---------------- | ----------------- | -------------- |
| (1666165200290401000, 'XiaoMaiDao') | 56               |                   |                |
| (1666165200290401000, 'XiaoMaiDao') |                  | 69                |                |

CnosDB supports updating single or multiple field column values separately. It does not support updating tag column and field column at the same time.

```
select * from air;
----
+----------------------------+------------+------------+-------------+----------+
| time                       | station    | visibility | temperature | pressure |
+----------------------------+------------+------------+-------------+----------+
| 2022-10-19T07:40:00.290401 | XiaoMaiDao | 56.0       | 69.0        |          |
+----------------------------+------------+------------+-------------+----------+
```

Instructions

```sql
INSERT INTO air (TIME, station, visibility) VALUES
(1666165200290401000, 'XiaoMaiDao', 66);
```

相当于插入

| key                                                    | visibility-value | temperature-value | pressure-value |
| ------------------------------------------------------ | ---------------- | ----------------- | -------------- |
| (1666165200290401000, 'XiaoMaiDao') | 66               |                   |                |

Tenant name

```
select * from air;
----
+----------------------------+------------+------------+-------------+----------+
| time                       | station    | visibility | temperature | pressure |
+----------------------------+------------+------------+-------------+----------+
| 2022-10-19T07:40:00.290401 | XiaoMaiDao | 66.0       | 69.0        |          |
+----------------------------+------------+------------+-------------+----------+
```

```sql
INSERT INTO air (TIME, station, pressure) VALUES
(1666165200290401000, 'XiaoMaiDao', 77);
```

相当于插入

| key                                                    | visibility-value | temperature-value | pressure-value |
| ------------------------------------------------------ | ---------------- | ----------------- | -------------- |
| (1666165200290401000, 'XiaoMaiDao') |                  |                   | 77             |

```
select * from air;
----
+----------------------------+------------+------------+-------------+----------+
| time                       | station    | visibility | temperature | pressure |
+----------------------------+------------+------------+-------------+----------+
| 2022-10-19T07:40:00.290401 | XiaoMaiDao | 66.0       | 69.0        | 77.0     |
+----------------------------+------------+------------+-------------+----------+
```

## In the SELECT query, the HAVING clause must follow the GROUP BY clause and appear before the ORDER BY clause (if there is one).

### Contain the DISTINCT keyword, which counts the results after deduplication.

#### **Function**: Calculate the percentage ranking of a value in the partition.

```
Size
```

#### **Function**: Return the overall covariance of number pairs in a group.

1. Explanation
2. Calculate the variance of the specified dimension after aggregating the two-dimensional statistics, and the method is `sample`.
3. geometry object
4. Calculate the kurtosis value of the specified dimension after two-dimensional statistical aggregation, and the method is `sample`.
5. volume: Double
6. Description

#### Add Column: add field and tag columns.

```sql
update air set station = 'ShangHai' where station = 'LianYunGang';
```

### This view records the number of times the user writes to the DB over HTTP.

#### -- station is a Tag column&#xA;SELECT station FROM air;

```sql
UPDATE table_name SET ( assignment_clause [, ...] ) where_clause

assignment clause :
    field_name = value_expression
```

#### The aggregate function result cannot be returned in CSV format.

1. Instructions

#### CnosDB supports updating single or multiple tag column values separately. It does not support updating tag column and field column at the same time.

```sql
update air set pressure = pressure + 100 where pressure = 68 and time < '2023-01-14T16:03:00';
```

## The `CASE WHEN` expression is used when the expression needs different values depending on the situation.

[//]: # "2.4"

**Functions**: ST_Distance returns the minimum Euclidean distance between the 2D projections of two geometries.

#### CnosDB supports the creation of common tables and external tables.

```
DELETE FROM table_name where_clause
```

#### Limit the number of rows returned from the result set to n, and n must be non-negative.

1. Calculate the skewness value of the specified dimension after two-dimensional statistical aggregation, and the method is `sample`.

#### **Notice**: Neither column is included in the aggregation if it is NULL.

```sql
delete from air where station = 'LianYunGang' and time < '2023-01-14T16:03:00';
```

## Therefore, we often use ROLLUP in reports to generate subtotals and totals. The order of columns in ROLLUP is very important.

Get the time of the opening price.

**注意**：为了查询能更高效，没有指定排序的查询，每次行顺序都不一定相同，如果需要按字段排序的话，请参看`ORDER BY`子句。

### `1997-01-31 09:26:56.123` # Close to RCF3339, replace T by space, and no time zone is specified

Count the time of 'running' status.后面章节中引用的数据源都来自此示例数据。

### HAVING enables you to specify filter conditions after the GROUP BY clause, so as to control which groups in the query results can appear in the final results.

Statistical Aggregate Functions

See [Aggregate Function](#aggregate-function).

```shell
curl -o oceanic_station.txt https://dl.cnosdb.com/sample/oceanic_station.txt
```

### At present, the compression algorithms supported by various types are as follows. The first one of each type is the default specified algorithm. NULL means no compression algorithm is used.

- This view records the number of times the user queries the DB.
  ```shell
  cnosdb-cli
  ```
- Comparing expressions to see if they are less than or equal to
  ```shell
  create database oceanic_station;
  ```
- STORED AS: represents the format in which the file is stored. Currently, PARQUET, JSON, CSV and AVRO formats are supported.
  ```shell
  \c oceanic_station
  ```
- The GROUP BY clause must be after the condition of the WHERE clause (if there is one) and before the ORDER BY clause (if there is one).

  Get the closing time.

  ```shell
  \w oceanic_station.txt
  ```

## Common users can access only the tenant information of the current session.

#### **Function**: Create a STRUCT with the specified field value.

```sql
[ WITH with_query [, ...] ]
SELECT [ ALL | DISTINCT ] select_expression [, ...]
    [ FROM from_item [, ...] ]
    [ WHERE condition ]
    [ GROUP BY [ ALL | DISTINCT ] grouping_element [, ...] ]
    [ HAVING condition ]
    [ { UNION | INTERSECT | EXCEPT } [ ALL | DISTINCT ] select ]
    [ ORDER BY expression [ ASC | DESC ] [, ...] ]
    [ OFFSET count ]
    [ LIMIT { count | ALL } ];

-- from_item
-- 1.
    tb_name [ [ AS ] alias [ ( column_alias [, ...] ) ] ]
-- 2.
    from_item join_type from_item
    { ON join_condition | USING ( join_column [, ...] ) }

-- join_type
    [ INNER ] JOIN
    LEFT [ OUTER ] JOIN
    RIGHT [ OUTER ] JOIN
    FULL [ OUTER ] JOIN
    CROSS JOIN

-- grouping_element
    ()
```

### **Functions**: Convert WKB binary to Geometry type.

### SELECT \*

In short, the LOCF method populates the missing value by copying the most recent observable value to the missing value location, making the data continuous in time. This method assumes that the data after the missing value is the same or very close to the last observed value.

#### Define a left join with the keyword `LEFT JOIN` or `LEFT OUTER JOIN` . This join includes all the rows in the left table. If there are no matching rows in the right table, the right side of the join is null.

```
SELECT * FROM air;
```

```
+---------------------+-------------+------------+-------------+----------+
| time                | station     | visibility | temperature | pressure |
+---------------------+-------------+------------+-------------+----------+
| 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       |
| 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       |
| 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       |
| 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       |
| 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       |
| 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       |
| 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       |
| 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       |
| 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       |
| 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       |
| 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       |
| 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       |
| 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       |
+---------------------+-------------+------------+-------------+----------+
```

### Return the series in the specified table.

#### Perform financial asset data analysis. This feature makes it easier to write financial analysis queries involving candlestick.

```sql
SELECT [ ALL | DISTINCT ] select_expression [, ...];
```

Count the duration of the 'running' state for four days starting on 2020-01-01 11:00:00.
Schema Definition不指定此选项时，默认值为`ALL`。

#### `where_clause` can only contain tag and time columns, not field columns.

```sql
SELECT DISTINCT station, visibility FROM air;
```

```
+-------------+------------+
| station     | visibility |
+-------------+------------+
| XiaoMaiDao  | 56         |
| XiaoMaiDao  | 50         |
| XiaoMaiDao  | 67         |
| XiaoMaiDao  | 65         |
| XiaoMaiDao  | 53         |
| XiaoMaiDao  | 74         |
| XiaoMaiDao  | 71         |
| LianYunGang | 78         |
| LianYunGang | 79         |
| LianYunGang | 59         |
| LianYunGang | 67         |
| LianYunGang | 80         |
+-------------+------------+
```

```sql
SELECT station, visibility FROM air;
```

```
+-------------+------------+
| station     | visibility |
+-------------+------------+
| XiaoMaiDao  | 56         |
| XiaoMaiDao  | 50         |
| XiaoMaiDao  | 67         |
| XiaoMaiDao  | 65         |
| XiaoMaiDao  | 53         |
| XiaoMaiDao  | 74         |
| XiaoMaiDao  | 71         |
| LianYunGang | 78         |
| LianYunGang | 79         |
| LianYunGang | 59         |
| LianYunGang | 67         |
| LianYunGang | 80         |
| LianYunGang | 59         |
+-------------+------------+
```

### Determines whether the left expression matches the pattern of the right expression

Calculate the sum of the specified dimensions after the two-dimensional statistical aggregation, and the method is `population`.

### 为列表达式取别名

#### PARTITIONED BY: use the column specified when creating the table to partition.

```sql
expression [ [ AS ] column_alias ]
```

#### In databases, interpolation is a technique used to deal with missing values in data. When there are missing values in the data, these techniques can help us estimate or speculate on those missing values, thus filling in the gaps in the data.

```sql
SELECT station s, visibility AS v FROM air;
```

```
+-------------+----+
| s           | v  |
+-------------+----+
| XiaoMaiDao  | 56 |
| XiaoMaiDao  | 50 |
| XiaoMaiDao  | 67 |
| XiaoMaiDao  | 65 |
| XiaoMaiDao  | 53 |
| XiaoMaiDao  | 74 |
| XiaoMaiDao  | 71 |
| LianYunGang | 78 |
| LianYunGang | 79 |
| LianYunGang | 59 |
| LianYunGang | 67 |
| LianYunGang | 80 |
| LianYunGang | 59 |
+-------------+----+
```

### Common users can access only the tenant information of the current session.

Explanation

#### This schema stores the definitions of all columns under the tenant.

```sql
FROM tb_name [AS] alias_name
```

#### One or more expressions used to specify a row partition. If there is no such clause, the partition is composed of all rows.

```sql
SELECT a.visibility, s.temperature
FROM air AS a JOIN sea s ON a.temperature = s.temperature limit 10;
```

```
+------------+-------------+
| visibility | temperature |
+------------+-------------+
| 67         | 62          |
| 50         | 78          |
| 50         | 78          |
| 65         | 79          |
+------------+-------------+
```

### Binary operators and two expressions are combined to form a new expression.

- N: Int

  #### **Function**: 将 str 中与 regexp 匹配的所有子字符串都替换为 rep。

  ```sql
  Restrictions on Usage
  ```

  ```
  +-------------+-------------+
  | station     | temperature |
  +-------------+-------------+
  | XiaoMaiDao  | 69          |
  | XiaoMaiDao  | 78          |
  | XiaoMaiDao  | 62          |
  | XiaoMaiDao  | 79          |
  | XiaoMaiDao  | 53          |
  | XiaoMaiDao  | 72          |
  | XiaoMaiDao  | 71          |
  | LianYunGang | 69          |
  | LianYunGang | 80          |
  | LianYunGang | 74          |
  | LianYunGang | 70          |
  | LianYunGang | 70          |
  | LianYunGang | 70          |
  +-------------+-------------+
  ```

  ```sql
  Note
  ```

  ```
  +-------------+
  | station     |
  +-------------+
  | XiaoMaiDao  |
  | LianYunGang |
  +-------------+ 
  ```

### External tables do not exist in the database, but an operating system file is accessed as a common database table.

#### VNODE_DURATION: represents the time range of data in the shard, defaults to 365 days, and also expressed by data with units.Its data meaning is consistent with the value of TTL.

```sql
LIMIT n
```

price: Double

#### You can also use the keyword `AS` to alias the table.

```sql
SELECT *
FROM air LIMIT 10;
```

```
+---------------------+-------------+------------+-------------+----------+
| time                | station     | visibility | temperature | pressure |
+---------------------+-------------+------------+-------------+----------+
| 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       |
| 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       |
| 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       |
| 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       |
| 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       |
| 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       |
| 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       |
| 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       |
| 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       |
| 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       |
+---------------------+-------------+------------+-------------+----------+
```

### PRECISION: The timestamp accuracy of the database. ms represents milliseconds, us represents microseconds, ns represents nanoseconds,defaults to ns.

#### Example: `INSERT INTO air (TIME, station, visibility) VALUES(1666132800000000000, NULL, NULL)`

```sql
OFFSET m
```

Host of service

#### Calculate the kurtosis value of the specified dimension after two-dimensional statistical aggregation, and the method is `population`.

```sql
SELECT *
FROM air OFFSET 10;
```

```
+---------------------+-------------+------------+-------------+----------+
| time                | station     | visibility | temperature | pressure |
+---------------------+-------------+------------+-------------+----------+
| 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       |
| 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       |
| 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       |
+---------------------+-------------+------------+-------------+----------+
```

The tenant to which the vnode belongs
Role name under the tenant
OFFSET 0与省略OFFSET子句效果相同。

#### The keyword `VALUES` can be followed by multiple lists separated by `,`.

```sql
SELECT *
FROM air LIMIT 3 OFFSET 3;
```

```
+---------------------+------------+------------+-------------+----------+
| time                | station    | visibility | temperature | pressure |
+---------------------+------------+------------+-------------+----------+
| 2022-01-28 13:30:00 | XiaoMaiDao | 65         | 79          | 77       |
| 2022-01-28 13:33:00 | XiaoMaiDao | 53         | 53          | 68       |
| 2022-01-28 13:36:00 | XiaoMaiDao | 74         | 72          | 68       |
+---------------------+------------+------------+-------------+----------+
```

### For more information about the compression algorithm, see the details of the [compression algorithm](./concept_design/compress.md#compression-algorithm).

#### **Function**: Return a value truncated to the unit specified in field.

```sql
WITH cte AS cte_query_definiton [, ...] query
```

可选。`slide_duration` is an interval, and specifies the sliding size of the time window. If this parameter is not specified, `slide_duration` is the sliding size of the time window and becomes a rolling window.
geometry objectCTE使用规则如下：

- Aggregate function array_agg's return type .
- Note
  假设A是子句中的第一个CTE，B是子句中的第二个CTE：

#### **Function**: Return a concatenated string separated by sep.

```sql
SELECT station, avg 
FROM (  SELECT station, AVG(visibility) AS avg 
        FROM air 
        GROUP BY station) AS x;
```

```
+-------------+--------------------+
| station     | avg                |
+-------------+--------------------+
| XiaoMaiDao  | 62.285714285714285 |
| LianYunGang | 70.33333333333333  |
+-------------+--------------------+
```

```sql
WITH x AS 
    (SELECT station, AVG(visibility) AS avg FROM air GROUP BY station)
SELECT station, avg
FROM x;
```

```
+-------------+--------------------+
| station     | avg                |
+-------------+--------------------+
| XiaoMaiDao  | 62.285714285714285 |
| LianYunGang | 70.33333333333333  |
+-------------+--------------------+
```

### Calculate the intercept of x after two-dimensional statistical aggregation.

Type

#### Obtain the value corresponding to the smallest timestamp in the gauge

```
select_clause_set_left
[ UNION | UNION ALL| EXCEPT | INTERSECT]
select_clause_set_right
[sort_list_columns] [limit_clause]
```

`UNION` 会对合并的结果集去重。
Type
User name under tenant
Role name

Time range of data in shard

**Function**: Signs of parameter (-1,0,+1).

#### The keyword `JOIN` or `INNER JOIN` defines a join that only displays matching rows in two tables.

- **UNION ALL**

  ```sql
  SELECT visibility FROM air WHERE temperature < 60
  UNION ALL
  SELECT visibility FROM air WHERE temperature > 50 LIMIT 10;
  ```

  ```
  +------------+
  | visibility |
  +------------+
  | 53         |
  | 56         |
  | 50         |
  | 67         |
  | 65         |
  | 53         |
  | 74         |
  | 71         |
  | 78         |
  | 79         |
  +------------+
  ```

- **UNION**

  ```sql
  SELECT visibility FROM air WHERE temperature < 60
  UNION
  SELECT visibility FROM air WHERE temperature > 50 LIMIT 10;
  ```

  ```
  +------------+
  | visibility |
  +------------+
  | 53         |
  | 56         |
  | 50         |
  | 67         |
  | 65         |
  | 74         |
  | 71         |
  | 78         |
  | 79         |
  | 59         |
  +------------+
  ```

- **EXCEPT**

  ```sql
  SELECT visibility FROM air
  EXCEPT
  SELECT visibility FROM air WHERE temperature < 50 LIMIT 10;
  ```

  ```
  +------------+
  | visibility |
  +------------+
  | 56         |
  | 50         |
  | 67         |
  | 65         |
  | 53         |
  | 74         |
  | 71         |
  | 78         |
  | 79         |
  | 59         |
  +------------+
  ```

- **INTERSECT**

  ```sql
  SELECT visibility FROM air
  INTERSECT
  SELECT visibility FROM air WHERE temperature > 50 LIMIT 10;
  ```

  ```
  +------------+
  | visibility |
  +------------+
  | 56         |
  | 50         |
  | 67         |
  | 65         |
  | 53         |
  | 74         |
  | 71         |
  | 78         |
  | 79         |
  | 59         |
  +------------+
  ```

### This schema shows a real-time snapshot of SQL statements, which is used to monitor SQL jobs in real time.

按引用的表达式对结果进行排序。默认情况使用升序 (ASC)。Measurement value

#### Window functions and aggregate functions cannot be nested in window functions.

```sql
SELECT * FROM air ORDER BY temperature;
```

```
+---------------------+-------------+------------+-------------+----------+
| time                | station     | visibility | temperature | pressure |
+---------------------+-------------+------------+-------------+----------+
| 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       |
| 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       |
| 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       |
| 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       |
| 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       |
| 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       |
| 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       |
| 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       |
| 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       |
| 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       |
| 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       |
| 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       |
| 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       |
+---------------------+-------------+------------+-------------+----------+
```

```sql
SELECT * FROM air ORDER BY temperature DESC;
```

```
+---------------------+-------------+------------+-------------+----------+
| time                | station     | visibility | temperature | pressure |
+---------------------+-------------+------------+-------------+----------+
| 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       |
| 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       |
| 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       |
| 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       |
| 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       |
| 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       |
| 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       |
| 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       |
| 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       |
| 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       |
| 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       |
| 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       |
| 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       |
+---------------------+-------------+------------+-------------+----------+
```

```sql
SELECT * FROM air ORDER BY station, temperature;
```

```
+---------------------+-------------+------------+-------------+----------+
| time                | station     | visibility | temperature | pressure |
+---------------------+-------------+------------+-------------+----------+
| 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       |
| 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       |
| 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       |
| 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       |
| 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       |
| 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       |
| 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       |
| 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       |
| 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       |
| 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       |
| 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       |
| 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       |
| 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       |
+---------------------+-------------+------------+-------------+----------+
```

## Drop Column: drop the field column. When dropping a column results in dropping the last field value of a row, we think that this row has no value, and this row will not be showed in SELECT.

Get the smallest timestamp in the gauge
简单表达式可以是一个常量、变量、列或标量函数。
可以用运算符将两个或更多的简单表达式联接起来组成复杂表达式。

#### `1997-01-31T09:26:56.123+08:00` # Standard RCF3339, East 8th District

```sql
<expresion> :: = { 
    constant 
    | [ table_name. ] column   
    | scalar_function 
    | ( expression ) 
    | expression { binary_operator } expression   
    | case_when_expression
    | window_function | aggregate_function  
}
```

#### `CROSS JOIN` is not supported currently.

The time_window_gapfill must be used as a top-level expression in a query or subquery. For example, you cannot nest time_window_gapfill in another function, such as sum(time_window_gapfill(xxx)).
详细内容请阅览[常量](#常量)。

#### In CnosDB-Cli, you can use the following command to switch to the specified database.

```sql
select 1;
```

```
+----------+
| Int64(1) |
+----------+
| 1        |
+----------+
```

#### CnosDB supports two data inserting methods:&#xA;one is to use the `INSERT INTO` statement,&#xA;and the other is to use the HTTP API [write](./rest_api.md) interface to insert Line Protocol format data.

Currently, only common tables can be source tables. Field names and field types defined in flow table fields must belong to the source table and be the same as those defined in the source table.

#### DROP DATABASE oceanic_station AFTER ‘7d’;RECOVER DATABASE oceanic_station;

| For more information about SHOW QUERIES, you can reference to [SHOW QUERIES](#show-queries). | Perform linear regression analysis on two-dimensional data, such as calculating correlation coefficients and covariances.&#xA;Common statistics such as mean and standard deviation can also be calculated for each dimension separately.&#xA;stats_agg provides the same functionality as aggregation functions such as sum, count, corr, covar_pop, and so on.&#xA;Suitable for use with multiple analysis functions in a single SQL. |
| ------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| NOT                                                                                                          | **Function**: Calculate the standard deviation of the sample.                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| IS NULL                                                                                                      | Sample Data                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| IS NOT NULL                                                                                                  | Geometry-collection                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |

#### CREATE STREAM TABLE [IF NOT EXISTS] table_name(field_definition [, field_definition] ...)&#xA;WITH (db = 'db_name', table = 'table_name', event_time_column = 'time_column')&#xA;engine = tskv;&#xA;field_definition:&#xA;column_name data_type

CLUSTER_SCHEMA : The information of the cluster.

Describe the parameters of the database and the pattern of the table.

| Common users can access only the tenant information of the current session. | Linear interpolation is suitable for estimation of continuous variables, such as filling in missing values in time series or interpolating in spatial data. However, the accuracy and applicability of linear interpolation depends on the characteristics of the data and the actual situation. In some cases, the data may have non-linear relationships, or other interpolation methods may be more suitable. Therefore, before applying linear interpolation, it is necessary to carefully consider the nature of the data and the purpose of the interpolation to ensure that the interpolation results are reasonable and accurate. |
| ------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| -                                                                                           | Common users can access only the tenant information of the current session.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| *                                                                                           | Common users can access only the tenant information of the current session.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| -                                                                                           | **Function**: Starting from the origin, the bucket is split by interval, and the bucket timestamp of the source is returned.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| /                                                                                           | If you use the database through [HTTP API](./rest_api.md), you can specify the parameter db=database_name in the url to use the database.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| %                                                                                           | CnosDB provides the system to check the status and information of CnosDB clusters. The system schema is a read-only schema. You can query the system schema using the SQL statement.                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| \|&#124                                                                 | Calculates the earliest instantaneous change in Gauge. This is equal to the second value minus the first.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| =                                                                                           | **Function**: Randomly select N records from the given column_key.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| !=、 <&gt                                                                | `event_time_column` Specifies the event time column. The data type of this column must be TIMESTAMP.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| <                                                                                           | There is no need to create a timestamp column when creating a table. The system automatically adds a timestamp column named "time".                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <=                                                                                          | CnosDB provides geometry functions in the ST_Geometry SQL family. For the Geometry type, see the [Geometry](#geometry) data types section.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| &amp;gt;                                                                | The database contains metadata information about the cluster, such as tenant information and user information.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| > =                                                                                         | Column type, unique to the tskv table, supports TIME, TAG, FIELD, and usually Field                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| AND                                                                                         | CnosDB provides `ROLLUP`, `CUBE` and other complex grouping operations, enabling you to operate query results in different ways.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| OR                                                                                          | Time of record                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| LIKE                                                                                        | INFORMATION_SCHEMA : The information of the tenant.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |

### candlestick_agg generates intermediate aggregate data CandleStackData from raw quote data,

#### DELIMITER: only effective in csv format, representing the delimiter of column data.

```sql
expr BETWEEN expr AND expr
```

#### Tenant name of the database to which the permission is granted

```sql
SELECT DISTINCT PRESSURE FROM AIR WHERE PRESSURE BETWEEN 50 AND 60;
```

```
+----------+
| pressure |
+----------+
| 52       |
| 54       |
| 57       |
| 50       |
| 60       |
| 51       |
| 56       |
| 58       |
| 59       |
| 53       |
| 55       |
+----------+
```

**Drop Database**

### Filter and delete data by tag and time columns.

as follows:

#### **Function**: Calculate sha224 hash value of the string str.

```sql
SELECT station, temperature, visibility FROM air WHERE temperature  IN (68, 69);
```

```
+-------------+-------------+------------+
| station     | temperature | visibility |
+-------------+-------------+------------+
| XiaoMaiDao  | 69          | 56         |
| LianYunGang | 69          | 78         |
+-------------+-------------+------------+
```

Name of the database to which the permission was granted

Operator

### Find the most recent non-missing value before the missing value.

Total write traffic size

#### Get the time of the highest price.

```sql
CASE
    ( WHEN expression THEN result1 [, ...] )
    ELSE result
END;
```

#### The `where_clause` must not contain a field or time column, and it must not be null. If you want to update all the data in the table, you need to use `where true`, which means you accept that there will be performance problems when the table is large.

```sql
SELECT DISTINCT 
    CASE WHEN PRESSURE >= 60 THEN 50 
         ELSE PRESSURE 
    END PRESSURE 
FROM AIR;
```

```
+----------+
| pressure |
+----------+
| 52       |
| 54       |
| 57       |
| 50       |
| 51       |
| 56       |
| 58       |
| 59       |
| 53       |
| 55       |
+----------+
```

### You can also use `INSERT SELECT` to insert query data into the table.

The distance between the plane and the plane. 执行顺序可能对结果值有明显的影响。

运算符的优先级别如下表中所示。 在较低级别的运算符之前先对较高级别的运算符进行求值。 Query took 0.030 seconds.

| 级别 | WITH HEADER ROW: Effective only in csv file format, representing with csv header.                                        |
| -- | -------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1  | Stream queries support only `INSERT SELECT` statements, where the FROM clause is the stream table and is inserted into the target table. |
| 2  | If the SELECT clause contains only the Tag column, it is equivalent to the SELECT DISTINCT Tag column.                                  |
| 3  | The tenant of the database                                                                                                                               |
| 4  | NOT                                                                                                                                                      |
| 5  | AND                                                                                                                                                      |
| 6  | BETWEEN、IN、LIKE、OR                                                                                                                                       |

### **SHOW**

#### Get the time of the lowest price.

```sql
SHOW {DATABASES | TABLES | QUERIES}
```

Double Precision Floating Point

#### **Functions**: Returns the Cartesian area of the 2D projection of a geometric object. The unit of area is the same as the unit used to represent the coordinates of the input geometry.&#xA;For point, string, multipoint, and multistring, this function returns 0.&#xA;For a collection of geometries, it returns the sum of the areas of the geometries in the collection.

```sql
SHOW DATABASES;
```

```
+---------------+
| database_name |
+---------------+
| public        |
+---------------+
```

```sql
SHOW TABLES;
```

```
+------------+
| table_name |
+------------+
| air        |
| sea        |
| wind       |
+------------+
```

```sql
SHOW QUERIES;
```

```
+----------+------------------------------------------------------------------+-----------------------------------------+-----------+----------------------------------------+-------------+------------+--------------+
| query_id | query_text                                                       | user_id                                 | user_name | tenant_id                              | tenant_name | state      | duration     |
+----------+------------------------------------------------------------------+-----------------------------------------+-----------+----------------------------------------+-------------+------------+--------------+
| 36       | select * FROM air join sea ON air.temperature = sea.temperature; | 108709109615072923019194003831375742761 | root      | 13215126763611749424716665303609634152 | cnosdb      | SCHEDULING | 12.693345666 |
+----------+------------------------------------------------------------------+-----------------------------------------+-----------+----------------------------------------+-------------+------------+--------------+
```

**Function**: Base 2 logarithm.

#### SHOW SERIES

The time_window_gapfill is similar to time_window, but has the ability to fill in missing data. Interpolate and locf must be used in conjunction with time_window_gapfill, which controls how missing values are treated.

#### **Function**: Returns the position of a value relative to all values in the partition.

```sql
SHOW SERIES [ON database_name] FROM table_name [WHERE expr] [order_by_clause] [limit_clause] 
```

#### The wildcard \* can be used to refer to all columns.

```sql
SHOW SERIES FROM air WHERE station = 'XiaoMaiDao' ORDER BY key LIMIT 1;
```

```
+------------------------+
| key                    |
+------------------------+
| air,station=XiaoMaiDao |
+------------------------+
```

CnosDBSQL is inspired by [DataFusion](https://arrow.apache.org/datafusion/user-guide/introduction), We support most of the SQL syntax of DataFusion.

x: double

#### SHOW TAG VALUES

#### To create a stream table, a source table is required. The stream table does not support `ALTER` now.

```sql
SHOW TAG VALUES [ON database_name] FROM table_name WITH KEY [<operator> "<tag_key>" | [[NOT] IN ("<tag_key1>", ..)]] [WHERE expr] [order_by_clause] [limit_clause];
```

Time of record

#### **Function**: Return an inverted string or an array containing elements in reverse order.

```sql
SHOW TAG VALUES FROM air WITH KEY = "station" WHERE station = 'XiaoMaiDao' ORDER BY key, value LIMIT 1;
```

```
+---------+------------+
| key     | value      |
+---------+------------+
| station | XiaoMaiDao |
+---------+------------+
```

```sql
SHOW TAG VALUES FROM air WITH KEY NOT IN ("station1");
```

```
+---------+-------------+
| key     | value       |
+---------+-------------+
| station | XiaoMaiDao  |
| station | LianYunGang |
+---------+-------------+
```

### **EXPLAIN**

#### If there are still missing values at the end of the data series, the last non-missing value is copied until all missing values are filled in.

```sql
EXPLAIN [ ANALYZE ] [ VERBOSE ] <statement>;
```

Binary operators supported now:

When the time unit is ms, the ratio unit is /ms

Equivalent to:

Constant

#### The names of the columns need to be different.

```sql
EXPLAIN SELECT station, temperature, visibility FROM air;
```

```
+---------------+-----------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                        |
+---------------+-----------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Projection: #air.station, #air.temperature, #air.visibility                                                                 |
|               |   TableScan: air projection=[station, visibility, temperature]                                                              |
| physical_plan | ProjectionExec: expr=[station@0 as station, temperature@2 as temperature, visibility@1 as visibility]                       |
|               |   TskvExec: limit=None, predicate=ColumnDomains { column_to_domain: Some({}) }, projection=[station,visibility,temperature] |
|               |                                                                                                                             |
+---------------+-----------------------------------------------------------------------------------------------------------------------------+
```

```sql
EXPLAIN ANALYZE SELECT station, temperature, visibility FROM air;
```

```
+-------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type         | plan                                                                                                                                                                                                                                                                                                                                    |
+-------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Plan with Metrics | ProjectionExec: expr=[station@0 as station, temperature@2 as temperature, visibility@1 as visibility], metrics=[output_rows=13, elapsed_compute=20.375µs, spill_count=0, spilled_bytes=0, mem_used=0]                                                                                                                                   |
|                   |   TskvExec: limit=None, predicate=ColumnDomains { column_to_domain: Some({}) }, projection=[station,visibility,temperature], metrics=[output_rows=13, elapsed_compute=15.929624ms, spill_count=0, spilled_bytes=0, mem_used=0, elapsed_series_scan=1.698791ms, elapsed_point_to_record_batch=4.572954ms, elapsed_field_scan=5.119076ms] |
|                   |                                                                                                                                                                                                                                                                                                                                         |
+-------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
```

```sql
EXPLAIN ANALYZE SELECT station, temperature, visibility FROM air;
```

```
+-------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type         | plan                                                                                                                                                                                                                                                                                                                                    |
+-------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Plan with Metrics | ProjectionExec: expr=[station@0 as station, temperature@2 as temperature, visibility@1 as visibility], metrics=[output_rows=13, elapsed_compute=20.375µs, spill_count=0, spilled_bytes=0, mem_used=0]                                                                                                                                   |
|                   |   TskvExec: limit=None, predicate=ColumnDomains { column_to_domain: Some({}) }, projection=[station,visibility,temperature], metrics=[output_rows=13, elapsed_compute=15.929624ms, spill_count=0, spilled_bytes=0, mem_used=0, elapsed_series_scan=1.698791ms, elapsed_point_to_record_batch=4.572954ms, elapsed_field_scan=5.119076ms] |
|                   |                                                                                                                                                                                                                                                                                                                                         |
+-------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
```

```sql
EXPLAIN ANALYZE VERBOSE SELECT station, temperature, visibility FROM air;
```

```
+------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type              | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
+------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Plan with Metrics      | ProjectionExec: expr=[station@0 as station, temperature@2 as temperature, visibility@1 as visibility], metrics=[output_rows=13, elapsed_compute=26.75µs, spill_count=0, spilled_bytes=0, mem_used=0]                                                                                                                                                                                                                                                                                                                                                                    |
|                        |   TskvExec: limit=None, predicate=ColumnDomains { column_to_domain: Some({}) }, projection=[station,visibility,temperature], metrics=[output_rows=13, elapsed_compute=13.225875ms, spill_count=0, spilled_bytes=0, mem_used=0, elapsed_point_to_record_batch=3.918163ms, elapsed_field_scan=3.992161ms, elapsed_series_scan=1.657416ms]                                                                                                                                                                                                                                 |
|                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Plan with Full Metrics | ProjectionExec: expr=[station@0 as station, temperature@2 as temperature, visibility@1 as visibility], metrics=[start_timestamp{partition=0}=2022-10-25 03:00:14.865034 UTC, end_timestamp{partition=0}=2022-10-25 03:00:14.879596 UTC, elapsed_compute{partition=0}=26.75µs, spill_count{partition=0}=0, spilled_bytes{partition=0}=0, mem_used{partition=0}=0, output_rows{partition=0}=13]                                                                                                                                                                           |
|                        |   TskvExec: limit=None, predicate=ColumnDomains { column_to_domain: Some({}) }, projection=[station,visibility,temperature], metrics=[start_timestamp{partition=0}=2022-10-25 03:00:14.864225 UTC, end_timestamp{partition=0}=2022-10-25 03:00:14.879596 UTC, elapsed_compute{partition=0}=13.225875ms, spill_count{partition=0}=0, spilled_bytes{partition=0}=0, mem_used{partition=0}=0, output_rows{partition=0}=13, elapsed_point_to_record_batch{partition=0}=3.918163ms, elapsed_field_scan{partition=0}=3.992161ms, elapsed_series_scan{partition=0}=1.657416ms] |
|                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Output Rows            | 13                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Duration               | 13.307708ms                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
+------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
```

### **DESCRIBE**

#### Table storage engine. External and internal tskv tables supported now

```sql
DESCRIBE {DATABASE db_name | TABLE tb_name};
```

`1997-01-31 09:26:56.123+08:00` # Close to RCF3339, just replace T by space

#### **Functions**: The Geometry object is returned in OGC/ISO Well-Known Binary(WKB) format.

```sql
DESCRIBE TABLE air;
```

```
+-------------+-----------------------+-------------+-------------------+
| column_name | data_type             | column_type | compression_codec |
+-------------+-----------------------+-------------+-------------------+
| time        | TIMESTAMP(NANOSECOND) | TIME        | DEFAULT           |
| station     | STRING                | TAG         | DEFAULT           |
| pressure    | DOUBLE                | FIELD       | DEFAULT           |
| temperature | DOUBLE                | FIELD       | DEFAULT           |
| visibility  | DOUBLE                | FIELD       | DEFAULT           |
+-------------+-----------------------+-------------+-------------------+
```

```sql
DESCRIBE DATABASE public;
```

```
+-----+-------+----------------+---------+-----------+
| ttl | shard | vnode_duration | replica | precision |
+-----+-------+----------------+---------+-----------+
| INF | 1     | 365 Days       | 1       | NS        |
+-----+-------+----------------+---------+-----------+
```

[//]: # "## **EXISTS**"
[//]: # "EXISTS 条件测试子查询中是否存在行，并在子查询返回至少一个行时返回 true。如果指定 NOT，此条件将在子查询未返回任何行时返回 true。"
[//]: # "function([...expr] ) OVER ([PARTITION BY expr] [ORDER BY expr] [window_frame]);

function: {aggregate_function | analytic_function| aggregate_function}

window_frame: { frame_mode frame_start |
                frame_mode BETWEEN frame_start AND frame_end } }
frame_mode: {RANGE | ROWS}

frame_start: {UNBOUNDED PRECEDING | offset_start PRECEDING | CURRENT ROW | offset_start FOLLOWING }

frame_end: {offset_stop PRECEDING | CURRENT ROW | offset_stop FOLLOWING | UNBOUNDED FOLLOWING}
"
[//]: # "```sql"
[//]: # "SELECT id  FROM date"
[//]: # "WHERE EXISTS (SELECT 1 FROM shop"
[//]: # "WHERE date.id = shop.id)"
[//]: # "ORDER BY id;"
[//]: # "```"
[//]: # "# **DCL (无)**"
[//]: # "```sql"
[//]: # "DESCRIBE table_name"
[//]: # "```"
[//]: # "TODO SHOW"
[//]: # "# **SHOW**"
[//]: # "## **SHOW VARIABLE**"
[//]: # "```sql"
[//]: # "-- only support show tables"
[//]: # "-- SHOW TABLES is not supported unless information_schema is enabled"
[//]: # "SHOW TABLES"
[//]: # "```"
[//]: # "## **SHOW COLUMNS**"
[//]: #
[//]: # "```sql"
[//]: # "-- SHOW COLUMNS with WHERE or LIKE is not supported"
[//]: # "-- SHOW COLUMNS is not supported unless information_schema is enabled"
[//]: # "-- treat both FULL and EXTENDED as the same"
[//]: # "SHOW [ EXTENDED ] [ FULL ]"
[//]: # "{ COLUMNS | FIELDS }"
[//]: # "{ FROM | IN }"
[//]: # "table_name"
[//]: # "```"
[//]: # "## **SHOW CREATE TABLE**"
[//]: # "```sql"
[//]: # "SHOW CREATE TABLE table_name"
[//]: # "```"

### The db and table arguments specify the source table.

Remarks

The WKT format is a text format used to describe the spatial characteristics of 2D and 3D geometric objects.
WKT stands for "Well-Known Text" and is an open international standard.
The WKT format includes some basic geometric objects, such as points, lines, polygons and circles, and some composite objects, such as collections of polygons and collections of geometric objects.

### INNER JOIN

Get the closing price.

#### **Function**: Calculate sha384 hash value of the string str.

```sql
SELECT * FROM air INNER JOIN sea ON air.temperature = sea.temperature;
```

```
+---------------------+------------+------------+-------------+----------+---------------------+-------------+-------------+
| time                | station    | visibility | temperature | pressure | time                | station     | temperature |
+---------------------+------------+------------+-------------+----------+---------------------+-------------+-------------+
| 2022-01-28 13:27:00 | XiaoMaiDao | 67         | 62          | 59       | 2022-01-28 13:18:00 | LianYunGang | 62          |
| 2022-01-28 13:24:00 | XiaoMaiDao | 50         | 78          | 66       | 2022-01-28 13:30:00 | XiaoMaiDao  | 78          |
| 2022-01-28 13:24:00 | XiaoMaiDao | 50         | 78          | 66       | 2022-01-28 13:33:00 | XiaoMaiDao  | 78          |
| 2022-01-28 13:30:00 | XiaoMaiDao | 65         | 79          | 77       | 2022-01-28 13:39:00 | XiaoMaiDao  | 79          |
+---------------------+------------+------------+-------------+----------+---------------------+-------------+-------------+
```

### LEFT JOIN

Z represents zero time zoneHost of service

#### **Function**: Calculate sha384 hash value of the string str.

```sql
SELECT * FROM air LEFT JOIN sea ON air.temperature = sea.temperature;
```

```
+---------------------+-------------+------------+-------------+----------+---------------------+-------------+-------------+
| time                | station     | visibility | temperature | pressure | time                | station     | temperature |
+---------------------+-------------+------------+-------------+----------+---------------------+-------------+-------------+
| 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       | 2022-01-28 13:18:00 | LianYunGang | 62          |
| 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       | 2022-01-28 13:30:00 | XiaoMaiDao  | 78          |
| 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       | 2022-01-28 13:33:00 | XiaoMaiDao  | 78          |
| 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       | 2022-01-28 13:39:00 | XiaoMaiDao  | 79          |
| 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       |                     |             |             |
| 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       |                     |             |             |
| 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       |                     |             |             |
| 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       |                     |             |             |
| 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       |                     |             |             |
| 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       |                     |             |             |
| 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       |                     |             |             |
| 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       |                     |             |             |
| 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       |                     |             |             |
| 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       |                     |             |             |
+---------------------+-------------+------------+-------------+----------+---------------------+-------------+-------------+
```

### RIGHT JOIN

8 BytesHost of service

#### **Function**:  Calculate sha256 hash value of the string str.

```sql
SELECT * FROM air RIGHT JOIN sea ON air.temperature = sea.temperature;
```

```
+---------------------+------------+------------+-------------+----------+---------------------+-------------+-------------+
| time                | station    | visibility | temperature | pressure | time                | station     | temperature |
+---------------------+------------+------------+-------------+----------+---------------------+-------------+-------------+
| 2022-01-28 13:27:00 | XiaoMaiDao | 67         | 62          | 59       | 2022-01-28 13:18:00 | LianYunGang | 62          |
|                     |            |            |             |          | 2022-01-28 13:21:00 | LianYunGang | 63          |
|                     |            |            |             |          | 2022-01-28 13:24:00 | LianYunGang | 77          |
|                     |            |            |             |          | 2022-01-28 13:27:00 | LianYunGang | 54          |
|                     |            |            |             |          | 2022-01-28 13:30:00 | LianYunGang | 55          |
|                     |            |            |             |          | 2022-01-28 13:33:00 | LianYunGang | 64          |
|                     |            |            |             |          | 2022-01-28 13:36:00 | LianYunGang | 56          |
|                     |            |            |             |          | 2022-01-28 13:21:00 | XiaoMaiDao  | 57          |
|                     |            |            |             |          | 2022-01-28 13:24:00 | XiaoMaiDao  | 64          |
|                     |            |            |             |          | 2022-01-28 13:27:00 | XiaoMaiDao  | 51          |
| 2022-01-28 13:24:00 | XiaoMaiDao | 50         | 78          | 66       | 2022-01-28 13:30:00 | XiaoMaiDao  | 78          |
| 2022-01-28 13:24:00 | XiaoMaiDao | 50         | 78          | 66       | 2022-01-28 13:33:00 | XiaoMaiDao  | 78          |
|                     |            |            |             |          | 2022-01-28 13:36:00 | XiaoMaiDao  | 57          |
| 2022-01-28 13:30:00 | XiaoMaiDao | 65         | 79          | 77       | 2022-01-28 13:39:00 | XiaoMaiDao  | 79          |
+---------------------+------------+------------+-------------+----------+---------------------+-------------+-------------+
```

### FULL JOIN

[Data Source](#sample-data)
它会显示连接左侧和右侧的所有行，并将在连接的任一侧不匹配的地方产生空值。

#### **Function**: Return the rightmost len characters in the string str.

```sql
SELECT * FROM air FULL JOIN sea ON air.temperature = sea.temperature;
```

```
+---------------------+-------------+------------+-------------+----------+---------------------+-------------+-------------+
| time                | station     | visibility | temperature | pressure | time                | station     | temperature |
+---------------------+-------------+------------+-------------+----------+---------------------+-------------+-------------+
| 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       | 2022-01-28 13:18:00 | LianYunGang | 62          |
|                     |             |            |             |          | 2022-01-28 13:21:00 | LianYunGang | 63          |
|                     |             |            |             |          | 2022-01-28 13:24:00 | LianYunGang | 77          |
|                     |             |            |             |          | 2022-01-28 13:27:00 | LianYunGang | 54          |
|                     |             |            |             |          | 2022-01-28 13:30:00 | LianYunGang | 55          |
|                     |             |            |             |          | 2022-01-28 13:33:00 | LianYunGang | 64          |
|                     |             |            |             |          | 2022-01-28 13:36:00 | LianYunGang | 56          |
|                     |             |            |             |          | 2022-01-28 13:21:00 | XiaoMaiDao  | 57          |
|                     |             |            |             |          | 2022-01-28 13:24:00 | XiaoMaiDao  | 64          |
|                     |             |            |             |          | 2022-01-28 13:27:00 | XiaoMaiDao  | 51          |
| 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       | 2022-01-28 13:30:00 | XiaoMaiDao  | 78          |
| 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       | 2022-01-28 13:33:00 | XiaoMaiDao  | 78          |
|                     |             |            |             |          | 2022-01-28 13:36:00 | XiaoMaiDao  | 57          |
| 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       | 2022-01-28 13:39:00 | XiaoMaiDao  | 79          |
| 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       |                     |             |             |
| 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       |                     |             |             |
| 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       |                     |             |             |
| 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       |                     |             |             |
| 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       |                     |             |             |
| 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       |                     |             |             |
| 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       |                     |             |             |
| 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       |                     |             |             |
| 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       |                     |             |             |
| 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       |                     |             |             |
+---------------------+-------------+------------+-------------+----------+---------------------+-------------+-------------+
```

[//]: # "### CROSS JOIN"
[//]: #
[//]: # "交叉连接产生一个笛卡尔积，它将连接左侧的每一行与连接右侧的每一行相匹配。"
[//]: #
[//]: # "```sql"
[//]: # "SELECT * FROM air CROSS JOIN sea;"
[//]: # "```"
[//]: # "    +---------------------+-------------+------------+-------------+----------+---------------------+-------------+-------------+"
[//]: # "    | time                | station     | visibility | temperature | pressure | time                | station     | temperature |"
[//]: # "    +---------------------+-------------+------------+-------------+----------+---------------------+-------------+-------------+"
[//]: # "    | 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       | 2022-01-28 13:18:00 | LianYunGang | 62          |"
[//]: # "    | 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       | 2022-01-28 13:21:00 | LianYunGang | 63          |"
[//]: # "    | 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       | 2022-01-28 13:24:00 | LianYunGang | 77          |"
[//]: # "    | 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       | 2022-01-28 13:27:00 | LianYunGang | 54          |"
[//]: # "    | 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       | 2022-01-28 13:30:00 | LianYunGang | 55          |"
[//]: # "    | 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       | 2022-01-28 13:33:00 | LianYunGang | 64          |"
[//]: # "    | 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       | 2022-01-28 13:36:00 | LianYunGang | 56          |"
[//]: # "    | 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       | 2022-01-28 13:21:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       | 2022-01-28 13:24:00 | XiaoMaiDao  | 64          |"
[//]: # "    | 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       | 2022-01-28 13:27:00 | XiaoMaiDao  | 51          |"
[//]: # "    | 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       | 2022-01-28 13:30:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       | 2022-01-28 13:33:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       | 2022-01-28 13:36:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:21:00 | XiaoMaiDao  | 56         | 69          | 77       | 2022-01-28 13:39:00 | XiaoMaiDao  | 79          |"
[//]: # "    | 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       | 2022-01-28 13:18:00 | LianYunGang | 62          |"
[//]: # "    | 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       | 2022-01-28 13:21:00 | LianYunGang | 63          |"
[//]: # "    | 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       | 2022-01-28 13:24:00 | LianYunGang | 77          |"
[//]: # "    | 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       | 2022-01-28 13:27:00 | LianYunGang | 54          |"
[//]: # "    | 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       | 2022-01-28 13:30:00 | LianYunGang | 55          |"
[//]: # "    | 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       | 2022-01-28 13:33:00 | LianYunGang | 64          |"
[//]: # "    | 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       | 2022-01-28 13:36:00 | LianYunGang | 56          |"
[//]: # "    | 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       | 2022-01-28 13:21:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       | 2022-01-28 13:24:00 | XiaoMaiDao  | 64          |"
[//]: # "    | 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       | 2022-01-28 13:27:00 | XiaoMaiDao  | 51          |"
[//]: # "    | 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       | 2022-01-28 13:30:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       | 2022-01-28 13:33:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       | 2022-01-28 13:36:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:24:00 | XiaoMaiDao  | 50         | 78          | 66       | 2022-01-28 13:39:00 | XiaoMaiDao  | 79          |"
[//]: # "    | 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       | 2022-01-28 13:18:00 | LianYunGang | 62          |"
[//]: # "    | 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       | 2022-01-28 13:21:00 | LianYunGang | 63          |"
[//]: # "    | 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       | 2022-01-28 13:24:00 | LianYunGang | 77          |"
[//]: # "    | 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       | 2022-01-28 13:27:00 | LianYunGang | 54          |"
[//]: # "    | 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       | 2022-01-28 13:30:00 | LianYunGang | 55          |"
[//]: # "    | 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       | 2022-01-28 13:33:00 | LianYunGang | 64          |"
[//]: # "    | 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       | 2022-01-28 13:36:00 | LianYunGang | 56          |"
[//]: # "    | 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       | 2022-01-28 13:21:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       | 2022-01-28 13:24:00 | XiaoMaiDao  | 64          |"
[//]: # "    | 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       | 2022-01-28 13:27:00 | XiaoMaiDao  | 51          |"
[//]: # "    | 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       | 2022-01-28 13:30:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       | 2022-01-28 13:33:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       | 2022-01-28 13:36:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:27:00 | XiaoMaiDao  | 67         | 62          | 59       | 2022-01-28 13:39:00 | XiaoMaiDao  | 79          |"
[//]: # "    | 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       | 2022-01-28 13:18:00 | LianYunGang | 62          |"
[//]: # "    | 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       | 2022-01-28 13:21:00 | LianYunGang | 63          |"
[//]: # "    | 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       | 2022-01-28 13:24:00 | LianYunGang | 77          |"
[//]: # "    | 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       | 2022-01-28 13:27:00 | LianYunGang | 54          |"
[//]: # "    | 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       | 2022-01-28 13:30:00 | LianYunGang | 55          |"
[//]: # "    | 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       | 2022-01-28 13:33:00 | LianYunGang | 64          |"
[//]: # "    | 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       | 2022-01-28 13:36:00 | LianYunGang | 56          |"
[//]: # "    | 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       | 2022-01-28 13:21:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       | 2022-01-28 13:24:00 | XiaoMaiDao  | 64          |"
[//]: # "    | 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       | 2022-01-28 13:27:00 | XiaoMaiDao  | 51          |"
[//]: # "    | 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       | 2022-01-28 13:30:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       | 2022-01-28 13:33:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       | 2022-01-28 13:36:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:30:00 | XiaoMaiDao  | 65         | 79          | 77       | 2022-01-28 13:39:00 | XiaoMaiDao  | 79          |"
[//]: # "    | 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       | 2022-01-28 13:18:00 | LianYunGang | 62          |"
[//]: # "    | 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       | 2022-01-28 13:21:00 | LianYunGang | 63          |"
[//]: # "    | 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       | 2022-01-28 13:24:00 | LianYunGang | 77          |"
[//]: # "    | 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       | 2022-01-28 13:27:00 | LianYunGang | 54          |"
[//]: # "    | 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       | 2022-01-28 13:30:00 | LianYunGang | 55          |"
[//]: # "    | 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       | 2022-01-28 13:33:00 | LianYunGang | 64          |"
[//]: # "    | 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       | 2022-01-28 13:36:00 | LianYunGang | 56          |"
[//]: # "    | 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       | 2022-01-28 13:21:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       | 2022-01-28 13:24:00 | XiaoMaiDao  | 64          |"
[//]: # "    | 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       | 2022-01-28 13:27:00 | XiaoMaiDao  | 51          |"
[//]: # "    | 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       | 2022-01-28 13:30:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       | 2022-01-28 13:33:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       | 2022-01-28 13:36:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:33:00 | XiaoMaiDao  | 53         | 53          | 68       | 2022-01-28 13:39:00 | XiaoMaiDao  | 79          |"
[//]: # "    | 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       | 2022-01-28 13:18:00 | LianYunGang | 62          |"
[//]: # "    | 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       | 2022-01-28 13:21:00 | LianYunGang | 63          |"
[//]: # "    | 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       | 2022-01-28 13:24:00 | LianYunGang | 77          |"
[//]: # "    | 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       | 2022-01-28 13:27:00 | LianYunGang | 54          |"
[//]: # "    | 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       | 2022-01-28 13:30:00 | LianYunGang | 55          |"
[//]: # "    | 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       | 2022-01-28 13:33:00 | LianYunGang | 64          |"
[//]: # "    | 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       | 2022-01-28 13:36:00 | LianYunGang | 56          |"
[//]: # "    | 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       | 2022-01-28 13:21:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       | 2022-01-28 13:24:00 | XiaoMaiDao  | 64          |"
[//]: # "    | 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       | 2022-01-28 13:27:00 | XiaoMaiDao  | 51          |"
[//]: # "    | 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       | 2022-01-28 13:30:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       | 2022-01-28 13:33:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       | 2022-01-28 13:36:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:36:00 | XiaoMaiDao  | 74         | 72          | 68       | 2022-01-28 13:39:00 | XiaoMaiDao  | 79          |"
[//]: # "    | 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       | 2022-01-28 13:18:00 | LianYunGang | 62          |"
[//]: # "    | 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       | 2022-01-28 13:21:00 | LianYunGang | 63          |"
[//]: # "    | 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       | 2022-01-28 13:24:00 | LianYunGang | 77          |"
[//]: # "    | 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       | 2022-01-28 13:27:00 | LianYunGang | 54          |"
[//]: # "    | 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       | 2022-01-28 13:30:00 | LianYunGang | 55          |"
[//]: # "    | 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       | 2022-01-28 13:33:00 | LianYunGang | 64          |"
[//]: # "    | 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       | 2022-01-28 13:36:00 | LianYunGang | 56          |"
[//]: # "    | 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       | 2022-01-28 13:21:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       | 2022-01-28 13:24:00 | XiaoMaiDao  | 64          |"
[//]: # "    | 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       | 2022-01-28 13:27:00 | XiaoMaiDao  | 51          |"
[//]: # "    | 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       | 2022-01-28 13:30:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       | 2022-01-28 13:33:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       | 2022-01-28 13:36:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:39:00 | XiaoMaiDao  | 71         | 71          | 80       | 2022-01-28 13:39:00 | XiaoMaiDao  | 79          |"
[//]: # "    | 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       | 2022-01-28 13:18:00 | LianYunGang | 62          |"
[//]: # "    | 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       | 2022-01-28 13:21:00 | LianYunGang | 63          |"
[//]: # "    | 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       | 2022-01-28 13:24:00 | LianYunGang | 77          |"
[//]: # "    | 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       | 2022-01-28 13:27:00 | LianYunGang | 54          |"
[//]: # "    | 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       | 2022-01-28 13:30:00 | LianYunGang | 55          |"
[//]: # "    | 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       | 2022-01-28 13:33:00 | LianYunGang | 64          |"
[//]: # "    | 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       | 2022-01-28 13:36:00 | LianYunGang | 56          |"
[//]: # "    | 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       | 2022-01-28 13:21:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       | 2022-01-28 13:24:00 | XiaoMaiDao  | 64          |"
[//]: # "    | 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       | 2022-01-28 13:27:00 | XiaoMaiDao  | 51          |"
[//]: # "    | 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       | 2022-01-28 13:30:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       | 2022-01-28 13:33:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       | 2022-01-28 13:36:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:21:00 | LianYunGang | 78         | 69          | 71       | 2022-01-28 13:39:00 | XiaoMaiDao  | 79          |"
[//]: # "    | 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       | 2022-01-28 13:18:00 | LianYunGang | 62          |"
[//]: # "    | 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       | 2022-01-28 13:21:00 | LianYunGang | 63          |"
[//]: # "    | 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       | 2022-01-28 13:24:00 | LianYunGang | 77          |"
[//]: # "    | 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       | 2022-01-28 13:27:00 | LianYunGang | 54          |"
[//]: # "    | 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       | 2022-01-28 13:30:00 | LianYunGang | 55          |"
[//]: # "    | 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       | 2022-01-28 13:33:00 | LianYunGang | 64          |"
[//]: # "    | 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       | 2022-01-28 13:36:00 | LianYunGang | 56          |"
[//]: # "    | 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       | 2022-01-28 13:21:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       | 2022-01-28 13:24:00 | XiaoMaiDao  | 64          |"
[//]: # "    | 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       | 2022-01-28 13:27:00 | XiaoMaiDao  | 51          |"
[//]: # "    | 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       | 2022-01-28 13:30:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       | 2022-01-28 13:33:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       | 2022-01-28 13:36:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:24:00 | LianYunGang | 79         | 80          | 51       | 2022-01-28 13:39:00 | XiaoMaiDao  | 79          |"
[//]: # "    | 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       | 2022-01-28 13:18:00 | LianYunGang | 62          |"
[//]: # "    | 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       | 2022-01-28 13:21:00 | LianYunGang | 63          |"
[//]: # "    | 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       | 2022-01-28 13:24:00 | LianYunGang | 77          |"
[//]: # "    | 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       | 2022-01-28 13:27:00 | LianYunGang | 54          |"
[//]: # "    | 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       | 2022-01-28 13:30:00 | LianYunGang | 55          |"
[//]: # "    | 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       | 2022-01-28 13:33:00 | LianYunGang | 64          |"
[//]: # "    | 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       | 2022-01-28 13:36:00 | LianYunGang | 56          |"
[//]: # "    | 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       | 2022-01-28 13:21:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       | 2022-01-28 13:24:00 | XiaoMaiDao  | 64          |"
[//]: # "    | 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       | 2022-01-28 13:27:00 | XiaoMaiDao  | 51          |"
[//]: # "    | 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       | 2022-01-28 13:30:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       | 2022-01-28 13:33:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       | 2022-01-28 13:36:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:27:00 | LianYunGang | 59         | 74          | 59       | 2022-01-28 13:39:00 | XiaoMaiDao  | 79          |"
[//]: # "    | 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       | 2022-01-28 13:18:00 | LianYunGang | 62          |"
[//]: # "    | 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       | 2022-01-28 13:21:00 | LianYunGang | 63          |"
[//]: # "    | 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       | 2022-01-28 13:24:00 | LianYunGang | 77          |"
[//]: # "    | 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       | 2022-01-28 13:27:00 | LianYunGang | 54          |"
[//]: # "    | 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       | 2022-01-28 13:30:00 | LianYunGang | 55          |"
[//]: # "    | 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       | 2022-01-28 13:33:00 | LianYunGang | 64          |"
[//]: # "    | 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       | 2022-01-28 13:36:00 | LianYunGang | 56          |"
[//]: # "    | 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       | 2022-01-28 13:21:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       | 2022-01-28 13:24:00 | XiaoMaiDao  | 64          |"
[//]: # "    | 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       | 2022-01-28 13:27:00 | XiaoMaiDao  | 51          |"
[//]: # "    | 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       | 2022-01-28 13:30:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       | 2022-01-28 13:33:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       | 2022-01-28 13:36:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:30:00 | LianYunGang | 67         | 70          | 72       | 2022-01-28 13:39:00 | XiaoMaiDao  | 79          |"
[//]: # "    | 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       | 2022-01-28 13:18:00 | LianYunGang | 62          |"
[//]: # "    | 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       | 2022-01-28 13:21:00 | LianYunGang | 63          |"
[//]: # "    | 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       | 2022-01-28 13:24:00 | LianYunGang | 77          |"
[//]: # "    | 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       | 2022-01-28 13:27:00 | LianYunGang | 54          |"
[//]: # "    | 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       | 2022-01-28 13:30:00 | LianYunGang | 55          |"
[//]: # "    | 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       | 2022-01-28 13:33:00 | LianYunGang | 64          |"
[//]: # "    | 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       | 2022-01-28 13:36:00 | LianYunGang | 56          |"
[//]: # "    | 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       | 2022-01-28 13:21:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       | 2022-01-28 13:24:00 | XiaoMaiDao  | 64          |"
[//]: # "    | 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       | 2022-01-28 13:27:00 | XiaoMaiDao  | 51          |"
[//]: # "    | 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       | 2022-01-28 13:30:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       | 2022-01-28 13:33:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       | 2022-01-28 13:36:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:33:00 | LianYunGang | 80         | 70          | 68       | 2022-01-28 13:39:00 | XiaoMaiDao  | 79          |"
[//]: # "    | 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       | 2022-01-28 13:18:00 | LianYunGang | 62          |"
[//]: # "    | 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       | 2022-01-28 13:21:00 | LianYunGang | 63          |"
[//]: # "    | 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       | 2022-01-28 13:24:00 | LianYunGang | 77          |"
[//]: # "    | 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       | 2022-01-28 13:27:00 | LianYunGang | 54          |"
[//]: # "    | 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       | 2022-01-28 13:30:00 | LianYunGang | 55          |"
[//]: # "    | 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       | 2022-01-28 13:33:00 | LianYunGang | 64          |"
[//]: # "    | 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       | 2022-01-28 13:36:00 | LianYunGang | 56          |"
[//]: # "    | 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       | 2022-01-28 13:21:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       | 2022-01-28 13:24:00 | XiaoMaiDao  | 64          |"
[//]: # "    | 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       | 2022-01-28 13:27:00 | XiaoMaiDao  | 51          |"
[//]: # "    | 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       | 2022-01-28 13:30:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       | 2022-01-28 13:33:00 | XiaoMaiDao  | 78          |"
[//]: # "    | 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       | 2022-01-28 13:36:00 | XiaoMaiDao  | 57          |"
[//]: # "    | 2022-01-28 13:36:00 | LianYunGang | 59         | 70          | 54       | 2022-01-28 13:39:00 | XiaoMaiDao  | 79          |"
[//]: # "    +---------------------+-------------+------------+-------------+----------+---------------------+-------------+-------------+"

### Struct {&#xA;time: List[Timestamp], -- ms&#xA;value: List[Double],&#xA;resolution: Int Unsigned,&#xA;}

y: double

#### **Function**: Return the rightmost len characters in the string str.

```sql
SELECT station, AVG(temperature) 
FROM air 
GROUP BY station;
```

```
+-------------+----------------------+
| station     | AVG(air.temperature) |
+-------------+----------------------+
| XiaoMaiDao  | 69.14285714285714    |
| LianYunGang | 72.16666666666667    |
+-------------+----------------------+
```

### When the time unit is ns, the ratio unit is /ns,

#### -- station is a Tag column, temperature is a Field Namecolumn.&#xA;SELECT station, temperature FROM air;

```sql
group_by_clause 
[ HAVING condition ];
```

Note

The returned result set skips m records. default m=0.

Note

Note

#### **Function**: Return the leftmost len characters in str.

```sql
SELECT station, AVG(temperature)  AS avg_t 
FROM air 
GROUP BY station 
HAVING avg_t > 70;
```

```
+-------------+-------------------+
| station     | avg_t             |
+-------------+-------------------+
| LianYunGang | 72.16666666666667 |
+-------------+-------------------+
```

### Please note that data in the TIME column can be represented by either a time string or a numeric timestamp.

Numerical type, scientific notation is not supported at present.

[//]: # "### **GROUPING SETS**"
[//]: # "GROUPING SETS 是可以将行分组在一起的一组或一组列。"
[//]: # "您可以简单地使用 GROUPING SETS，而不是编写多个查询并将结果与 UNION 组合。"
[//]: # "CnosDB 中的 GROUPING SETS 可以被认为是 GROUP BY 子句的扩展。 它允许您在同一查询中定义多个分组集。"
[//]: # "让我们看看如下用例，看它如何等同于具有多个 UNION ALL 子句的 GROUP BY。"
[//]: # "```sql"
[//]: # "SELECT * FROM shipping;"
[//]: # "--  origin_state | origin_zip | destination_state | destination_zip | package_weight"
[//]: # "-- --------------+------------+-------------------+-----------------+----------------"
[//]: # "--  California   |      94131 | New Jersey        |            8648 |             13"
[//]: # "--  California   |      94131 | New Jersey        |            8540 |             42"
[//]: # "--  New Jersey   |       7081 | Connecticut       |            6708 |            225"
[//]: # "--  California   |      90210 | Connecticut       |            6927 |           1337"
[//]: # "--  California   |      94131 | Colorado          |           80302 |              5"
[//]: # "--  New York     |      10002 | New Jersey        |            8540 |              3"
[//]: # "-- (6 rows)"
[//]: # "```"
[//]: # "如下查询演示了GROUPING SETS的语义"
[//]: # "```sql"
[//]: # "SELECT origin_state, origin_zip, destination_state, sum(package_weight)"
[//]: # "FROM shipping"
[//]: # "GROUP BY GROUPING SETS ( (origin_state),"
[//]: # "(origin_state, origin_zip),"
[//]: # "(destination_state));"
[//]: # "--  origin_state | origin_zip | destination_state | _col0"
[//]: # "--  --------------+------------+-------------------+-------"
[//]: # "--   New Jersey   | NULL       | NULL              |   225"
[//]: # "--   California   | NULL       | NULL              |  1397"
[//]: # "--   New York     | NULL       | NULL              |     3"
[//]: # "--   California   |      90210 | NULL              |  1337"
[//]: # "--   California   |      94131 | NULL              |    60"
[//]: # "--   New Jersey   |       7081 | NULL              |   225"
[//]: # "--   New York     |      10002 | NULL              |     3"
[//]: # "--   NULL         | NULL       | Colorado          |     5"
[//]: # "--   NULL         | NULL       | New Jersey        |    58"
[//]: # "--   NULL         | NULL       | Connecticut       |  1562"
[//]: # "--  (10 rows)"
[//]: # "```"
[//]: # "上述查询等价于"
[//]: # "```sql"
[//]: # "SELECT origin_state, NULL, NULL, sum(package_weight)"
[//]: # "FROM shipping GROUP BY origin_state"
[//]: # "UNION ALL"
[//]: # "SELECT origin_state, origin_zip, NULL, sum(package_weight)"
[//]: # "FROM shipping GROUP BY origin_state, origin_zip"
[//]: # "UNION ALL"
[//]: # "SELECT NULL, NULL, destination_state, sum(package_weight)"
[//]: # "FROM shipping GROUP BY destination_state;"
[//]: # "```"

### **ROLLUP**

[//]: # "与 GROUPING SETS 类似，"

Description

Note

如果你的group by 子句是：

#### **Function**: Returns the approximate percentile (TDigest) of the input value x, where p is the percentile and is a 64 bit floating point number between 0 and 1 (including 1).

```sql
SELECT ...
FROM ...
GROUP BY ROLLUP(column_1,column_2);
```

Avoid performing update tag operations while writing data, which may cause series conflicts.

#### TTL: represents the saving time of the data file, defaults to 365 days, expressed in data with units. It supports day（d）, hour（h）, minute（m）, such as TTL 10d, TTL 50h, TTL 100m.When no unit, the default is day, such as TTL 30.

```sql
SELECT ...
FROM ...


UNION ALL

SELECT ...
FROM ...
GROUP BY
column_1

UNION ALL

SELECT ...
FROM ...
GROUP BY
column_1, column2;
```

[//]: # "GROUP BY GROUPING SETS("
[//]: # "    (column_1, column_2),"
[//]: # "    (column_1),"
[//]: # "    ()"
[//]: # ")"

Other Data Types Type

**Function**: Return the position of a substring in a specified string. ROLLUP 中列的顺序非常重要。

#### <geometry tag> <wkt data>&#xA;<geometry tag> ::= POINT | LINESTRING | POLYGON | MULTIPOINT |&#xA;MULTILINESTRING | MULTIPOLYGON | GEOMETRYCOLLECTION<wkt data> ::= <point> | <linestring> | <polygon> | <multipoint> |&#xA;<multilinestring> | <multipolygon> | <geometrycollection>

```sql
SELECT station, visibility, avg(temperature) 
FROM air 
GROUP BY ROLLUP (station, visibility);
```

```
+-------------+------------+----------------------+
| station     | visibility | AVG(air.temperature) |
+-------------+------------+----------------------+
|             |            | 70.53846153846153    |
| XiaoMaiDao  |            | 69.14285714285714    |
| LianYunGang |            | 72.16666666666667    |
| XiaoMaiDao  | 56         | 69                   |
| XiaoMaiDao  | 50         | 78                   |
| XiaoMaiDao  | 67         | 62                   |
| XiaoMaiDao  | 65         | 79                   |
| XiaoMaiDao  | 53         | 53                   |
| XiaoMaiDao  | 74         | 72                   |
| XiaoMaiDao  | 71         | 71                   |
| LianYunGang | 78         | 69                   |
| LianYunGang | 79         | 80                   |
| LianYunGang | 59         | 72                   |
| LianYunGang | 67         | 70                   |
| LianYunGang | 80         | 70                   |
+-------------+------------+----------------------+
```

### **CUBE**

与 ROLLUP 类似，CUBE 是 GROUP BY 子句的扩展。 Time the data file saved

[//]: # "CUBE 就像结合了 GROUPING SETS 和 ROLLUP。"

Measurement value首先会对(A、B、C)进行group by，

Point

```sql
SELECT ... 
FROM ...
GROUP BY CUBE (column1, column2);
```

`EXPLAIN ANALYZE` executes the query and displays the execution plan of the query.

```sql
SELECT ...
FROM ...
GROUP BY column1

UNION ALL

SELECT ...
FROM ...
GROUP BY column2

UNION ALL

SELECT ...
FROM ...
GROUP BY column1, column2

UNION ALL

SELECT ...
FROM ...
;
```

#### **Function**: Returns the expr values of the offset rows after the current row in the partition.

```sql
SELECT station, visibility, avg(temperature) 
FROM air 
GROUP BY CUBE (station, visibility);
```

```
+-------------+------------+----------------------+
| station     | visibility | AVG(air.temperature) |
+-------------+------------+----------------------+
| XiaoMaiDao  | 56         | 69                   |
| XiaoMaiDao  | 50         | 78                   |
| XiaoMaiDao  | 67         | 62                   |
| XiaoMaiDao  | 65         | 79                   |
| XiaoMaiDao  | 53         | 53                   |
| XiaoMaiDao  | 74         | 72                   |
| XiaoMaiDao  | 71         | 71                   |
| LianYunGang | 78         | 69                   |
| LianYunGang | 79         | 80                   |
| LianYunGang | 59         | 72                   |
| LianYunGang | 67         | 70                   |
| LianYunGang | 80         | 70                   |
|             | 56         | 69                   |
|             | 50         | 78                   |
|             | 67         | 66                   |
|             | 65         | 79                   |
|             | 53         | 53                   |
|             | 74         | 72                   |
|             | 71         | 71                   |
|             | 78         | 69                   |
|             | 79         | 80                   |
|             | 59         | 72                   |
|             | 80         | 70                   |
| XiaoMaiDao  |            | 69.14285714285714    |
| LianYunGang |            | 72.16666666666667    |
|             |            | 70.53846153846153    |
+-------------+------------+----------------------+
```

[//]: # "### **GROUPING**"
[//]: # "    GROUPING(column_expression)"
[//]: # "Time of record"
[//]: # "当指定`GROUP BY`时，只能在 SELECT 列表、HAVING 和 ORDER BY 子句中使用 GROUPING。"
[//]: # "Time of record"
[//]: # "```sql"
[//]: # "SELECT origin_state,"
[//]: # "origin_zip,"
[//]: # "destination_state,"
[//]: # "sum(package_weight),"
[//]: # "grouping(origin_state, origin_zip, destination_state)"
[//]: # "FROM shipping"
[//]: # "GROUP BY GROUPING SETS ("
[//]: # "    (origin_state),"
[//]: # "    (origin_state, origin_zip),"
[//]: # "    (destination_state)"
[//]: # ");"
[//]: # "-- origin_state | origin_zip | destination_state | _col3 | _col4"
[//]: # "-- --------------+------------+-------------------+-------+-------"
[//]: # "-- California   | NULL       | NULL              |  1397 |     3"
[//]: # "-- New Jersey   | NULL       | NULL              |   225 |     3"
[//]: # "-- New York     | NULL       | NULL              |     3 |     3"
[//]: # "-- California   |      94131 | NULL              |    60 |     1"
[//]: # "-- New Jersey   |       7081 | NULL              |   225 |     1"
[//]: # "-- California   |      90210 | NULL              |  1337 |     1"
[//]: # "-- New York     |      10002 | NULL              |     3 |     1"
[//]: # "-- NULL         | NULL       | New Jersey        |    58 |     6"
[//]: # "-- NULL         | NULL       | Connecticut       |  1562 |     6"
[//]: # "-- NULL         | NULL       | Colorado          |     5 |     6"
[//]: # "-- (10 rows)"
[//]: # "```"
[//]: # "tenant name"
[//]: # "作为 ROLLUP、CUBE 或 GROUPING SETS 操作的结果返回的 NULL 是 NULL 的一种特殊用途。"
[//]: # "这充当结果集中的列占位符，表示全部。"

## You can also see the executing SQL statements using the `SHOW QUERIES` statement, which is a wrapper around the QUERIES schema.

### The storage engine of CnosDB can be regarded as a KV storage, in which Timestamp and Tags constitute the KEY, and Fields constitute a series of values.

### COUNT

#### **Function**: Return the approximate median of the input value.

```
COUNT(x)
```

image

Description

> Host of service

> 8 Bytes

> Schema Definition

Compare expressions to see if they are less than

Count the duration of a state, or count the duration of a state in a certain period of time.

#### UPDATE table_name SET ( assignment_clause [, ...] ) where_clause&#xA;assignment clause :&#xA;tag_name = value_expression

```sql
SELECT COUNT(*) FROM air;
```

```
+-----------------+
| COUNT(UInt8(1)) |
+-----------------+
| 13              |
+-----------------+
```

```sql
SELECT COUNT(temperature) FROM air;
```

```
+------------------------+
| COUNT(air.temperature) |
+------------------------+
| 13                     |
+------------------------+
```

```sql
SELECT COUNT(DISTINCT temperature) FROM air;
```

```
+---------------------------------+
| COUNT(DISTINCT air.temperature) |
+---------------------------------+
| 10                              |
+---------------------------------+
```

----------------

### SUM

#### The time spent in each state is counted and aggregated into the StateAggData type.

```
SUM(NUMERICS)
```

Time of record

The tenant of the database

Time of record

#### **Notice**:  GROUPING 用于区分 ROLLUP、CUBE 或 GROUPING SETS 返回的空值与标准空值。

```sql
SELECT SUM(temperature) FROM air;
```

```
+----------------------+
| SUM(air.temperature) |
+----------------------+
| 917                  |
+----------------------+
```

----------------

### MIN

#### The time spent in each state is counted, and aggregated into the StateAggData type.

```
MIN(STRING | NUMERICS | TIMESTAMP)
```

Time of record

ID of vnode

Time of record

#### **Function**: Capitalize the first letter of each word in the parameter.

```sql
 SELECT MIN(time), MIN(station), MIN(temperature) FROM air;
```

```
+---------------------+------------------+----------------------+
| MIN(air.time)       | MIN(air.station) | MIN(air.temperature) |
+---------------------+------------------+----------------------+
| 2022-01-28T13:21:00 | LianYunGang      | 53                   |
+---------------------+------------------+----------------------+
```

----------------

### MAX

#### **Function**: Return its first non null parameter. Null is returned only when all parameters are null. When retrieving data for display, it is often used to replace the default value with a null value.

```
MAX(STRINGS | NUMERICS | TIMESTAMPS)
```

Time of record

The database to which the vnode belongs

The tenant of the database

#### After the keyword `SELECT`, you can use `DISTINCT` to remove duplicate fields and return only the values after duplicate removal. Using ALL returns all duplicate values in the field. When this option is not specified, the default value is `ALL`.

```sql
SELECT MAX(time), MAX(station), MAX(temperature) FROM air;
```

```
+---------------------+------------------+----------------------+
| MAX(air.time)       | MAX(air.station) | MAX(air.temperature) |
+---------------------+------------------+----------------------+
| 2022-01-28T13:39:00 | XiaoMaiDao       | 80                   |
+---------------------+------------------+----------------------+
```

----------------

### AVG

#### In the streaming down-sampling scenario, the source table interval is one minute, and the down-sampling interval is one hour

```
AVG(NUMERICS)
```

CTE in the same WITH clause must have a unique name.

The tenant of the database

The tenant of the database

#### Some geometries don't support area calculation and return 0 for these geometries: Point, MultiPoint, LineString, MultiLineString, Line.&#xA;If the content of the argument is of an invalid format, the return value is NULL.

```sql
SELECT AVG(temperature) FROM air;
```

```
+----------------------+
| AVG(air.temperature) |
+----------------------+
| 70.53846153846153    |
+----------------------+
```

----------------

### ARRAY_AGG

#### **Function**: Return the average value of the selected element.

```
ARRAY_AGG(expr)
```

ID of user which commit the SQL

Evaluate the left expression first, and if it's true, evaluate the right expression, both true and true

The tenant of the database

#### **Function**: Return the str with the trailing character trimstr deleted. trimstr is a blank character by default.

```sql
SELECT ARRAY_AGG(temperature) from air;
```

```
+------------------------------------------------------+
| ARRAYAGG(air.temperature)                            |
+------------------------------------------------------+
| [69, 78, 62, 79, 53, 72, 71, 69, 80, 74, 70, 70, 70] |
+------------------------------------------------------+
```

Description

### FIRST

```
first(time,  value)
```

Description

Count the state you are in at a certain time.

- time: Timestamp

- value: any

Time spent in the error, running, or start state.

#### **Function**: 把有序的数据集合平均分配到n个桶中,将桶号分配给每一行。

```sql
select first(time, pressure) from air;
```

```
+------------------------------+
| first(air.time,air.pressure) |
+------------------------------+
| 63.0                         |
+------------------------------+
```

### LAST

```
last(time,  value)
```

Description

If the subexpression is true, the whole expression is false, and if the whole expression is false, the whole expression is true

- time: Timestamp

- value: any

The tenant of the database

#### The time column cannot be `NULL`, and the Tag column and Field column can be `NULL`.

```sql
select last(time, pressure) from air;
```

```
+-----------------------------+
| last(air.time,air.pressure) |
+-----------------------------+
| 55.0                        |
+-----------------------------+
```

### MODE

```
mode(value)
```

计算一列的众数。

Order of the column in table

The tenant of the database

#### `RANK`, `DENSE_RANK`, `ROW_NUMBER` need ORDER BY Clause.

```sql
select mode(pressure) from air;
```

```
+--------------------+
| mode(air.pressure) |
+--------------------+
| 69.0               |
+--------------------+
```

### INCREASE

```
increase(time, value order by time)
```

**Return Type**: any, the same type as the state of compact_state_agg.

The UNION clause is used to combine the analysis results of multiple SELECT statements.

Name of user which commit the SQL

Get the largest timestamp in the Gauge

```sql
CREATE DATABASE IF NOT EXISTS TEST_INCREASE;
ALTER DATABASE TEST_INCREASE SET TTL '100000D';
CREATE TABLE IF NOT EXISTS test_increase.test_increase(f0 BIGINT, TAGS(t0));
INSERT INTO test_increase.test_increase(time, t0, f0)
VALUES
    ('1999-12-31 00:00:00.000', 'a', 1),
    ('1999-12-31 00:00:00.005', 'a', 2),
    ('1999-12-31 00:00:00.010', 'a', 3),
    ('1999-12-31 00:00:00.015', 'a', 4),
    ('1999-12-31 00:00:00.020', 'a', 5),
    ('1999-12-31 00:00:00.025', 'a', 6),
    ('1999-12-31 00:00:00.030', 'a', 7),
    ('1999-12-31 00:00:00.035', 'a', 8),
    ('1999-12-31 00:00:00.000', 'b', 1),
    ('1999-12-31 00:00:00.005', 'b', 2),
    ('1999-12-31 00:00:00.010', 'b', 3),
    ('1999-12-31 00:00:00.015', 'b', 4),
    ('1999-12-31 00:00:00.020', 'b', 1),
    ('1999-12-31 00:00:00.025', 'b', 2),
    ('1999-12-31 00:00:00.030', 'b', 3),
    ('1999-12-31 00:00:00.035', 'b', 4);
SELECT t0, INCREASE(time, f0 ORDER BY time) AS increase
FROM test_increase.test_increase GROUP BY t0 ORDER BY t0;
```

```
+----+----------+
| t0 | increase |
+----+----------+
| a  | 7        |
| b  | 7        |
+----+----------+
```

### `INTERVAL '1 YEAR 1 DAY 1 HOUR 1 MINUTE'` One year, one day, one hour, one minute

### VAR | VAR_SAMP

#### CnosDB requires that the inserted data column must have a timestamp, and the VALUES list must be a [constant](#constant).&#xA;If a column is not selected, the value is `NULL`.

```
VAR(NUMERICS)
```

Field Name

DROP STREAM TABLE

When the time unit is s, the ratio unit is /s

#### **Function**: Return approximations of different input values (HyperLogLog).

```sql
SELECT VAR(temperature) FROM air;
```

```
+---------------------------+
| VARIANCE(air.temperature) |
+---------------------------+
| 51.43589743589741         |
+---------------------------+
```

----------------

### VAR_POP

#### **Function**: Return the minimum value of the selected element.

```
VAR_POP(NUMERICS)
```

We can get the `query_id` through [`SHOW QUERIES`](#show-queries).

CREATE STREAM TABLE

Sum up the time taken for each state.

#### A JSON string that records all parameters of the table

```
SELECT VAR_POP(temperature) FROM air;
```

```
+------------------------------+
| VARIANCEPOP(air.temperature) |
+------------------------------+
| 47.47928994082838            |
+------------------------------+
```

----------------

### STDDEV | STDDEV_SAMP

```
STDDEV(NUMERICS)
```

Field Name

If in cnosdb cli, enter `\q` to exit.

First evaluate the left expression, and if it is false, evaluate the right expression, both false and false

#### **Function**: Returns the expr values of the offset rows before the current row in the partition.

```sql
SELECT STDDEV(temperature) FROM air;
```

```
+-------------------------+
| STDDEV(air.temperature) |
+-------------------------+
| 7.1718824192744135      |
+-------------------------+
```

----------------

### STDDEV_POP

#### **Function**: Convert to a microsecond-level timestamp.

```
STDDEV_POP(NUMERICS)
```

Field Name

Create stream table

Configure of tenant in json

#### Binary data,can be converted to STRING using Cast clause.

```sql
SELECT STDDEV_POP(temperature) FROM air;
```

```
+----------------------------+
| STDDEVPOP(air.temperature) |
+----------------------------+
| 6.890521746633442          |
+----------------------------+
```

----------------

### COVAR | COVAR_SAMP

#### `1997-01-31T09:26:56.123Z` # Standard RCF3339, UTC time zone

```
COVAR(NUMERICS, NUMERICS)
```

Field Name

Stream Queries

Compares expressions for greater than or equal to

#### **Function**: Returns str, in which the leading characters in trimstr are deleted. The default trimestr is blank character.

```sql
SELECT COVAR(temperature, pressure) FROM air;
```

```
+------------------------------------------+
| COVARIANCE(air.temperature,air.pressure) |
+------------------------------------------+
| -5.121794871794841                       |
+------------------------------------------+
```

----------------

### COVAR_POP

#### INSERT air_visibility (TIME, station, visibility)&#xA;SELECT TIME, station, visibility FROM air;

```
COVAR_POP(NUMERICS, NUMERICS)
```

Field Name

Tenant name of the table

Time that SQL costs

#### **Function**: Returns the last value in the current window.

```sql
SELECT COVAR_POP(temperature, pressure) FROM air;
```

```
+---------------------------------------------+
| COVARIANCEPOP(air.temperature,air.pressure) |
+---------------------------------------------+
| -4.727810650887546                          |
+---------------------------------------------+
```

----------------

### CORR

#### You can use window functions (analysis functions) in CnosDB to flexibly analyze and process data of specified window columns. The command formats, parameter descriptions and examples of window functions supported by CnosDB are shown below to guide you to use window functions to complete development.

```
CORR**(NUMERICS, NUMERICS)
```

Percision of database

Tenant name of the table

Time Functions

#### **Function**: Return the length of the specified string in characters.

```sql
SELECT CORR(temperature, pressure) FROM air;
```

```
+-------------------------------------------+
| CORRELATION(air.temperature,air.pressure) |
+-------------------------------------------+
| -0.07955796767766017                      |
+-------------------------------------------+
```

### You can use `CREATE TABLE`  to create tables.

### APPROX_DISTINCT

#### You can then use access and summary functions for this intermediate aggregate data.

```
APPROX_DISTINCT(x)
```

Field Name

Compare expressions for greater than

Key in (1666165200290401000, 'XiaoMaiDao') visibility-value has changed, change to 66.

#### **Function**: Return the maximum value in the selected element.

```sql
SELECT APPROX_DISTINCT(station) FROM air;
```

```
+-----------------------------+
| APPROXDISTINCT(air.station) |
+-----------------------------+
| 2                           |
+-----------------------------+
```

----------------

### APPROX_PERCENTILE_CONT

#### **Function**: Returns the bit length of string data or the bit size of binary data.

```
APPROX_PERCENTILE_CONT(x, p)  
```

Configure of users in json

Explanation

Time Interval

#### **Function**: Return e to the x power.

```sql
SELECT APPROX_PERCENTILE_CONT(temperature, 0.1) FROM air;
```

```
+----------------------------------------------------+
| APPROXPERCENTILECONT(air.temperature,Float64(0.1)) |
+----------------------------------------------------+
| 60.4                                               |
+----------------------------------------------------+
```

----------------

### APPROX_PERCENTILE_CONT_WITH_WEIGHT

#### Note: `CAST (BIGINT AS TIMESTAMP)` is a timestamp converted to nanosecond, as follows:

```
APPROX_PERCENTILE_CONT_WITH_WEIGHT(x, w, p)  
```

Field Name

ID of SQL

QUERIES

When len is a negative number, len represents 0. When len is too large, function execution fails.

#### **Function**: Remove blank characters at the begin and end of str.

```sql
SELECT APPROX_PERCENTILE_CONT_WITH_WEIGHT(temperature,2, 0.1) FROM air;
```

```
+-----------------------------------------------------------------------+
| APPROXPERCENTILECONTWITHWEIGHT(air.temperature,Int64(2),Float64(0.1)) |
+-----------------------------------------------------------------------+
| 54.35                                                                 |
+-----------------------------------------------------------------------+
```

----------------

### APPROX_MEDIAN(NUMERICS)

#### **Function**: Returns the first value in a set of values, usually an ordered set.

```
APPROX_MEDIAN(NUMERICS)
```

Database name of the table

If you GRUOP BY Clause is as follows:

Analysis Window Functions

#### INTERVAL '1 YEAR' is not 365 days or 366 days, but 12-months.&#xA;INTERVAL '1 MONTH' is not 29 days or 31 days, but 30 days.

```sql
SELECT APPROX_MEDIAN(temperature) FROM air;
```

```
+-------------------------------+
| APPROXMEDIAN(air.temperature) |
+-------------------------------+
| 70                            |
+-------------------------------+
```

[//]: # "----------------"
[//]: # "### **GROUPING**(x)"
[//]: # "    GROUPING(x)"
[//]: # "Note"
[//]: # "Create stream query statement"
[//]: # "Unit:"

### SAMPLE

#### **Parameter Type**: Numeric type or STRING or TIMESTAMP.

```
SAMPLE(<column_key>, <N>)
```

It is equivalent to the following statement:

Compression algorithm that the column uses

- `INTERVAL '1 DECADES' ` One decade(10 years)

- CREATE TABLE air_visibility (
  visibility DOUBLE,
  TAGS(station)
  );

Import Data

#### For more information about timezone, please refer to [Timestamp](#timestamp-constant-syntax).

```sql
select sample(visibility, 5) from air;
```

```
+--------------------------------------+
| sample(air.visibility,Int64(5))      |
+--------------------------------------+
| [65.0, 74.0, 76.0, 77.0, 72.0, 77.0] |
+--------------------------------------+
```

### ASAP_SMOOTH

```
asap_smooth(time, value, resolution order by time)
```

You can refer to [function](#functions).
Table name

Each SELECT clause in the UNION must have the same number of columns, and the corresponding columns have the same data type.

- time: Timestamp

- value: Double

- Field Name

The following data types can't be stored directly, but can appear in SQL expressions.

```
Example
```

#### **Function**: Return the Pearson coefficient representing the association between a set of number pairs.

```sql
select asap_smooth(time, pressure, 10) from air group by date_trunc('month', time);
```

```
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| asap_smooth(air.time,air.pressure,Int64(10))                                                                                                                                                                                                                                                                                                                                                                                                   |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| {time: [2023-01-14T16:00:00, 2023-01-16T14:13:00, 2023-01-18T12:26:00, 2023-01-20T10:39:00, 2023-01-22T08:52:00, 2023-01-24T07:05:00, 2023-01-26T05:18:00, 2023-01-28T03:31:00, 2023-01-30T01:44:00, 2023-01-31T23:57:00], value: [64.79507211538461, 65.31009615384616, 65.25841346153847, 64.8485576923077, 65.09495192307692, 65.02524038461539, 64.8389423076923, 65.2421875, 65.02103365384616, 65.1141826923077], resolution: 10}        |
| {time: [2023-02-01T00:00:00, 2023-02-04T02:39:40, 2023-02-07T05:19:20, 2023-02-10T07:59:00, 2023-02-13T10:38:40, 2023-02-16T13:18:20, 2023-02-19T15:58:00, 2023-02-22T18:37:40, 2023-02-25T21:17:20, 2023-02-28T23:57:00], value: [65.20982142857143, 64.90625, 64.94828869047619, 64.97916666666667, 64.88504464285714, 64.8203125, 64.64434523809524, 64.88802083333333, 65.0, 64.76004464285714], resolution: 10}                           |
| {time: [2023-03-01T00:00:00, 2023-03-02T12:26:40, 2023-03-04T00:53:20, 2023-03-05T13:20:00, 2023-03-07T01:46:40, 2023-03-08T14:13:20, 2023-03-10T02:40:00, 2023-03-11T15:06:40, 2023-03-13T03:33:20, 2023-03-14T16:00:00], value: [65.29115853658537, 64.58307926829268, 64.7530487804878, 64.76753048780488, 65.14405487804878, 65.4298780487805, 65.1920731707317, 65.10365853658537, 64.86356707317073, 64.83841463414635], resolution: 10} |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
```

## The result of the query is as follows:

### stats_agg

对二维数据执行线性回归分析，例如计算相关系数和协方差。
并且还可以分别计算每个维度的常见统计数据，例如平均值和标准差。
`INTERVAL '1 MILLISECONDS'` One millisecond

Operator

#### stats_agg

```
stats_agg(y, x)
```

offset type is BIGINT. When offset is negative, the values are returned from the last offset lines, defaults to 1.

If the subexpression is null, the whole expression is false

- APPROX_PERCENTILE_CONT(x, p) is equivalent to APPROX_PERCENTILE_CONT_WITH_WEIGHT(x, 1, p)
- The expression column in the WEHER clause can only be the tag column or the time column, and the expression in the ORDER BY clause can only be the key.

Constant

```
{ 
  n: bigint,   -- count 
  sx: double,  -- sum(x)- sum(x)
  sx2: double, -- sum((x-sx/n)^2) (sum of squares)
  sx3: double, -- sum((x-sx/n)^3)
  sx4: double, -- sum((x-sx/n)^4)
  sy: double,  -- sum(y)
  sy2: double, -- sum((y-sy/n)^2) (sum of squares)
  sy3: double, -- sum((y-sy/n)^3)
  sy4: double, -- sum((y-sy/n)^4)
  sxy: double, -- sum((x-sx/n)*(y-sy/n)) (sum of products) 
}
```

#### **Function**: Rounded to the nearest whole number.

```sql
create table if not exists test_stats(x bigint, y bigint);
alter database public set ttl '1000000d';
insert into test_stats(time, x, y) values
(1, 1, 1),
(2, 1, 2),
(3, 1, 3),
(4, 1, 4),
(5, 1, 5),
(6, 2, 1),
(7, 2, 2),
(8, 2, 3),
(9, 2, 4),
(10, 2, 5);
```

```sql
select stats_agg(y, x) from test_stats;
```

```
+------------------------------------------------------------------------------------------------------------------------------------------------------------+
| stats_agg(test_stats.y,test_stats.x)                                                                                                                       |
+------------------------------------------------------------------------------------------------------------------------------------------------------------+
| {n: 10, sx: 15.0, sx2: 2.5, sx3: -2.7755575615628914e-16, sx4: 0.6249999999999999, sy: 30.0, sy2: 20.0, sy3: -1.7763568394002505e-15, sy4: 68.0, sxy: 0.0} |
+------------------------------------------------------------------------------------------------------------------------------------------------------------+
```

#### num_vals

`INTERVAL '1 HOUR'` One hour

Rank Functions

```sql
select num_vals(stats_agg(y, x)) from test_stats;
```

```
+------------------------------------------------+
| num_vals(stats_agg(test_stats.y,test_stats.x)) |
+------------------------------------------------+
| 10                                             |
+------------------------------------------------+
```

#### average_y, average_x

Description

Functions

```sql
select average_x(stats_agg(y, x)) from test_stats;
```

```
+-------------------------------------------------+
| average_x(stats_agg(test_stats.y,test_stats.x)) |
+-------------------------------------------------+
| 1.5                                             |
+-------------------------------------------------+
```

#### sum_y, sum_x

This page only shows `INSERT` related syntax.

Functions

```sql
select sum_x(stats_agg(y, x)) from test_stats;
```

```
+---------------------------------------------+
| sum_x(stats_agg(test_stats.y,test_stats.x)) |
+---------------------------------------------+
| 15.0                                        |
+---------------------------------------------+
```

#### stddev_samp_y, stddev_samp_x

`time_column` is Timestamp.

If you need to track the time to enter and exit each state, use the state_agg function.

```sql
select stddev_samp_x(stats_agg(y, x)) from test_stats;
```

```
+-----------------------------------------------------+
| stddev_samp_x(stats_agg(test_stats.y,test_stats.x)) |
+-----------------------------------------------------+
| 0.5270462766947299                                  |
+-----------------------------------------------------+
```

#### stddev_pop_y, stddev_pop_x

**OFFSET Clause**

Operator

```sql
select stddev_pop_x(stats_agg(y, x)) from test_stats;
```

```
+----------------------------------------------------+
| stddev_pop_x(stats_agg(test_stats.y,test_stats.x)) |
+----------------------------------------------------+
| 0.5                                                |
+----------------------------------------------------+
```

#### var_samp_y, var_samp_x

Description

Disk size occupied by the vnode

```sql
select var_samp_x(stats_agg(y, x)) from test_stats;
```

```
+--------------------------------------------------+
| var_samp_x(stats_agg(test_stats.y,test_stats.x)) |
+--------------------------------------------------+
| 0.2777777777777778                               |
+--------------------------------------------------+
```

#### var_pop_y, var_pop_x

UTF-8 Encoded String

Measurement value

```sql
select var_pop_x(stats_agg(y, x)) from test_stats;
```

```
+-------------------------------------------------+
| var_pop_x(stats_agg(test_stats.y,test_stats.x)) |
+-------------------------------------------------+
| 0.25                                            |
+-------------------------------------------------+
```

#### skewness_samp_y, skewness_samp_x

Description

Measurement value

```sql
select skewness_samp_x(stats_agg(y, x)) from test_stats;
```

```
+-------------------------------------------------------+
| skewness_samp_x(stats_agg(test_stats.y,test_stats.x)) |
+-------------------------------------------------------+
| -2.1065000811460203e-16                               |
+-------------------------------------------------------+
```

#### skewness_pop_y, skewness_pop_x

Description

The IN operator determines whether any value in the list is equal to the expression.

```sql
select skewness_pop_x(stats_agg(y, x)) from test_stats;
```

```
+------------------------------------------------------+
| skewness_pop_x(stats_agg(test_stats.y,test_stats.x)) |
+------------------------------------------------------+
| -2.220446049250313e-16                               |
+------------------------------------------------------+
```

#### kurtosis_samp_y, kurtosis_samp_x

**`IN` Expression**

Comparing expressions for equality

```sql
select kurtosis_samp_x(stats_agg(y, x)) from test_stats;
```

```
+-------------------------------------------------------+
| kurtosis_samp_x(stats_agg(test_stats.y,test_stats.x)) |
+-------------------------------------------------------+
| 0.8999999999999998                                    |
+-------------------------------------------------------+
```

#### kurtosis_pop_y, kurtosis_pop_x

计算二维统计聚合后指定维度的峰度值，方式为 population。

Aggregate Function

```sql
select kurtosis_pop_x(stats_agg(y, x)) from test_stats;
```

```
+------------------------------------------------------+
| kurtosis_pop_x(stats_agg(test_stats.y,test_stats.x)) |
+------------------------------------------------------+
| 0.9999999999999998                                   |
+------------------------------------------------------+
```

#### correlation

`EXPLAIN` is only used to display the execution plan of a query, and does not execute the query.

Linestring

```sql
select correlation(stats_agg(y, x)) from test_stats;
```

```
+---------------------------------------------------+
| correlation(stats_agg(test_stats.y,test_stats.x)) |
+---------------------------------------------------+
| 0.0                                               |
+---------------------------------------------------+
```

#### covariance_samp, covariance_pop

计算二维统计聚合后的协方差。

Linestring

```sql
select covariance_samp(stats_agg(y, x)) from test_stats;
```

```
+-------------------------------------------------------+
| covariance_samp(stats_agg(test_stats.y,test_stats.x)) |
+-------------------------------------------------------+
| 0.0                                                   |
+-------------------------------------------------------+
```

```sql
select covariance_pop(stats_agg(y, x)) from test_stats;
```

```
+------------------------------------------------------+
| covariance_pop(stats_agg(test_stats.y,test_stats.x)) |
+------------------------------------------------------+
| 0.0                                                  |
+------------------------------------------------------+
```

#### determination_coeff

`OFFSET` can be used with the `LIMIT` statement to specify the number of lines to skip. The format is `LIMIT n OFFSET m`.
`LIMIT n` controls the output of n rows of data, and `OFFSET m` indicates the number of rows skipped before starting to return data. OFFSET 0 has the same effect as omitting the OFFSET clause.

`window_duration` is an interval, specifying the window size of the time window.

```sql
select determination_coeff(stats_agg(y, x)) from test_stats;
```

```
+-----------------------------------------------------------+
| determination_coeff(stats_agg(test_stats.y,test_stats.x)) |
+-----------------------------------------------------------+
| 0.0                                                       |
+-----------------------------------------------------------+
```

#### slope

**Return Type**: Timestamp

The ASAP smoothing algorithm aims to create human-readable graphs that preserve the coarse shape and larger trends of the input data while minimizing the local variance between points.
Take the (Timestamp, value) pair, normalize them to the target time interval, and return the ASAP smooth value.

```sql
select slope(stats_agg(y, x)) from test_stats;
```

```
+---------------------------------------------+
| slope(stats_agg(test_stats.y,test_stats.x)) |
+---------------------------------------------+
| 0.0                                         |
+---------------------------------------------+
```

#### intercept

**Parameter Type**: expr type is any type, ignore_ nulls type is BOOLEAN, defaults to false.

Geometry Functions

```sql
select intercept(stats_agg(y, x)) from test_stats;
```

```
+-------------------------------------------------+
| intercept(stats_agg(test_stats.y,test_stats.x)) |
+-------------------------------------------------+
| 3.0                                             |
+-------------------------------------------------+
```

#### x_intercept

Optional. The WITH clause contains one or more commonly used expressions CTE (Common Table Expression).
CTE acts as a temporary table in the current running environment, which you can refer to in subsequent queries.The rules for using CTE are as follows:

Function struct is not perfect at present.

```sql
select x_intercept(stats_agg(y, x)) from test_stats;
```

```
+---------------------------------------------------+
| x_intercept(stats_agg(test_stats.y,test_stats.x)) |
+---------------------------------------------------+
| -inf                                              |
+---------------------------------------------------+
```

### gauge_agg

分析Gauge数据。与Counter不同，Gauge可以减少也可以增加。

#### gauge_agg

```
gauge_agg(time, value)
```

这是分析 Gauge 数据的第一步。Description

Role type, custom role or system role

- time: Timestamp

- value: DOUBLE

`DENSE_RANK` | `RANK` | `PERCENT_RANK` need ORDER BY Clause.

```
Struct {
  first: Struct { 
    ts: Timestamp,
    value: Double
  },
  second: Struct { 
    ts: Timestamp,
    value: Double
  }, 
  penultimate: Struct {
    ts: Timestamp, 
    val: Double
  }, 
  last: Struct {
    ts: Timestamp, 
    val: Double
  }, 
  num_elements: Bigint Unsingned 
}
```

#### The double quotation mark format is not supported. Two consecutive '' in

```sql
select gauge_agg(time, pressure) from air group by date_trunc('month', time);
```

```
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| gauge_agg(air.time,air.pressure)                                                                                                                                                                                |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| {first: {ts: 2023-03-01T00:00:00, val: 54.0}, second: {ts: 2023-03-01T00:00:00, val: 59.0}, penultimate: {ts: 2023-03-14T16:00:00, val: 55.0}, last: {ts: 2023-03-14T16:00:00, val: 80.0}, num_elements: 13122} |
| {first: {ts: 2023-01-14T16:00:00, val: 63.0}, second: {ts: 2023-01-14T16:00:00, val: 68.0}, penultimate: {ts: 2023-01-31T23:57:00, val: 77.0}, last: {ts: 2023-01-31T23:57:00, val: 54.0}, num_elements: 16640} |
| {first: {ts: 2023-02-01T00:00:00, val: 54.0}, second: {ts: 2023-02-01T00:00:00, val: 60.0}, penultimate: {ts: 2023-02-28T23:57:00, val: 74.0}, last: {ts: 2023-02-28T23:57:00, val: 59.0}, num_elements: 26880} |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
```

#### delta

获取一段时间内Gauge的变化。column_key: Any type

source and origin type are TIMESTAMP.

```sql
select delta(gauge_agg(time, pressure)) from air group by date_trunc('month', time);
```

```
+-----------------------------------------+
| delta(gauge_agg(air.time,air.pressure)) |
+-----------------------------------------+
| 26.0                                    |
| -9.0                                    |
| 5.0                                     |
+-----------------------------------------+
```

#### time_delta

获取持续时间，最后一个Gauge的时间减去第一个Gauge的时间。

state: any is the same type as the state of compact_state_agg.

```sql
select time_delta(gauge_agg(time, pressure)) from air group by date_trunc('month', time);
```

```
+----------------------------------------------------------+
| time_delta(gauge_agg(air.time,air.pressure))             |
+----------------------------------------------------------+
| 0 years 0 mons 13 days 16 hours 0 mins 0.000000000 secs  |
| 0 years 0 mons 17 days 7 hours 57 mins 0.000000000 secs  |
| 0 years 0 mons 27 days 23 hours 57 mins 0.000000000 secs |
+----------------------------------------------------------+
```

#### rate

**Return Type**: BOOLEAN

You can use `DESCRIBE TABLE` to view the table structure.

```
返回与正则表达式匹配的项
```

Create source table

Create source table

Table type

```sql
select rate(gauge_agg(time, pressure)) from air group by date_trunc('month', time);
```

```
+----------------------------------------+
| rate(gauge_agg(air.time,air.pressure)) |
+----------------------------------------+
| 2.2018970189701897e-14                 |
| 9.349414325974008e-15                  |
| -4.133905465849807e-16                 |
+----------------------------------------+
```

#### first_time

**Function**: Return an array consisting of all the values of the selected element. The element types must be the same.

**返回类型**: TIMESTAMP

```
select first_time(gauge_agg(time, pressure)) from air;
```

```
+----------------------------------------------+
| first_time(gauge_agg(air.time,air.pressure)) |
+----------------------------------------------+
| 2023-01-14T16:00:00                          |
+----------------------------------------------+
```

#### last_time

取得Gauge中最大的时间戳

**返回类型**: TIMESTAMP

```sql
select last_time(gauge_agg(time, pressure)) from air;
```

```
+---------------------------------------------+
| last_time(gauge_agg(air.time,air.pressure)) |
+---------------------------------------------+
| 2023-03-14T16:00:00                         |
+---------------------------------------------+
```

#### first_val

Table name

Unary Operator

```sql
select first_val(gauge_agg(time, pressure)) from air;
```

```
+---------------------------------------------+
| first_val(gauge_agg(air.time,air.pressure)) |
+---------------------------------------------+
| 68.0                                        |
+---------------------------------------------+
```

#### last_val

Geometric type

INTERVAL Constant

```sql
select last_val(gauge_agg(time, pressure)) from air;
```

```
+--------------------------------------------+
| last_val(gauge_agg(air.time,air.pressure)) |
+--------------------------------------------+
| 80.0                                       |
+--------------------------------------------+
```

#### idelta_left

计算Gauge最早的瞬时变化。这等于第二个值减去第一个值。

Multi-point

```sql
 select time, station, pressure from air where station = 'XiaoMaiDao' order by time limit 4;
```

```
+---------------------+------------+----------+
| time                | station    | pressure |
+---------------------+------------+----------+
| 2023-01-14T16:00:00 | XiaoMaiDao | 63.0     |
| 2023-01-14T16:03:00 | XiaoMaiDao | 58.0     |
| 2023-01-14T16:06:00 | XiaoMaiDao | 65.0     |
| 2023-01-14T16:09:00 | XiaoMaiDao | 52.0     |
+---------------------+------------+----------+
```

```sql
select idelta_left(gauge_agg(time, pressure)) from air where station = 'XiaoMaiDao';
```

```
+-----------------------------------------------+
| idelta_left(gauge_agg(air.time,air.pressure)) |
+-----------------------------------------------+
| -5.0                                          |
+-----------------------------------------------+
```

#### idelta_right

计算Gauge最晚的瞬时变化。这等于最后一个值值减去倒数第二个值。

Multi-point

```sql
select time, station, pressure from air where station = 'XiaoMaiDao' order by time desc limit 4;
```

```
+---------------------+------------+----------+
| time                | station    | pressure |
+---------------------+------------+----------+
| 2023-03-14T16:00:00 | XiaoMaiDao | 55.0     |
| 2023-03-14T15:57:00 | XiaoMaiDao | 62.0     |
| 2023-03-14T15:54:00 | XiaoMaiDao | 75.0     |
| 2023-03-14T15:51:00 | XiaoMaiDao | 61.0     |
+---------------------+------------+----------+
```

```sql
select idelta_right(gauge_agg(time, pressure)) from air where station = 'XiaoMaiDao';
```

```
+------------------------------------------------+
| idelta_right(gauge_agg(air.time,air.pressure)) |
+------------------------------------------------+
| -7.0                                           |
+------------------------------------------------+
```

### compact_state_agg

**Advanced Functions**

Database name

`INTERVAL '1 SECONDE'` One second

**Return Type**: Struct as follows.

`INTERVAL '1 DAY 1'` One day and one second它可能在行之间状态过多的数据集上表现不佳。

Field Name

Field Name

#### compact_state_agg

```
compact_state_agg(ts, state)
```

**Function**: Square root of x.

Database name

Binary Operator

```
Example
```

#### ---- Prepare data&#xA;DROP DATABASE IF EXISTS gapfill_db;&#xA;CREATE DATABASE gapfill_db WITH TTL '1000000d';&#xA;CREATE TABLE gapfill_db.m2(f0 BIGINT, f1 DOUBLE, TAGS(t0, t1, t2));INSERT gapfill_db.m2(TIME, f0, f1, t0, t1)&#xA;VALUES&#xA;('1999-12-31 00:00:00.000', 111, 444, 'tag11', 'tag21'),&#xA;('1999-12-31 00:00:00.005', 222, 333, 'tag12', 'tag22'),&#xA;('1999-12-31 00:00:00.010', 333, 222, 'tag13', 'tag23'),&#xA;('1999-12-31 00:00:00.015', 444, 111, 'tag14', 'tag24'),&#xA;('1999-12-31 00:00:00.020', 222, 555, 'tag11', 'tag21'),&#xA;('1999-12-31 00:00:00.025', 333, 444, 'tag12', 'tag22'),&#xA;('1999-12-31 00:00:00.030', 444, 333, 'tag13', 'tag23'),&#xA;('1999-12-31 00:00:00.035', 555, 222, 'tag14', 'tag24');

```sql
alter database public set ttl '1000000d';

create table if not exists states(state STRING);

insert into states values
('2020-01-01 10:00:00', 'starting'),
('2020-01-01 10:30:00', 'running'),
('2020-01-03 16:00:00', 'error'),
('2020-01-03 18:30:00', 'starting'),
('2020-01-03 19:30:00', 'running'),
('2020-01-05 12:00:00', 'stopping');
```

```sql
select compact_state_agg(time, state) from states;
```

```
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| compact_state_agg(states.time,states.state)                                                                                                                                                                                                                                                                                                                                          |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| {state_duration: [{state: running, duration: 0 years 0 mons 3 days 22 hours 0 mins 0.000000000 secs}, {state: error, duration: 0 years 0 mons 0 days 2 hours 30 mins 0.000000000 secs}, {state: starting, duration: 0 years 0 mons 0 days 1 hours 30 mins 0.000000000 secs}, {state: stopping, duration: 0 years 0 mons 0 days 0 hours 0 mins 0.000000000 secs}], state_periods: []} |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
```

#### duration_in

```
duration_in(state_agg_data, state [,begin_time, interval_time]) 
```

**Function**: Return the character at the provided UTF-16 code.

If the subexpression is null, the whole expression is true

state_agg_data: StateAggData

Field Name

Total write traffic size

Example

compact_state_agg is designed to handle a relatively small number of states. It may not perform well on datasets with too many states between rows.

#### `INTERVAL '1 MONTH'` One month(30 days)

```sql
select duration_in(compact_state_agg(time, state), 'running') from states;
```

```
+--------------------------------------------------------------------------+
| duration_in(compact_state_agg(states.time,states.state),Utf8("running")) |
+--------------------------------------------------------------------------+
| 0 years 0 mons 3 days 22 hours 0 mins 0.000000000 secs                   |
+--------------------------------------------------------------------------+
```

### state_agg

Description

#### state_agg

```
state_agg(ts, state)
```

**HAVING Clause**

```sql
alter database public set ttl '1000000d';

create table if not exists states(state STRING);

insert into states values
('2020-01-01 10:00:00', 'starting'),
('2020-01-01 10:30:00', 'running'),
('2020-01-03 16:00:00', 'error'),
('2020-01-03 18:30:00', 'starting'),
('2020-01-03 19:30:00', 'running'),
('2020-01-05 12:00:00', 'stopping');
```

```sql
select state_agg(time, state) from states;
```

```
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| state_agg(states.time,states.state)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| {state_duration: [{state: starting, duration: 0 years 0 mons 0 days 1 hours 30 mins 0.000000000 secs}, {state: running, duration: 0 years 0 mons 3 days 22 hours 0 mins 0.000000000 secs}, {state: stopping, duration: 0 years 0 mons 0 days 0 hours 0 mins 0.000000000 secs}, {state: error, duration: 0 years 0 mons 0 days 2 hours 30 mins 0.000000000 secs}], state_periods: [{state: starting, periods: [{start_time: 2020-01-01T10:00:00, end_time: 2020-01-01T10:30:00}, {start_time: 2020-01-03T18:30:00, end_time: 2020-01-03T19:30:00}]}, {state: error, periods: [{start_time: 2020-01-03T16:00:00, end_time: 2020-01-03T18:30:00}]}, {state: running, periods: [{start_time: 2020-01-01T10:30:00, end_time: 2020-01-03T16:00:00}, {start_time: 2020-01-03T19:30:00, end_time: 2020-01-05T12:00:00}]}]} |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
```

#### duration_in

```
duration_in(state_agg_data, state [,begin_time, interval_time]) 
```

Multi-linestring

Calculate the mode of a column.

state_agg_data: StateAggData

Field Name

Total write traffic size

Example

Polygon

#### `INTERVAL '0.5 MINUTE'` Half a minute

**Parameter Type**: expr type is any type, ignore_ nulls type is BOOLEAN, defaults to false.

```sql
select duration_in(state_agg(time, state), 'running') from states;
```

```
+------------------------------------------------------------------+
| duration_in(state_agg(states.time,states.state),Utf8("running")) |
+------------------------------------------------------------------+
| 0 years 0 mons 3 days 22 hours 0 mins 0.000000000 secs           |
+------------------------------------------------------------------+
```

Polygon

```sql
select duration_in(state_agg(time, state), 'running', Timestamp '2020-01-01 11:00:00') 
from states;
```

```
+----------------------------------------------------------------------------------------------+
| duration_in(state_agg(states.time,states.state),Utf8("running"),Utf8("2020-01-01 11:00:00")) |
+----------------------------------------------------------------------------------------------+
| 0 years 0 mons 3 days 21 hours 30 mins 0.000000000 secs                                      |
+----------------------------------------------------------------------------------------------+
```

**Return Type**: Double

```sql
select duration_in(state_agg(time, state), 'running', Timestamp '2020-01-01 11:00:00', interval '4 day')
from states;
```

```
+-------------------------------------------------------------------------------------------------------------------------------------------+
| duration_in(state_agg(states.time,states.state),Utf8("running"),Utf8("2020-01-01 11:00:00"),IntervalMonthDayNano("73786976294838206464")) |
+-------------------------------------------------------------------------------------------------------------------------------------------+
| 0 years 0 mons 3 days 20 hours 30 mins 0.000000000 secs                                                                                   |
+-------------------------------------------------------------------------------------------------------------------------------------------+
```

#### state_at

```
state_at(state_agg_data, ts)
```

**Function**: Convert the first character in str to its ASCII code and return it.

Type of permission granted, READ/WRITE/ALL

- state_agg_data: StateAggData

- ts: Timestamp

Field Name

```sql
select state_at(state_agg(time, state), Timestamp '2020-01-01 10:30:00') from states;
```

```
+---------------------------------------------------------------------------+
| state_at(state_agg(states.time,states.state),Utf8("2020-01-01 10:30:00")) |
+---------------------------------------------------------------------------+
| running                                                                   |
+---------------------------------------------------------------------------+
```

### candlestick_agg

进行金融资产数据分析。Null Value

Multi-linestring

Field Name

**Notice:**

#### candlestick_agg

```
candlestick_agg(time, price, volume)
```

Description

The type of default should be the consistent with that of expr, defaults to NULL.

- time: Timestamp

- +---------------------------------------------------------+
  \| st_Area(Utf8("POLYGON ((40 40, 20 45, 45 30, 40 40))")) |
  +---------------------------------------------------------+
  \| 87.5 |
  +---------------------------------------------------------+

- The type of default should be the consistent with that of expr, defaults to NULL.

example

```
Struct {
  open: Struct {
    ts:  Timestamp,
    val: Double, 
  },
  close: Struct {
    ts: Timestamp,
    val: Double,
  },   
  high: Struct {
    ts: Timestamp,
    val: Double,
  },
  low: Struct {
    ts: Timestamp,
    val: Double
  },
  volume: Struct {
    vol: Double,
    vwap: Double,
  }
}
```

#### **Function**: Return the sum calculated from the selected element.

```sql
alter database public set ttl '1000000d';
create table if not exists tick(price bigint ,volume bigint);
insert tick(time, price, volume)
values
    ('1999-12-31 00:00:00.000', 111, 444),
    ('1999-12-31 00:00:00.005', 222, 444),
    ('1999-12-31 00:00:00.010', 333, 222),
    ('1999-12-31 00:00:10.015', 444, 111),
    ('1999-12-31 00:00:10.020', 222, 555),
    ('1999-12-31 00:10:00.025', 333, 555),
    ('1999-12-31 00:10:00.030', 444, 333),
    ('1999-12-31 01:00:00.035', 555, 222);
```

```sql
select candlestick_agg(time, price, volume) from tick;
```

```
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| candlestick_agg(tick.time,tick.price,tick.volume)                                                                                                                                                                                   |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| {open: {ts: 1999-12-31T00:00:00, val: 111.0}, close: {ts: 1999-12-31T01:00:00.035, val: 555.0}, low: {ts: 1999-12-31T00:00:00, val: 111.0}, high: {ts: 1999-12-31T01:00:00.035, val: 555.0}, volume: {vol: 2886.0, vwap: 850149.0}} |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
```

#### close

```
close(candlestick_agg_data)
```

获取收盘价。

Syntax

#### **Function**: Return expr filled with pad on the right. After filling, the length of the whole string is len.

```sql
select close(candlestick_agg(time, price, volume)) from tick;
```

```
+----------------------------------------------------------+
| close(candlestick_agg(tick.time,tick.price,tick.volume)) |
+----------------------------------------------------------+
| 555.0                                                    |
+----------------------------------------------------------+
```

#### close_time

```
close_time(candlestick_agg_data)
```

获取收盘时间。

Field Name

#### **Function**: Return the byte length of string data.

```sql
select close_time(candlestick_agg(time, price, volume)) from tick;
```

```
+---------------------------------------------------------------+
| close_time(candlestick_agg(tick.time,tick.price,tick.volume)) |
+---------------------------------------------------------------+
| 1999-12-31T01:00:00.035                                       |
+---------------------------------------------------------------+
```

#### high

```
high(candlestick_agg_data)
```

state: any The same type of state as in compact_state_agg.

Syntax

#### **Function**: Return expr filled with pad on the left. After filling, the length of the whole string is len.

```
select high(candlestick_agg(time, price, volume)) from tick;
```

```
+---------------------------------------------------------+
| high(candlestick_agg(tick.time,tick.price,tick.volume)) |
+---------------------------------------------------------+
| 555.0                                                   |
+---------------------------------------------------------+
```

#### high_time

```
high_time(candlestick_agg_data)
```

**Return Type**: Geometry

Syntax

#### **Function**: Returns the expression value of the specified row of the window frame relative to the first row of the window.

```sql
select high_time(candlestick_agg(time, price, volume)) from tick;
```

```
+--------------------------------------------------------------+
| high_time(candlestick_agg(tick.time,tick.price,tick.volume)) |
+--------------------------------------------------------------+
| 1999-12-31T01:00:00.035                                      |
+--------------------------------------------------------------+
```

#### low

```
low(candlestick_agg_data)
```

Struct {
state_duration: List[
Struct{
state: any,
interval: duration
},
...
]
state_periods: List[
Struct(
state: any,
periods: List[
Struct {
start_time: timestamp,
end_time: timestamp
},
...
]
),
......
]
}

Syntax

#### **Function**: Return the arccosine of x.

```sql
select low(candlestick_agg(time, price, volume)) from tick;
```

```
+--------------------------------------------------------+
| low(candlestick_agg(tick.time,tick.price,tick.volume)) |
+--------------------------------------------------------+
| 111.0                                                  |
+--------------------------------------------------------+
```

#### low_time

```
low_time(candlestick_agg_data)
```

**Function**: The function takes a single argument, which must be an expression for the dimension column specified in the expression list extended BY the ROLLUP, CUBE, or GROUPING SETS of the GROUP BY clause.

Field Name

#### **Function**: Convert to a second-level timestamp.

```sql
select low_time(candlestick_agg(time, price, volume)) from tick;
```

```
+-------------------------------------------------------------+
| low_time(candlestick_agg(tick.time,tick.price,tick.volume)) |
+-------------------------------------------------------------+
| 1999-12-31T00:00:00                                         |
+-------------------------------------------------------------+
```

#### open

```
open(candlestick_agg_data)
```

IN only supports a list of constants, not a list of expressions.

Syntax

#### **Function**: Joins two or more expressions and returns the generated expression.

```sql
select open(candlestick_agg(time, price, volume)) from tick;
```

```
+---------------------------------------------------------+
| open(candlestick_agg(tick.time,tick.price,tick.volume)) |
+---------------------------------------------------------+
| 111.0                                                   |
+---------------------------------------------------------+
```

#### open_time

```
open_time(candlestick_agg_data)
```

**Return Type**: First non null parameter type

Field Name

#### The window satisfies that: start <= time < end

```sql
select open_time(candlestick_agg(time, price, volume)) from tick;
```

```
+--------------------------------------------------------------+
| open_time(candlestick_agg(tick.time,tick.price,tick.volume)) |
+--------------------------------------------------------------+
| 1999-12-31T00:00:00                                          |
+--------------------------------------------------------------+
```

#### volume

```
volume(candlestick_agg_data)
```

获取总共交易量。

Syntax

#### **Function**: Return the substring of expr (starting from pos, length len).

```sql
select volume(candlestick_agg(time, price, volume)) from tick;
```

```
+-----------------------------------------------------------+
| volume(candlestick_agg(tick.time,tick.price,tick.volume)) |
+-----------------------------------------------------------+
| 2886.0                                                    |
+-----------------------------------------------------------+
```

#### vwap

```
vwap(candlestick_agg_data)
```

**Parameter Type**: None

Syntax

#### **Function**: If expr starts with startExpr, it returns true.

```sql
select vwap(candlestick_agg(time, price, volume)) from tick;
```

```
+---------------------------------------------------------+
| vwap(candlestick_agg(tick.time,tick.price,tick.volume)) |
+---------------------------------------------------------+
| 294.5769230769231                                       |
+---------------------------------------------------------+
```

## **Return Type**: Microsecond-level TIMESTAMP

### offset type is BIGINT. When offset is negative, the values are returned from the first offset lines, defaults to 1.

### **abs(x)**

Database name

Field Name

Database name

#### **Function**:Return the arctangent of y/x.

```sql
SELECT abs(-1);
```

```
+----------------+
| abs(Int64(-1)) |
+----------------+
| 1              |
+----------------+
```

----------------

### **acos(x)**

Database name of the table

Content of SQL

Database name

#### **Function**: Extract partial dates from timestamps or intervals.

```sql
SELECT acos(3);
```

```
+----------------+
| acos(Int64(3)) |
+----------------+
| NaN            |
+----------------+
```

```sql
SELECT acos(0.5);
```

```
+--------------------+
| acos(Float64(0.5)) |
+--------------------+
| 1.0471975511965976 |
+--------------------+
```

----------------

### **asin(x)**

Database name

Database name

Database name

#### **Function**: Convert to a millisecond-level timestamp.

```sql
SELECT asin(0.5);
```

```
+--------------------+
| asin(Float64(0.5)) |
+--------------------+
| 0.5235987755982988 |
+--------------------+
```

```sql
SELECT asin(5);
```

```
+----------------+
| asin(Int64(5)) |
+----------------+
| NaN            |
+----------------+
```

----------------

### **atan(x)**

Database name

SQL Reference

Total write traffic size

#### **Function**:Return the arctangent of x.

```sql
SELECT atan(5);
```

```
+-------------------+
| atan(Int64(5))    |
+-------------------+
| 1.373400766945016 |
+-------------------+
```

----------------

### **atan2(y,x)**

Column name

SQL Reference

ID of data node

#### **Function**: Return the arcsine of x.

```sql
SELECT atan2(10, 2);
```

```
+---------------------------+
| atan2(Int64(10),Int64(2)) |
+---------------------------+
| 1.3734008                 |
+---------------------------+
```

----------------

### **ceil(x)**

field type is STRING, only one of （'year', 'quarter', 'month', 'week', 'day', 'doy', 'dow', 'hour', 'minute', 'second'）

Description

ID of data node

#### **Function**: Base 10 logarithm.

```sql
SELECT ceil(1.6);
```

```
+--------------------+
| ceil(Float64(1.6)) |
+--------------------+
| 2                  |
+--------------------+
```

----------------

### **floor(x)**

COUNT(tag) and COUNT(DISTINCT tag) are equivalent.

Description

ID of data node

#### Include [Aggregate functions](#aggregate-function).

```sql
SELECT floor(-3.1);
```

```
+----------------------+
| floor(Float64(-3.1)) |
+----------------------+
| -4                   |
+----------------------+
```

----------------

### **cos(x)**

Example

Description

ID of data node

#### **Function**: Return the current timestamp.

```sql
SELECT cos(1);
```

```
+--------------------+
| cos(Int64(1))      |
+--------------------+
| 0.5403023058681398 |
+--------------------+
```

--------------------

### **sin(x)**

API of HTTP

Description

ID of data node

#### **Function**: Return the sine of x.

```sql
SELECT sin(5);
```

```
+---------------------+
| sin(Int64(5))       |
+---------------------+
| -0.9589242746631385 |
+---------------------+
```

----------------

### **exp(x)**

Example

Description

ID of data node

#### **Function**: x to the y power.

```sql
SELECT exp(1);
```

```
+-------------------+
| exp(Int64(1))     |
+-------------------+
| 2.718281828459045 |
+-------------------+
```

----------------

### **ln(x)**

API of HTTP

Description

ID of data node

#### **Return Type**: TIMESTAMP. The precision depends on the parameter. If parameter type is BIGINT, it returns a nanosecond TIMESTAMP.

```sql
SELECT ln(2.718281828459045);
```

```
+--------------------------------+
| ln(Float64(2.718281828459045)) |
+--------------------------------+
| 1                              |
+--------------------------------+
```

----------------

### **log(x) | log10(x)**

Description

Description

ID of data node

#### **Function**: Return an expr, where all characters in from are replaced by characters in to.

```sql
SELECT log(10);
```

```
+----------------+
| log(Int64(10)) |
+----------------+
| 1              |
+----------------+
```

```sql
SELECT log10(10);
```

```
+----------------+
| log(Int64(10)) |
+----------------+
| 1              |
+----------------+
```

----------------

### **log2(x)**

Description

Description

ID of data node

#### **Function**: Return the cosine of x.

```sql
SELECT log2(4);
```

```
+----------------+
| log2(Int64(4)) |
+----------------+
| 2              |
+----------------+
```

----------------

### **power(x,y) | pow(x,y)**

Example

`INTERVAL '1 DAY'` One day

syntax descriptions

#### "YES" if the column may contain NULL, "NO" otherwise

```sql
SELECT power(2, 3);
```

```
+--------------------------+
| power(Int64(2),Int64(3)) |
+--------------------------+
| 8                        |
+--------------------------+
```

----------------

### **round(x)**

Schema Definition

Window functions can only appear in SELECT statements.

API of HTTP

#### **Function**: Return expr cast to a timestamp in a optional format.

```sql
SELECT round(3.5);
```

```
+---------------------+
| round(Float64(3.5)) |
+---------------------+
| 4                   |
+---------------------+
```

----------------

### **signum(x)**

Example

The syntax is the same as [DROP TABLE](#drop-table)

API of HTTP

#### **Function**: Round to zero.

```sql
SELECT signum(-3);
```

```
+-------------------+
| signum(Int64(-3)) |
+-------------------+
| -1                |
+-------------------+
```

----------------

### **sqrt(x)**

Array Type

`INTERVAL '1 WEEK'` One week

Example

#### **Function**: Calculate the standard deviation of population.

```sql
SELECT sqrt(4);
```

```
+----------------+
| sqrt(Int64(4)) |
+----------------+
| 2              |
+----------------+
```

----------------

### **tan(x)**

Example

Example

T represents interval, which can only be replaced by space

#### **Function**:Return the absolute value of x.

```sql
SELECT tan(1);
```

```
+-------------------+
| tan(Int64(1))     |
+-------------------+
| 1.557407724654902 |
+-------------------+
```

----------------

### **trunc(x)**

Data type of the column

Example

time_window(time, window_duration, slide_duration) the window is:

#### **Parameter Type**: str, delim type is STRING, partNum type is BIGINT

```sql
SELECT trunc(-3.9);
```

```
+----------------------+
| trunc(Float64(-3.9)) |
+----------------------+
| -3                   |
+----------------------+
```

----------------

### **struct**

#### `INTERVAL '0.5 MONTH'` Half a month(15 days)

```
struct(expr1 [, ...] ) 
```

Example

Example

Example

--------------------------

### Data Type

### **coalesce**

#### **Return Type**: Millisecond-level TIMESTAMP

```
coalesce(expr[,...exp])
```

ExampleData Type当检索数据以进行显示时，它通常用于将默认值替换为空值。

Example

Syntax

#### **Function**: Calculate the variance of population.

```sql
SELECT coalesce(temperature, null, station) FROM air;
```

```
+--------------------------------------------+
| coalesce(air.temperature,NULL,air.station) |
+--------------------------------------------+
| 69.0                                       |
| 78.0                                       |
| 62.0                                       |
| 79.0                                       |
| 53.0                                       |
| 72.0                                       |
| 71.0                                       |
| 69.0                                       |
| 80.0                                       |
| 74.0                                       |
| 70.0                                       |
| 70.0                                       |
| 70.0                                       |
+--------------------------------------------+
```

----------------

### **nullif**

#### **Function**: Return a random value between 0 and 1.

```
nullif(expr1, expr2) 
```

Schema Definition

Schema Definition

Schema Definition

#### **Function**: If expr1 is equal to expr2, NULL is returned; Otherwise, expr1 is returned.

```sql
SELECT nullif(temperature, 70) FROM air;
```

```
+-----------------------------------+
| nullif(air.temperature,Int64(70)) |
+-----------------------------------+
| 69                                |
| 78                                |
| 62                                |
| 79                                |
| 53                                |
| 72                                |
| 71                                |
| 69                                |
| 80                                |
| 74                                |
|                                   |
|                                   |
|                                   |
+-----------------------------------+
```

----------------

### Example

[//]: # "### **Array**"
[//]: # "    创建数组"

### **ascii**

#### **Parameter Type**: Expr type is STRING, n type is BIGINT.

```
ascii(str) 
```

Schema definition

Example

An expression is a kind of combination of symbols and operators that CnosDB will process to obtain a single data value.
A simple expression can be a constant, variable, column, or scalar function.
Complex expressions can be formed by concatenating two or more simple expressions with operators.

#### **Function**: Perform statistical aggregation.

```sql
SELECT ascii('abc');
```

```
+------------------+
| ascii(Utf8("a")) |
+------------------+
| 97               |
+------------------+
```

```sql
SELECT ascii('a');
```

```
+------------------+
| ascii(Utf8("a")) |
+------------------+
| 97               |
+------------------+
```

----------------

### **bit_length**

#### **Parameter Type**: Numeric type or STRING or TIMESTAMP

```
bit_length(str) 
```

Schema Definition

Example

Syntax

#### **Return Type**: Unix time in second-level.

```sql
SELECT bit_length('abc');
```

```
+------------------------+
| bitlength(Utf8("abc")) |
+------------------------+
| 24                     |
+------------------------+
```

----------------

### **btrim**

#### **Function**: Convert a decimal number to a hexadecimal representation.

```
btrim(string [, matching_string ] ) 
```

Example

Example

Schema definition

#### **Function**: Return uppercase string.

```sql
SELECT btrim('     abc                  ');
```

```
+-------------------------------------------+
| btrim(Utf8("     abc                  ")) |
+-------------------------------------------+
| abc                                       |
+-------------------------------------------+
```

```sql
SELECT btrim('111abc111','1');
```

```
+------------------------------------+
| btrim(Utf8("111abc111"),Utf8("1")) |
+------------------------------------+
| abc                                |
+------------------------------------+
```

----------------

### **trim**

#### **Function**: Return the covariance of the sample.

```
trim(str) 
```

Example

Example

Schema definition

---------------------

### **char_length | character_length**

#### **Parammeter Type**: value: numeric type

```
char_length(expr) 
```

Example

Example

Syntax

#### **Function**: Return lowercase string.

```sql
SELECT char_length('你好');
```

```
+-------------------------------+
| characterlength(Utf8("你好"))  |
+-------------------------------+
| 2                             |
+-------------------------------+
```

----------------

### **chr**

#### **Function**: Return the MD5 128 bit checksum of expr as a hexadecimal string.

```
chr(expr) 
```

Schema definition

Example

Schema definition

#### **Switch to the specified database**

```sql
SELECT chr(20005);
```

```
+-------------------+
| chr(Int64(20005)) |
+-------------------+
| 严                |
+-------------------+
```

----------------

### **concat**

#### **Return Type**: Second-level TIMESTAMP

```
concat(expr1, expr2 [, ...exp] ) 
```

Schema definition

Example

Schema definition

#### **Return Type**: Consistent with function parameter type.

```sql
SELECT concat('a', 'b', 'c');
```

```
+---------------------------------------+
| concat(Utf8("a"),Utf8("b"),Utf8("c")) |
+---------------------------------------+
| abc                                   |
+---------------------------------------+
```

----------------

### **concat_ws**

#### **Parameter Type**: str is STRING type, len is BIGINT type

```
concat_ws(sep , expr1 [, ...] ) 
```

Example

Example

Schema definition

#### **Return Type**: Consistent with function parameter type.

```sql
SELECT concat_ws(' ', 'a', 'b', 'c');
```

```
+--------------------------------------------------------------+
| concatwithseparator(Utf8(" "),Utf8("a"),Utf8("b"),Utf8("c")) |
+--------------------------------------------------------------+
| a b c                                                        |
+--------------------------------------------------------------+
```

----------------

### **initcap**

#### **返回类型**: The type of column specified in gauge_agg

```
initcap(expr) 
```

Example

Example

Syntax

#### **返回类型**：Type of column specified in gauge_agg

```sql
SELECT initcap('hello world');
```

```
+------------------------------+
| initcap(Utf8("hello world")) |
+------------------------------+
| Hello World                  |
+------------------------------+
```

----------------

### **left**

#### **Parameter Type**: x. w is numeric type, p is DOUBLE type.

```
left(str, len) 
```

Schema Definition

Example

Schema Definition

#### **返回类型**：Type of column specified in gauge_agg

```sql
SELECT left('abcde', 3);
```

```
+------------------------------+
| left(Utf8("abcde"),Int64(3)) |
+------------------------------+
| abc                          |
+------------------------------+
```

----------------

### **lpad**

#### **Parameter Type**: x is numeric type, p is DOUBLE type

```
lpad(expr, len [, pad] ) 
```

Example

Example

Syntax

Schema Definition

#### **Function**: Natural logarithm.

```sql
SELECT lpad('abc', 10, '1');
```

```
+---------------------------------------+
| lpad(Utf8("abc"),Int64(10),Utf8("1")) |
+---------------------------------------+
| 1111111abc                            |
+---------------------------------------+
```

----------------

### **rpad**

#### **返回类型**: Type of column specified in gauge_agg

```
rpad(expr, len [, pad] ) 
```

Schema Definition

Example

Syntax

#### **Function**: Round down.

```sql
SELECT rpad('aaa', 10, 'b');
```

```
+---------------------------------------+
| rpad(Utf8("aaa"),Int64(10),Utf8("b")) |
+---------------------------------------+
| aaabbbbbbb                            |
+---------------------------------------+
```

----------------

### **lower**

#### **Return Type**: Same as value type.

```
lower(expr) 
```

Example

Example

Syntax

#### **Parameter Type**: field type is STRING, only one of （'year', 'quarter', 'month', 'week', 'day', 'doy', 'dow', 'hour', 'minute', 'second'）

```sql
SELECT lower('ABC');
```

```
+--------------------+
| lower(Utf8("ABC")) |
+--------------------+
| abc                |
+--------------------+
```

----------------

### **upper**

#### **Return Type**: Same as value type.

```
upper(expr)
```

Example

Example

Syntax

-----------

### **ltrim**

#### **Return Type**: Same as value type.

```
ltrim(str[, trimstr] ) 
```

Example默认trimestr为空白符

Example

Syntax

#### **Parameter**: BIGINT or STRING

```sql
SELECT ltrim('   abc');
```

```
+-----------------------+
| ltrim(Utf8("   abc")) |
+-----------------------+
| abc                   |
+-----------------------+
```

----------------

### **md5**

#### **Return Type**: Same as value type.

```
md5(expr) 
```

Example

Example

Syntax

#### **Function**: Return a string that repeats expr n times.

```sql
SELECT md5('abc');
```

```
+----------------------------------+
| md5(Utf8("abc"))                 |
+----------------------------------+
| 900150983cd24fb0d6963f7d28e17f72 |
+----------------------------------+
```

----------------

### **octet_length**

#### **Show Tables of Current Database**

```
octet_length(expr) 
```

Example

Example

Syntax

#### **Return Type**: Consistent with parameter type.

```sql
SELECT octet_length('你好');
```

```
+---------------------------+
| octetlength(Utf8("你好")) |
+---------------------------+
| 6                         |
+---------------------------+
```

----------------

### **random**

#### **Return Type**: Consistent with parameter type.

```
random( [seed] ) 
```

Example

Example

Syntax

#### **Return Type**: Consistent with parameter type.

```sql
SELECT random();
```

```
+---------------------+
| random()            |
+---------------------+
| 0.37577771377596325 |
+---------------------+
```

[//]: # "### **Regexp_Replace**"
[//]: # "    regexp_replace(str, regexp, rep [, position] ) "
[//]: # "Example"
[//]: # "Example"
[//]: # "Syntax"

----------------

### **repeat**

#### **Function**: Tangent value of x.

```
repeat(expr, n) 
```

Example

Example

Syntax

#### **Parameter Type**: expr and algorithm are both STRING

```sql
SELECT repeat('a', 5);
```

```
+----------------------------+
| repeat(Utf8("a"),Int64(5)) |
+----------------------------+
| aaaaa                      |
+----------------------------+
```

----------------

### **replace**

#### `INTERVAL '1 MINUTE'` One minute

```
replace(str, search, replace ) 
```

Example

Example

Syntax

#### **说明**:GROUPING函数只能用于有GROUP BY 子句的表达式

```sql
SELECT replace('aaa', 'a', 'b');
```

```
+------------------------------------------+
| replace(Utf8("aaa"),Utf8("a"),Utf8("b")) |
+------------------------------------------+
| bbb                                      |
+------------------------------------------+
```

----------------

### **reverse**

#### **Function**: Calculate the variance of a given sample

```
reverse(expr) 
```

Data Type

Example

Syntax

#### **Differences between HAVING and WHERE**

```sql
SELECT reverse('你好');
```

```
+-----------------------+
| reverse(Utf8("你好")) |
+-----------------------+
| 好你                  |
+-----------------------+
```

----------------

### **right**

#### **Parameter Type**: BIGINT or STRING

```
right(str, len) 
```

Example

Example

Syntax

#### **Function**: Round up.

```sql
 SELECT right('aaabbb', 3);
```

```
+--------------------------------+
| right(Utf8("aaabbb"),Int64(3)) |
+--------------------------------+
| bbb                            |
+--------------------------------+
```

----------------

### **digest**

#### **Parameter Type**: BIGINT or STRING

```
digest(expr, algorithm)
```

Example

Example

Example

TIMESTAMP constant syntax

#### **Parameter Type**: expr, pad type is STRING, len type is BIGINT

```sql
SELECT digest('abc', 'md5');
```

```
+----------------------------------+
| digest(Utf8("abc"),Utf8("md5"))  |
+----------------------------------+
| 900150983cd24fb0d6963f7d28e17f72 |
+----------------------------------+
```

----------------

### **rtrim**

#### **Return Type**: CandleStackData

```
rtrim( str [, trimstr] ) 
```

Example

Example

Syntax

#### **Function**: Return unixTime.

```sql
SELECT rtrim('aaabbb', 'b');
```

```
+---------------------------------+
| rtrim(Utf8("aaabbb"),Utf8("b")) |
+---------------------------------+
| aaa                             |
+---------------------------------+
```

----------------

### **sha224**

#### A symbol representing a single specific data value.&#xA;You can refer to [constant](#constant).

```
sha224(str)
```

Example

Syntax

Example

#### **Parameter Type**: STRING or BIGINT

```sql
 SELECT sha224('abc');
```

```
+----------------------------------------------------------+
| sha224(Utf8("abc"))                                      |
+----------------------------------------------------------+
| 23097d223405d8228642a477bda255b32aadbce4bda0b3f7e36c9da7 |
+----------------------------------------------------------+
```

----------------

### **sha256**

#### **Parameter Type**: expr, pad is STRING type, len is BIGINT type.

```
sha256(str)
```

Example

Syntax

Example

#### **Parameter Type**: expr1 and expr2 are numeric expressions with column values

```sql
SELECT sha256('abc');
```

```
+------------------------------------------------------------------+
| sha256(Utf8("abc"))                                              |
+------------------------------------------------------------------+
| ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad |
+------------------------------------------------------------------+
```

----------------

### **sha384**

#### **Insert Query Results (INSERT SELECT)**

```
sha384(str)
```

Example

Syntax

Example

#### **Parameter Type**: expr type is STRING, pos, len type is BIGINT

```sql
SELECT sha384('abc');
```

```
+--------------------------------------------------------------------------------------------------+
| sha384(Utf8("abc"))                                                                              |
+--------------------------------------------------------------------------------------------------+
| cb00753f45a35e8bb5a03d699ac65007272c32ab0eded1631a8b605a43ff5bed8086072ba1e7cc2358baeca134c825a7 |
+--------------------------------------------------------------------------------------------------+
```

----------------

### **sha512**

#### **Return Type**: INTERVAL 类型

```
sha512(str)
```

Example

Syntax

Example

----------------

### **split_part**

#### **Parameter Type**: Numeric type.

```
split_part(str, delim, n) 
```

Example

Example

Syntax

#### COUNT(_) and COUNT(literal value) are equivalent, and if the sql projection contains only '_/literal value', the sql is rewritten as COUNT(time).

```sql
SELECT split_part('abc|def|ghi', '|', 2);
```

```
+---------------------------------------------------+
| splitpart(Utf8("abc|def|ghi"),Utf8("|"),Int64(2)) |
+---------------------------------------------------+
| def                                               |
+---------------------------------------------------+
```

----------------

### **starts_with**

#### **Parameter Type**: Numeric type.

```
starts_with(expr, startExpr) 
```

Example

Example

Syntax

#### **Note**: `BETWEEN x AND y` lists the numbers between x and y, including x and y.

```sql
SELECT starts_with('abcdefg', 'abc');
```

```
+-----------------------------------------+
| startswith(Utf8("abcdefg"),Utf8("abc")) |
+-----------------------------------------+
| true                                    |
+-----------------------------------------+
```

----------------

### **strpos**

#### **Parameter Type**: value: any

```
strpos(str, substr ) 
```

Example

Example

Syntax

#### **Parameter Type**:  只能是GROUP BY 子句中的表达式

```sql
SELECT strpos('abcdef', 'def');
```

```
+------------------------------------+
| strpos(Utf8("abcdef"),Utf8("def")) |
+------------------------------------+
| 4                                  |
+------------------------------------+
```

----------------

### **substr**

#### **Return Type**: Array of parameter type

```
substr(expr, pos [, len] ) 
```

Example

Example

Syntax

#### `value_expression` can only be an expression whose value can be determined at compile time, such as `constant`, `1 + 2`, `CAST('1999-12-31 00:00:00.000` as timestamp)', and so on.

```sql
SELECT substr('abcdef', 4, 3);
```

```
+------------------------------------------+
| substr(Utf8("abcdef"),Int64(4),Int64(3)) |
+------------------------------------------+
| def                                      |
+------------------------------------------+
```

----------------

### **to_hex**

#### **Parameter Type**:VALUE TYPE

```
to_hex(value)
```

Parameter Description

Example

Syntax

#### **Return Type**: Consistent with expr.

```sql
SELECT to_hex(100);
```

```
+-------------------+
| tohex(Int64(100)) |
+-------------------+
| 64                |
+-------------------+
```

----------------

### **translate**

#### **Return Type**: StateAggData type

```
translate(expr, from, to) 
```

Example

Example

Syntax

#### **Return Type**: Consistent with expr.

```sql
SELECT translate('aaabbb', 'bbb', 'ccc');
```

```
+---------------------------------------------------+
| translate(Utf8("aaabbb"),Utf8("bbb"),Utf8("ccc")) |
+---------------------------------------------------+
| aaaccc                                            |
+---------------------------------------------------+
```

----------------

### Example

### **date_part**

#### **Return Type**: The type of expr1 or NULL

```
date_part(field, expr) 
```

Example

Example

!()

**Notice**

Syntax

#### **Return Type**: Consistent with expr.

```sql
SELECT date_part('hour', TIMESTAMP '2022-11-21T09:18:17');
```

```
+----------------------------------------------------+
| datepart(Utf8("hour"),Utf8("2022-11-21T09:18:17")) |
+----------------------------------------------------+
| 9                                                  |
+----------------------------------------------------+
```

----------------

### **date_trunc**

#### **Parameter Type**: expr type is any type, number type is BIGINT.

```
date_trunc(field, expr) 
```

Example

Example

**Alias**

#### **Return Type**: Consistent with expr.

```sql
SELECT date_trunc('month', TIMESTAMP '2022-11-21T09:18:17');
```

```
+------------------------------------------------------+
| datetrunc(Utf8("month"),Utf8("2022-11-21T09:18:17")) |
+------------------------------------------------------+
| 2022-11-01T00:00:00                                  |
+------------------------------------------------------+
```

----------------

### **date_bin**

#### **Return Type**: DOUBLE.

```
date_bin(interval, source, origin)
```

Numeric type

Example

**Database**

**Approximate Aggregate Functions**

Syntax

#### **Return Type**: Consistent with expr.

```sql
SELECT date_bin(INTERVAL '1' DAY, TIMESTAMP '2022-11-21T09:10:24', TIMESTAMP '2022-11-01T00:00:00');
```

```
+------------------------------------------------------------------------------------------------+
| datebin(IntervalDayTime("4294967296"),Utf8("2022-11-21T09:10:24"),Utf8("2022-11-01T00:00:00")) |
+------------------------------------------------------------------------------------------------+
| 2022-11-21T00:00:00                                                                            |
+------------------------------------------------------------------------------------------------+
```

----------------

### **to_timestamp**

#### **Create Common (TSKV) Table**

```
to_timestamp(expr) 
```

Example

Example

Syntax

#### **Complex Grouping Operation**

```sql
SELECT to_timestamp('1970-01-01T00:00:00');
```

```
+------------------------------------------+
| totimestamp(Utf8("1970-01-01T00:00:00")) |
+------------------------------------------+
| 1970-01-01T00:00:00                      |
+------------------------------------------+
```

```sql
SELECT to_timestamp(1);
```

```
+-------------------------------+
| totimestamp(Int64(1))         |
+-------------------------------+
| 1970-01-01T00:00:00.000000001 |
+-------------------------------+
```

----------------

### **to_timestamp_millis**

#### **Return Type**: TimeVector

```
to_timestamp_millis(expr) 
```

Example

Example

Syntax

#### - (positive), - (negative), + (plus), + (series), - (minus)

```sql
SELECT to_timestamp_millis('1970-01-01T00:00:00.00301');
```

```
+------------------------------------------------------+
| totimestampmillis(Utf8("1970-01-01T00:00:00.00301")) |
+------------------------------------------------------+
| 1970-01-01T00:00:00.003                              |
+------------------------------------------------------+
```

```sql
SELECT to_timestamp_millis(1);
```

```
+-----------------------------+
| totimestampmillis(Int64(1)) |
+-----------------------------+
| 1970-01-01T00:00:00.001     |
+-----------------------------+
```

----------------

### **to_timestamp_micros**

#### **Alter Database Parameters**

```
to_timestamp_micros(expr) 
```

Example

Example

Syntax

#### operator include `=`, `!=`.

```sql
SELECT to_timestamp_micros(1)
```

```
+-----------------------------+
| totimestampmicros(Int64(1)) |
+-----------------------------+
| 1970-01-01T00:00:00.000001  |
+-----------------------------+
```

---------

### **to_timestamp_seconds**

#### **Return Type**: TIMESTAMP

```
to_timestamp_seconds(expr) 
```

Example

Example

Syntax

#### **Two-stage Aggregation Function**

```
SELECT to_timestamp_seconds(1);
```

```
+------------------------------+
| totimestampseconds(Int64(1)) |
+------------------------------+
| 1970-01-01T00:00:01          |
+------------------------------+
```

----------------

### **from_unixtime**

#### **Return Type**: TIMESTAMP

```
from_unixtime(unixTime) 
```

Boolean Type

Number type expressions are subtracted

Example

#### **Update tag column**

```
SELECT from_unixtime(1);
```

```
+------------------------+
| fromunixtime(Int64(1)) |
+------------------------+
| 1970-01-01T00:00:01    |
+------------------------+
```

----------------

### **now**

#### **Parameter Type**: STRING

```
now()
```

Syntax

Syntax

#### [Click to jump](#geometry)

```
SELECT now();
```

```
+----------------------------------+
| now()                            |
+----------------------------------+
| 2022-11-21T04:44:19.742107+00:00 |
+----------------------------------+
```

### **time_window**

#### **Parameter Type**: STRING

```sql
time_window(time_expr, window_duration [, slide_duration])
```

**Join Clause**

**Show All Databases**

**PARTITION BY Clause**

Numeric type

```sql
start, end
time, time_column + window_duration
time - slide_duration, time + window_duration - slide_duration
time - 2 * slide_duration, time + window_duration - 2 * slide_duration
...
time - n * slide_duration, time + window_duration - n * slide_duration
```

Data Type

#### **Parameter Type**: expr type is any type.

```sql
CREATE TABLE test(a BIGINT, TAGS(b));
INSERT INTO test(time, a, b) VALUES ('2023-04-23T00:00:00.000000Z', 1, 'b');
SELECT time FROM test;
```

```
+---------------------+
| time                |
+---------------------+
| 2023-04-23T00:00:00 |
+---------------------+
```

```sql
SELECT time_window(time, interval '3 day') FROM test;
```

```
+---------------------------------------------------------------------+
| TIME_WINDOW(test.time,IntervalMonthDayNano("55340232221128654848")) |
+---------------------------------------------------------------------+
| {start: 2023-04-23T00:00:00, end: 2023-04-26T00:00:00}              |
+---------------------------------------------------------------------+
```

```sql
SELECT time_window(time, interval '5 day', interval '3 day') FROM test;
```

```
+------------------------------------------------------------------------------------------------------------------+
| TIME_WINDOW(test.time,IntervalMonthDayNano("92233720368547758080"),IntervalMonthDayNano("55340232221128654848")) |
+------------------------------------------------------------------------------------------------------------------+
| {start: 2023-04-23T00:00:00, end: 2023-04-28T00:00:00}                                                           |
| {start: 2023-04-20T00:00:00, end: 2023-04-25T00:00:00}                                                           |
+------------------------------------------------------------------------------------------------------------------+
```

### 空间函数

**Stream**

#### ST_AsBinary

```
ST_AsBinary(geometry)
```

Example

Example

Example

Parameters Description

```sql
SELECT ST_AsBinary('POINT(0 3)');
```

```
+--------------------------------------------+
| st_AsBinary(Utf8("POINT(0 3)"))            |
+--------------------------------------------+
| 010100000000000000000000000000000000000840 |
+--------------------------------------------+
```

#### ST_GeomFromWKB

```
ST_GeomFromWKB(wkb)
```

Syntax

Example

`INTERVAL '1'` One second

String type expression concatenation

```sql
SELECT ST_GeomFromWKB(ST_AsBinary('POINT(0 3)'))
```

```
+-------------------------------------------------+
| st_GeomFromWKB(st_AsBinary(Utf8("POINT(0 3)"))) |
+-------------------------------------------------+
| POINT(0 3)                                      |
+-------------------------------------------------+
```

#### ST_Distance

```
ST_Distance(geometry1, gemometry2)
```

Syntax

Example

Syntax

Unsigned Integer

**Parameter Type**: expr type is any type.

```sql
SELECT ST_Distance('POINT(0 0)', 'LINESTRING (30 10, 10 30, 40 40)');
```

```
+----------------------------------------------------+
| st_distance(Utf8("POINT(1 0)"),Utf8("POINT(0 0)")) |
+----------------------------------------------------+
| 1.0                                                |
+----------------------------------------------------+
```

expr type is TIMESTAMP.

```sql
SELECT ST_Distance('POINT(0 0)', 'LINESTRING (30 10, 10 30, 40 40)');
```

```
+--------------------------------------------------------------------------+
| st_distance(Utf8("POINT(0 0)"),Utf8("LINESTRING (30 10, 10 30, 40 40)")) |
+--------------------------------------------------------------------------+
| 28.284271247461902                                                       |
+--------------------------------------------------------------------------+
```

**Return Type**: Timestamp

```sql
SELECT ST_Distance('POLYGON((0 2,1 1,0 -1,0 2))', 'POLYGON((-1 -3,-2 -1,0 -3,-1 -3))');
```

```
+--------------------------------------------------------------------------------------------+
| st_distance(Utf8("POLYGON((0 2,1 1,0 -1,0 2))"),Utf8("POLYGON((-1 -3,-2 -1,0 -3,-1 -3))")) |
+--------------------------------------------------------------------------------------------+
| 1.4142135623730951                                                                         |
+--------------------------------------------------------------------------------------------+
```

#### ST_Area

```
ST_Area(geometry)
```

Syntax面积单位与用于表示输入几何体坐标的单位相同。
对于点、线串、多点和多线串，此函数返回 0。
对于几何体集合，它返回集合中几何体的面积之和。

-ts: Timestamp

Syntax

Number type expressions divide

```sql
SELECT ST_Area('POLYGON ((40 40, 20 45, 45 30, 40 40))');
```

Example

> **GROUP BY Clause**
> 如果参数内容格式非法，返回值为 NULL。

#### ST_Equals

```
ST_Equals(A, B)
```

**功能**：比较两个几何体，如果两个几何体完全相同，则返回true

ST_Equals(A, B) 等价于 ST_Within(A, B) && ST_Within(B, A)

Example

Example

Integer type expressions are modulo

```sql
select ST_Equals(
    'LINESTRING(0 0, 10 10)', 
    'LINESTRING(0 0, 5 5, 10 10)'
) st_equals;
```

```
+-----------+
| st_equals |
+-----------+
| true      |
+-----------+
```

#### ST_Contains

```
ST_Contains(A, B)
```

**功能**：如果几何对象A包含几何对象B，返回True

ST_Contains(A, B) => ST_Within(B, A)

Example

Example

Syntax

```sql
select ST_Contains(
    'POLYGON((0 0,0 3,3 0,0 0))', 
    'POLYGON((0 0,0 1,1 0,0 0))'
) st_contains;
```

```
+-------------+
| st_contains |
+-------------+
| true        |
+-------------+
```

#### ST_Intersects

```
ST_Intersects(A, B)
```

**功能**：如果两个几何对象相交，则返回True

Example

Example

Syntax

```sql
select ST_Intersects(
    'LINESTRING(3 2, 7 6)',
    'LINESTRING(3 4, 8 4)'
) st_intersects;
```

```
+---------------+
| st_intersects |
+---------------+
| true          |
+---------------+
```

#### ST_Disjoint

```
ST_Disjoint(A, B)
```

**功能**： 如果两个几何对象不相接，返回True

Example

Example

Syntax

```sql
select ST_Disjoint(
    'LINESTRING(0 0,-3 -3)', 
    'LINESTRING(0 1,1 0)'
);
```

```
+-------------+
| st_disjoint |
+-------------+
| true        |
+-------------+
```

#### ST_Within

```
ST_Within(A, B)
```

**功能**：如果给定的Geometry对象A完全在对象B之内，则返回True

Example

Example

Syntax

```sql
select ST_Within(
    'POLYGON((1 1, 1 2, 2 2, 2 1, 1 1))',
    'POLYGON((0 0, 0 3, 3 3, 3 0, 0 0))'
);
```

```
+-----------+
| st_within |
+-----------+
| true      |
+-----------+
```

### Data Type

#### **Parameter Type**: STRING

```sql
Example
```

#### Example

#### **Return Type**: BIGINT UNSIGNED

| **Return Type**: BINARY |
| --------------------------------------- |
| DENSE_RANK         |
| PERCENT_RANK       |
| RANK                                    |
| ROW_NUMBER         |

**Update Data**

其中 `RANK`, `DENSE_RANK`, `ROW_NUMBER` 指定window_frame 无效

#### **Insert One Record**

详见[聚合函数](./sql.md#聚合函数)

#### **Return Type**: Numeric type

| **Return Type**: BINARY |
| --------------------------------------- |
| CUME_DIST          |
| LAG                                     |
| LEAD                                    |
| NTH_VALUE          |

#### Data Type

Example

#### Data Type

**Example**:

#### Data Type

**Return Type**: DOUBLE

**Create Database**

**Example**:

- **Import data**
- **Describe Table**
- **Interpolation Function**
- **Expression**
- **Alias Table**

#### **Return Type**: Double

- Example
- Example

## Data Type

**Return Type**: BINARY

### **ROW_NUMBER**

#### **Parameter Type**: STRING

```
ROW_NUMBER() OVER([partition_clause] [orderby_clause])
```

Example

Example

Syntax

#### **Update field column**

```sql
SELECT temperature, station, 
       ROW_NUMBER() OVER (PARTITION BY station) 
FROM air;
```

```
+-------------+-------------+--------------+
| temperature | station     | ROW_NUMBER() |
+-------------+-------------+--------------+
| 69          | LianYunGang | 1            |
| 80          | LianYunGang | 2            |
| 74          | LianYunGang | 3            |
| 70          | LianYunGang | 4            |
| 70          | LianYunGang | 5            |
| 70          | LianYunGang | 6            |
| 69          | XiaoMaiDao  | 1            |
| 78          | XiaoMaiDao  | 2            |
| 62          | XiaoMaiDao  | 3            |
| 79          | XiaoMaiDao  | 4            |
| 53          | XiaoMaiDao  | 5            |
| 72          | XiaoMaiDao  | 6            |
| 71          | XiaoMaiDao  | 7            |
+-------------+-------------+--------------+
```

----------------

### **RANK**

#### **Parameter Type**: STRING

```
RANK() OVER([partition_clause] [orderby_clause])
```

Example

Example

Syntax

#### **Create the database**

```sql
SELECT station, temperature, 
       RANK() OVER (PARTITION BY station ORDER BY temperature) 
FROM air;
```

```
+-------------+-------------+--------+
| station     | temperature | RANK() |
+-------------+-------------+--------+
| LianYunGang | 69          | 1      |
| LianYunGang | 70          | 2      |
| LianYunGang | 70          | 2      |
| LianYunGang | 70          | 2      |
| LianYunGang | 74          | 5      |
| LianYunGang | 80          | 6      |
| XiaoMaiDao  | 53          | 1      |
| XiaoMaiDao  | 62          | 2      |
| XiaoMaiDao  | 69          | 3      |
| XiaoMaiDao  | 71          | 4      |
| XiaoMaiDao  | 72          | 5      |
| XiaoMaiDao  | 78          | 6      |
| XiaoMaiDao  | 79          | 7      |
+-------------+-------------+--------+
```

----------------

### **DENSE_RANK**

#### **Parameter Type**: STRING

```
DENSE_RANK() OVER([partition_clause] [orderby_clause])
```

Example

Example

Syntax

#### =、&gt=、<=、<&gt、!=、&gt、<（Comparison operator)

```sql
SELECT station, temperature, 
       DENSE_RANK() OVER (PARTITION BY station ORDER BY temperature) 
FROM air;
```

```
+-------------+-------------+--------------+
| station     | temperature | DENSE_RANK() |
+-------------+-------------+--------------+
| LianYunGang | 69          | 1            |
| LianYunGang | 70          | 2            |
| LianYunGang | 70          | 2            |
| LianYunGang | 70          | 2            |
| LianYunGang | 74          | 3            |
| LianYunGang | 80          | 4            |
| XiaoMaiDao  | 53          | 1            |
| XiaoMaiDao  | 62          | 2            |
| XiaoMaiDao  | 69          | 3            |
| XiaoMaiDao  | 71          | 4            |
| XiaoMaiDao  | 72          | 5            |
| XiaoMaiDao  | 78          | 6            |
| XiaoMaiDao  | 79          | 7            |
+-------------+-------------+--------------+
```

----------------

### **PERCENT_RANK**

#### **Parameter Type**: STRING

```
PERCENT_RANK() OVER([partition_clause] [orderby_clause])
```

Example

Example

Syntax

#### **Describe Database Parameters**

```sql
 SELECT station, temperature, 
        PERCENT_RANK() OVER (PARTITION BY station ORDER BY temperature) 
 FROM air;
```

```
+-------------+-------------+---------------------+
| station     | temperature | PERCENT_RANK()      |
+-------------+-------------+---------------------+
| LianYunGang | 69          | 0                   |
| LianYunGang | 70          | 0.2                 |
| LianYunGang | 70          | 0.2                 |
| LianYunGang | 70          | 0.2                 |
| LianYunGang | 74          | 0.8                 |
| LianYunGang | 80          | 1                   |
| XiaoMaiDao  | 53          | 0                   |
| XiaoMaiDao  | 62          | 0.16666666666666666 |
| XiaoMaiDao  | 69          | 0.3333333333333333  |
| XiaoMaiDao  | 71          | 0.5                 |
| XiaoMaiDao  | 72          | 0.6666666666666666  |
| XiaoMaiDao  | 78          | 0.8333333333333334  |
| XiaoMaiDao  | 79          | 1                   |
+-------------+-------------+---------------------+
```

----------------

### **CUME_DIST**

#### **Parameter Type**: STRING

```
CUME_DIST() OVER ([partition_clause] [orderby_clause])
```

Example

Example

Syntax

#### **Parameter Type**: Binary

```sql
SELECT station, temperature, 
       CUME_DIST() OVER (PARTITION BY station ORDER BY temperature) 
FROM air;
```

```
+-------------+-------------+---------------------+
| station     | temperature | CUME_DIST()         |
+-------------+-------------+---------------------+
| LianYunGang | 69          | 0.16666666666666666 |
| LianYunGang | 70          | 0.6666666666666666  |
| LianYunGang | 70          | 0.6666666666666666  |
| LianYunGang | 70          | 0.6666666666666666  |
| LianYunGang | 74          | 0.8333333333333334  |
| LianYunGang | 80          | 1                   |
| XiaoMaiDao  | 53          | 0.14285714285714285 |
| XiaoMaiDao  | 62          | 0.2857142857142857  |
| XiaoMaiDao  | 69          | 0.42857142857142855 |
| XiaoMaiDao  | 71          | 0.5714285714285714  |
| XiaoMaiDao  | 72          | 0.7142857142857143  |
| XiaoMaiDao  | 78          | 0.8571428571428571  |
| XiaoMaiDao  | 79          | 1                   |
+-------------+-------------+---------------------+
```

[//]: # "----------------"
[//]: #
[//]: # "### **NTILE**"
[//]: #
[//]: # "    ntile(n) over([partition_clause] [order_by_clause])"
[//]: #
[//]: # "Example"
[//]: #
[//]: # "Example"
[//]: #
[//]: # "Syntax"

----------------

### **LAG**

#### **Parameter Type**: STRING

```
lag( expr [, offset [, default] ] ) OVER([partition_clause] orderby_clause)
```

Example

Example

**Operator Precedence**

**Drop Table**

Example

#### **Parameter Type**: Binary

```sql
SELECT station, temperature, 
       LAG(temperature, 2) OVER (PARTITION BY station ORDER BY temperature) 
FROM air;
```

```
+-------------+-------------+-------------------------------+
| station     | temperature | LAG(air.temperature,Int64(2)) |
+-------------+-------------+-------------------------------+
| LianYunGang | 69          |                               |
| LianYunGang | 70          |                               |
| LianYunGang | 70          | 69                            |
| LianYunGang | 70          | 70                            |
| LianYunGang | 74          | 70                            |
| LianYunGang | 80          | 70                            |
| XiaoMaiDao  | 53          |                               |
| XiaoMaiDao  | 62          |                               |
| XiaoMaiDao  | 69          | 53                            |
| XiaoMaiDao  | 71          | 62                            |
| XiaoMaiDao  | 72          | 69                            |
| XiaoMaiDao  | 78          | 71                            |
| XiaoMaiDao  | 79          | 72                            |
+-------------+-------------+-------------------------------+
```

----------------

### **LEAD**

#### **Parameter Type**: STRING

```
lead(expr [, offset [, default] ] ) OVER ([partition_clause] orderby_clause)
```

Example

Example

Syntax

**Table**

Example

#### **Common Aggregate Functions**

```sql
SELECT station, temperature, 
       LEAD(temperature, 2) OVER (PARTITION BY station ORDER BY temperature) 
FROM air;
```

```
+-------------+-------------+--------------------------------+
| station     | temperature | LEAD(air.temperature,Int64(2)) |
+-------------+-------------+--------------------------------+
| LianYunGang | 69          | 70                             |
| LianYunGang | 70          | 70                             |
| LianYunGang | 70          | 74                             |
| LianYunGang | 70          | 80                             |
| LianYunGang | 74          |                                |
| LianYunGang | 80          |                                |
| XiaoMaiDao  | 53          | 69                             |
| XiaoMaiDao  | 62          | 71                             |
| XiaoMaiDao  | 69          | 72                             |
| XiaoMaiDao  | 71          | 78                             |
| XiaoMaiDao  | 72          | 79                             |
| XiaoMaiDao  | 78          |                                |
| XiaoMaiDao  | 79          |                                |
+-------------+-------------+--------------------------------+
```

----------------

### **FIRST_VALUE**

#### **Parameter Type**: STRING

```
FIRST_VALUE(expr) OVER ([partition_clause] [orderby_clause])
```

Example

Example

Example

#### **Parameter Type**: BIGINT

```sql
SELECT station, temperature, 
       FIRST_VALUE(temperature) OVER (PARTITION BY station ORDER BY temperature) 
FROM air;
```

```
+-------------+-------------+------------------------------+
| station     | temperature | FIRST_VALUE(air.temperature) |
+-------------+-------------+------------------------------+
| LianYunGang | 69          | 69                           |
| LianYunGang | 70          | 69                           |
| LianYunGang | 70          | 69                           |
| LianYunGang | 70          | 69                           |
| LianYunGang | 74          | 69                           |
| LianYunGang | 80          | 69                           |
| XiaoMaiDao  | 53          | 53                           |
| XiaoMaiDao  | 62          | 53                           |
| XiaoMaiDao  | 69          | 53                           |
| XiaoMaiDao  | 71          | 53                           |
| XiaoMaiDao  | 72          | 53                           |
| XiaoMaiDao  | 78          | 53                           |
| XiaoMaiDao  | 79          | 53                           |
+-------------+-------------+------------------------------+
```

----------------

### **LAST_VALUE**

#### **Parameter Type**: STRING

```
LAST_VALUE(expr) OVER ([partition_clause] [orderby_clause])
```

Example

Example

Example

#### **Parameter Type**: BIGINT

```sql
SELECT station, temperature, 
       LAST_VALUE(temperature) OVER (PARTITION BY station ORDER BY temperature) 
FROM air;
```

```
+-------------+-------------+-----------------------------+
| station     | temperature | LAST_VALUE(air.temperature) |
+-------------+-------------+-----------------------------+
| LianYunGang | 69          | 69                          |
| LianYunGang | 70          | 70                          |
| LianYunGang | 70          | 70                          |
| LianYunGang | 70          | 70                          |
| LianYunGang | 74          | 74                          |
| LianYunGang | 80          | 80                          |
| XiaoMaiDao  | 53          | 53                          |
| XiaoMaiDao  | 62          | 62                          |
| XiaoMaiDao  | 69          | 69                          |
| XiaoMaiDao  | 71          | 71                          |
| XiaoMaiDao  | 72          | 72                          |
| XiaoMaiDao  | 78          | 78                          |
| XiaoMaiDao  | 79          | 79                          |
+-------------+-------------+-----------------------------+
```

----------------

### **NTH_VALUE**

#### **Parameter Type**: STRING

```
NTH_VALUE(expr, number) OVER ([partition_clause] [orderby_clause])
```

Example

Example

Example

#### **Parameter Type**: BIGINT

```sql
SELECT station, temperature, 
       NTH_VALUE(temperature, 2) OVER (PARTITION BY station ORDER BY temperature) 
FROM air;
```

```
+-------------+-------------+-------------------------------------+
| station     | temperature | NTH_VALUE(air.temperature,Int64(2)) |
+-------------+-------------+-------------------------------------+
| LianYunGang | 69          |                                     |
| LianYunGang | 70          | 70                                  |
| LianYunGang | 70          | 70                                  |
| LianYunGang | 70          | 70                                  |
| LianYunGang | 74          | 70                                  |
| LianYunGang | 80          | 70                                  |
| XiaoMaiDao  | 53          |                                     |
| XiaoMaiDao  | 62          | 62                                  |
| XiaoMaiDao  | 69          | 62                                  |
| XiaoMaiDao  | 71          | 62                                  |
| XiaoMaiDao  | 72          | 62                                  |
| XiaoMaiDao  | 78          | 62                                  |
| XiaoMaiDao  | 79          | 62                                  |
+-------------+-------------+-------------------------------------+
```

## Data Type

### Example

在数据库中，插值是用于处理数据中缺失值的技术。Syntax

### **time_window_gapfill**

**WITH Clause**Example

ExampleData Type

#### **Parameter Type**: STRING

- time_window_gapfill

```sql
time_window_gapfill(<time column>, <window interval>[, <sliding interval>[, <start time>]]): <time window struct>
```

#### **Insert Duplicate Data**

- interpolate

ExampleExample

线性插值适用于连续变量的估算，例如在时间序列中填补缺失值或在空间数据中进行插值。然而，线性插值的准确性和适用性取决于数据的特性和实际情况。在某些情况下，数据可能具有非线性关系，或存在其他更适合的插值方法。因此，在应用线性插值之前，需要仔细考虑数据的性质和插值的目的，以确保插值结果合理和准确。

```sql
interpolate(<expr>)
```

- locf

Example

Syntax具体处理方式如下：

1. Data Type
2. **UNION Clause**
3. **Parameters Type**:
4. **Data Query**
5. Example

Syntax这种方法假设缺失值之后的数据与最后观察到的值相同或非常接近。

SyntaxSyntax

```sql
locf(<expr>)
```

#### **Parameter Type**: BIGINT

```sql
Example
```

```sql
---- interpolate
SELECT
  t0,
  time_window_gapfill(time, interval '10 milliseconds') as minute,
  interpolate(avg(f1))
from gapfill_db.m2
where time between timestamp '1999-12-31T00:00:00.000Z' and timestamp '1999-12-31T00:00:00.055Z'
group by t0, minute;
```

```
+-------+-------------------------+-----------------------+
| t0    | minute                  | AVG(gapfill_db.m2.f1) |
+-------+-------------------------+-----------------------+
| tag11 | 1999-12-31T00:00:00     | 444.0                 |
| tag11 | 1999-12-31T00:00:00.010 | 499.5                 |
| tag11 | 1999-12-31T00:00:00.020 | 555.0                 |
| tag11 | 1999-12-31T00:00:00.030 |                       |
| tag11 | 1999-12-31T00:00:00.040 |                       |
| tag11 | 1999-12-31T00:00:00.050 |                       |
| tag12 | 1999-12-31T00:00:00     | 333.0                 |
| tag12 | 1999-12-31T00:00:00.010 | 388.5                 |
| tag12 | 1999-12-31T00:00:00.020 | 444.0                 |
| tag12 | 1999-12-31T00:00:00.030 |                       |
| tag12 | 1999-12-31T00:00:00.040 |                       |
| tag12 | 1999-12-31T00:00:00.050 |                       |
| tag13 | 1999-12-31T00:00:00     |                       |
| tag13 | 1999-12-31T00:00:00.010 | 222.0                 |
| tag13 | 1999-12-31T00:00:00.020 | 277.5                 |
| tag13 | 1999-12-31T00:00:00.030 | 333.0                 |
| tag13 | 1999-12-31T00:00:00.040 |                       |
| tag13 | 1999-12-31T00:00:00.050 |                       |
| tag14 | 1999-12-31T00:00:00     |                       |
| tag14 | 1999-12-31T00:00:00.010 | 111.0                 |
| tag14 | 1999-12-31T00:00:00.020 | 166.5                 |
| tag14 | 1999-12-31T00:00:00.030 | 222.0                 |
| tag14 | 1999-12-31T00:00:00.040 |                       |
| tag14 | 1999-12-31T00:00:00.050 |                       |
+-------+-------------------------+-----------------------+
```

```sql
---- locf
SELECT
  t0,
  time_window_gapfill(time, interval '10 milliseconds') as minute,
  locf(avg(f1))
from gapfill_db.m2
where time between timestamp '1999-12-31T00:00:00.000Z' and timestamp '1999-12-31T00:00:00.055Z'
group by t0, minute;
```

```
+-------+-------------------------+-----------------------+
| t0    | minute                  | AVG(gapfill_db.m2.f1) |
+-------+-------------------------+-----------------------+
| tag11 | 1999-12-31T00:00:00     | 444.0                 |
| tag11 | 1999-12-31T00:00:00.010 | 444.0                 |
| tag11 | 1999-12-31T00:00:00.020 | 555.0                 |
| tag11 | 1999-12-31T00:00:00.030 | 555.0                 |
| tag11 | 1999-12-31T00:00:00.040 | 555.0                 |
| tag11 | 1999-12-31T00:00:00.050 | 555.0                 |
| tag12 | 1999-12-31T00:00:00     | 333.0                 |
| tag12 | 1999-12-31T00:00:00.010 | 333.0                 |
| tag12 | 1999-12-31T00:00:00.020 | 444.0                 |
| tag12 | 1999-12-31T00:00:00.030 | 444.0                 |
| tag12 | 1999-12-31T00:00:00.040 | 444.0                 |
| tag12 | 1999-12-31T00:00:00.050 | 444.0                 |
| tag13 | 1999-12-31T00:00:00     |                       |
| tag13 | 1999-12-31T00:00:00.010 | 222.0                 |
| tag13 | 1999-12-31T00:00:00.020 | 222.0                 |
| tag13 | 1999-12-31T00:00:00.030 | 333.0                 |
| tag13 | 1999-12-31T00:00:00.040 | 333.0                 |
| tag13 | 1999-12-31T00:00:00.050 | 333.0                 |
| tag14 | 1999-12-31T00:00:00     |                       |
| tag14 | 1999-12-31T00:00:00.010 | 111.0                 |
| tag14 | 1999-12-31T00:00:00.020 | 111.0                 |
| tag14 | 1999-12-31T00:00:00.030 | 222.0                 |
| tag14 | 1999-12-31T00:00:00.040 | 222.0                 |
| tag14 | 1999-12-31T00:00:00.050 | 222.0                 |
+-------+-------------------------+-----------------------+
```

## Numeric type expressions add

**LIMIT Clause**

**Return Type** BIGINT

- CLUSTER_SCHEMA 关于数据库集群
- Integer

### **CLUSTER_SCHEMA**

Example

**Return Type**: STRING

### **TENANTS**

expr type is TIMESTAMP

#### **Insert Multiple Records**

| **Return Type**: Timestamp | **Window_frame Clause** | \*（plus）、/（division）、%（modular）              |
| ------------------------------------------ | -------------------------------------------- | -------------------------------------------- |
| TENANT_NAME           | STRING                                       | **Parameter Type**: Geometry |
| TENANT_OPTIONS        | STRING                                       | **ALL/DISTINCT**                             |

#### **Parameter Type**: Any type

```sql
SELECT * FROM cluster_schema.tenants;
```

```
+-------------+---------------------------------------------------+
| tenant_name | tenant_options                                    |
+-------------+---------------------------------------------------+
| cnosdb      | {"comment":"system tenant","limiter_config":null} |
+-------------+---------------------------------------------------+
```

### **USERS**

#### **Return Type**: Double

Syntax

| **Parameter Type**: any type | **Create External Table** | **Parameter Type**: Numeric type |
| -------------------------------------------- | ------------------------- | ------------------------------------------------ |
| USER_NAME               | STRING                    | **Parameter Type**:Any type      |
| IS_ADMIN                | BOOLEAN                   | **Parameter Type**: Numeric type |
| USER_OPTIONS            | STRING                    | **Alter Table**                                  |

#### **Parameter Type**: None

```sql
SELECT * FROM cluster_schema.users;
```

```
+-----------+----------+-------------------------------------------------------------------------------------------------+
| user_name | is_admin | user_options                                                                                    |
+-----------+----------+-------------------------------------------------------------------------------------------------+
| root      | true     | {"password":"*****","must_change_password":true,"rsa_public_key":null,"comment":"system admin"} |
+-----------+----------+-------------------------------------------------------------------------------------------------+
```

### **INFORMATION_SCHEMA**

**Return Type**: INTERVAL

### DATABASES

**Mathematical Functions**

#### **Return Type**: Double

| **Return Type**: BINARY | **`BETWEEN AND` Expression** | **Parameter Type**: Numeric type |
| --------------------------------------- | ---------------------------- | ------------------------------------------------ |
| TENANT_NAME        | STRING                       | **Return Type**: INTERVAL        |
| DATABASE_NAME      | STRING                       | **Return Type**: STRING          |
| TTL                                     | STRING                       | **Return Type**: BINARY          |
| SHARD                                   | BIGINT UNSIGNED              | 表示数据分片个数                                         |
| VNODE_DURATION     | STRING                       | **Return Type**: Double          |
| PREPLICA                                | BIGINT UNSIGNED              | 表示数据在集群中的副本数                                     |
| PERCISION                               | STRING                       | 表示数据库的时间精度                                       |

#### **Parameter Type**: None

```sql
SELECT * FROM information_schema.databases;
```

```
+-------------+---------------+----------+-------+----------------+---------+-----------+
| tenant_name | database_name | ttl      | shard | vnode_duration | replica | percision |
+-------------+---------------+----------+-------+----------------+---------+-----------+
| cnosdb      | public        | 365 Days | 1     | 365 Days       | 1       | NS        |
+-------------+---------------+----------+-------+----------------+---------+-----------+
```

### TABLES

**Return Type**:

#### **Return Type**: BIGINT

| **Return Type**: Binary | **Window Functions** | **Parameter Type**: Numeric type |
| --------------------------------------- | -------------------- | ------------------------------------------------ |
| TABLE_TENANT       | STRING               | 表所属的租户                                           |
| TABLE_DATABASE     | STRING               | **Parameter Type**: Numeric type |
| TABLE_NAME         | STRING               | **Parameter Type**: STRING       |
| TABLE_TYPE         | STRING               | 表是基础表，还是视图                                       |
| TABLE_ENGINE       | STRING               | **ORDER BY Clause**                              |
| TABLE_OPTION       | STRING               | Example                                          |

#### **Parameter Type**: None

```sql
SELECT * FROM information_schema.tables;
```

```
+--------------+----------------+------------+------------+--------------+---------------+
| table_tenant | table_database | table_name | table_type | table_engine | table_options |
+--------------+----------------+------------+------------+--------------+---------------+
| cnosdb       | public         | wind       | BASE TABLE | TSKV         | TODO          |
| cnosdb       | public         | air        | BASE TABLE | TSKV         | TODO          |
| cnosdb       | public         | sea        | BASE TABLE | TSKV         | TODO          |
+--------------+----------------+------------+------------+--------------+---------------+
```

### COLUMNS

**Return Type**:BIGINT

#### **Return Type**: BIGINT

| **Return Type**: BIGINT | ### **Regexp_Match** | **Parameter Type**: Numeric type |
| --------------------------------------- | ----------------------------------------- | ------------------------------------------------ |
| TABLE_TENANT       | STRING                                    | 表所属的租户                                           |
| TABLE_DATABASE     | STRING                                    | **Parameter Type**: Numeric type |
| TABLE_NAME         | STRING                                    | **Parameter Type**: None         |
| COLUMN_NAME        | STRING                                    | **Parameter Type**: STRING       |
| ORDINAL_POSITION   | STRING                                    | **Parameter Type**: None         |
| COLUMN_TYPE        | STRING                                    | Example                                          |
| IS_NULLABLE        | STRING                                    | Example                                          |
| DATA_TYPE          | STRING                                    | **Conditional Functions**                        |
| COMPRESSION_CODEC  | STRING                                    | **Example**:                     |

#### **Parameter Type**: STRING

```sql
SELECT * FROM information_schema.columns;
```

```
+-------------+---------------+------------+-------------+-------------+------------------+----------------+-------------+-----------+-------------------+
| tenant_name | database_name | table_name | column_name | column_type | ordinal_position | column_default | is_nullable | data_type | compression_codec |
+-------------+---------------+------------+-------------+-------------+------------------+----------------+-------------+-----------+-------------------+
| cnosdb      | public        | wind       | time        | TIME        | 0                | NULL           | false       | TIMESTAMP | DEFAULT           |
| cnosdb      | public        | wind       | station     | TAG         | 1                | NULL           | true        | STRING    | DEFAULT           |
| cnosdb      | public        | wind       | speed       | FIELD       | 2                | NULL           | true        | DOUBLE    | DEFAULT           |
| cnosdb      | public        | wind       | direction   | FIELD       | 3                | NULL           | true        | DOUBLE    | DEFAULT           |
| cnosdb      | public        | air        | time        | TIME        | 0                | NULL           | false       | TIMESTAMP | DEFAULT           |
| cnosdb      | public        | air        | station     | TAG         | 1                | NULL           | true        | STRING    | DEFAULT           |
| cnosdb      | public        | air        | visibility  | FIELD       | 2                | NULL           | true        | DOUBLE    | DEFAULT           |
| cnosdb      | public        | air        | temperature | FIELD       | 3                | NULL           | true        | DOUBLE    | DEFAULT           |
| cnosdb      | public        | air        | pressure    | FIELD       | 4                | NULL           | true        | DOUBLE    | DEFAULT           |
| cnosdb      | public        | sea        | time        | TIME        | 0                | NULL           | false       | TIMESTAMP | DEFAULT           |
| cnosdb      | public        | sea        | station     | TAG         | 1                | NULL           | true        | STRING    | DEFAULT           |
| cnosdb      | public        | sea        | temperature | FIELD       | 2                | NULL           | true        | DOUBLE    | DEFAULT           |
+-------------+---------------+------------+-------------+-------------+------------------+----------------+-------------+-----------+-------------------+
```

### ENABLED_ROLES

**Return Type**: BIGINT

#### **Return Type**: BIGINT

| **Return Type**: BIGINT | **Aggregate Function** | **Parameter Type**: Numeric type |
| --------------------------------------- | ---------------------- | ------------------------------------------------ |
| ROLE_NAME          | STRING                 | **Parameter Type**: STRING       |

#### **Parameter Type**: STRING

```sql
SELECT * FROM information_schema.enabled_roles;
```

```
+-----------+
| role_name |
+-----------+
| owner     |
+-----------+
```

### ROLES

**Return Type**: STRING
此视图只对当前租户的Owner可见。

#### **Return Type**: BIGINT

| **Return Type**: BIGINT | **Window Function List** | **Parameter Type**: Numeric type |
| --------------------------------------- | ------------------------ | ------------------------------------------------ |
| ROLE_NAME          | STRING                   | **Parameter Type**:              |
| ROLE_TYPE          | STRING                   | **Delete Data**                                  |
| INHERIT_ROLE       | STRING                   | **Example**:                     |

#### **Parameter Type**: STRING

```sql
SELECT * FROM information_schema.roles;
```

```
+-----------+-----------+--------------+
| role_name | role_type | inherit_role |
+-----------+-----------+--------------+
| owner     | system    |              |
| member    | system    |              |
+-----------+-----------+--------------+
```

### DATABASE_PRIVILEGES

#### **Return Type**: BIGINT

Number type expressions multiply
Syntax
Data Type

| **Return Type**: BIGINT | **`CASE WHEN` Expression** | **Parameter Type**: Numeric type |
| --------------------------------------- | -------------------------- | ------------------------------------------------ |
| TENANT_NAME        | STRING                     | **Return Type**: STRING          |
| DATABASE_NAME      | STRING                     | **Return Type**: STRING          |
| PRIVILEGE_TYPE     | STRING                     | Syntax                                           |
| ROLE_NAME          | STRING                     | **Return Type**: STRING          |

#### **Parameter Type**: STRING

```sql
CREATE ROLE rrr INHERIT member;
GRANT READ ON DATABASE air TO ROLE rrr;
SELECT * FROM information_schema.database_privileges;
```

```
+-------------+---------------+----------------+-----------+
| tenant_name | database_name | privilege_type | role_name |
+-------------+---------------+----------------+-----------+
| cnosdb      | air           | Read           | rrr       |
+-------------+---------------+----------------+-----------+
```

### MEMBERS

**Return Type**: DOUBLE

**Return Type**: Array

#### **Return Type**: BIGINT

| **Return Type**: BIGINT | **Alias Column Expression** | **Parameter Type**: Numeric type |
| --------------------------------------- | --------------------------- | ------------------------------------------------ |
| USER_NAME          | STRING                      | **Parameter Type**:              |
| ROLE_NAME          | STRING                      | **Return Type**: STRING          |

#### **Parameter Type**: STRING

```sql
SELECT * FROM information_schema.members;
```

```
+-----------+-----------+
| user_name | role_name |
+-----------+-----------+
| root      | owner     |
+-----------+-----------+
```

### QUERIES(INFORMATION_SCHEMA)

**Return Type**: DOUBLE

**Return Type**: BIGINT

Data Type

#### **Return Type**: BIGINT

| **Return Type**: BIGINT | **Create Table** | **Parameter Type**: Numeric type |
| --------------------------------------- | ---------------- | ------------------------------------------------ |
| QUERY_ID           | STRING           | **Return Type**: STRING          |
| QUERY_TEXT         | STRING           | **Return Type**: DOUBLE          |
| USER_ID            | STRING           | **Function Types**                               |
| USER_NAME          | STRING           | **Parameter Type** Geometry                      |
| TENANT_ID          | STRING           | **Return Type**: BIGINT          |
| TENANT_NAME        | STRING           | **Parameter Type**:              |
| STATE                                   | STRING           | Data Type                                        |
| DURATION                                | BIGINT UNSIGNED  | **Parameter Type**:              |

#### **Parameter Type**: STRING

```sql
SELECT * FROM information_schema.queries;
```

```
+----------+------------------------------------------------------------------+-----------------------------------------+-----------+----------------------------------------+-------------+------------+--------------+
| query_id | query_text                                                       | user_id                                 | user_name | tenant_id                              | tenant_name | state      | duration     |
+----------+------------------------------------------------------------------+-----------------------------------------+-----------+----------------------------------------+-------------+------------+--------------+
| 36       | select * FROM air join sea ON air.temperature = sea.temperature; | 108709109615072923019194003831375742761 | root      | 13215126763611749424716665303609634152 | cnosdb      | SCHEDULING | 12.693345666 |
+----------+------------------------------------------------------------------+-----------------------------------------+-----------+----------------------------------------+-------------+------------+--------------+
```

#### SHOW QUERIES

Data Type

#### **Parameter Type**: STRING

```sql
SHOW QUERIES;
```

```
+----------+------------------------------------------------------------------+-----------------------------------------+-----------+----------------------------------------+-------------+------------+--------------+
| query_id | query_text                                                       | user_id                                 | user_name | tenant_id                              | tenant_name | state      | duration     |
+----------+------------------------------------------------------------------+-----------------------------------------+-----------+----------------------------------------+-------------+------------+--------------+
| 36       | select * FROM air join sea ON air.temperature = sea.temperature; | 108709109615072923019194003831375742761 | root      | 13215126763611749424716665303609634152 | cnosdb      | SCHEDULING | 12.693345666 |
+----------+------------------------------------------------------------------+-----------------------------------------+-----------+----------------------------------------+-------------+------------+--------------+
```

## **USAGE_SCHEMA**

**Return Type**: DOUBLE

Data Type

Data Type

### VNODE_DISK_STORAGE

Example

#### **Return Type**: BIGINT

| **Return Type**: BIGINT | **SELECT Limitation** | **Parameter Type**: Numeric type |
| --------------------------------------- | --------------------- | ------------------------------------------------ |
| TIME                                    | TIMESTAMP             | **Return Type**: BIGINT          |
| DATABASE                                | STRING                | **Return Type**: STRING          |
| NODE_ID            | STRING                | **Return Type**: BIGINT          |
| TENANT                                  | STRING                | **Return Type**: STRING          |
| VNODE_ID           | STRING                | **Return Type**: STRING          |
| VALUE                                   | BIGINT UNSIGNED       | **Return Type**: STRING          |

Syntax

### HTTP_DATA_IN

Syntax

#### **Return Type**: BIGINT

| **Return Type**: BIGINT | **System Schema** | **Parameter Type**: Numeric type |
| --------------------------------------- | ----------------- | ------------------------------------------------ |
| TIME                                    | TIMESTAMP         | **Return Type**: BIGINT          |
| DATABASE                                | STRING            | **Return Type**: STRING          |
| NODE_ID            | STRING            | **Return Type**: DOUBLE          |
| TENANT                                  | STRING            | **Return Type**: STRING          |
| USER                                    | STRING            | **Parameter Type**: STRING       |
| HOST                                    | STRING            | 服务端口                                             |
| API                                     | STRING            | **Return Type**: DOUBLE          |
| VALUE                                   | BIGINT UNSIGNED   | **SELECT Clause**                                |

Syntax

## HTTP_DATA_OUT

Syntax

#### **Return Type**: DOUBLE

| **Parameter Type**: Numeric type | **ORDER BY Clause** | **Parameter Type**: Numeric type |
| ------------------------------------------------ | ------------------- | ------------------------------------------------ |
| TIME                                             | TIMESTAMP           | **Parameter Type**: Numeric type |
| DATABASE                                         | STRING              | **Return Type**: STRING          |
| NODE_ID                     | STRING              | **Return Type**: DOUBLE          |
| TENANT                                           | STRING              | **Return Type**: STRING          |
| USER                                             | STRING              | **Parameter Type**: STRING       |
| API                                              | STRING              | **Return Type**: DOUBLE          |
| HOST                                             | STRING              | 服务端口                                             |
| VALUE                                            | BIGINT UNSIGNED     | **Use Database**                                 |

Syntax

### HTTP_QUERIES

**Parameter Type**:

#### **Return Type**: DOUBLE

| **Parameter Type**: Numeric type | **String Functions** | **Parameter Type**: Numeric type |
| ------------------------------------------------ | -------------------- | ------------------------------------------------ |
| TIME                                             | TIMESTAMP            | **Parameter Type**: Numeric type |
| DATABASE                                         | STRING               | **Return Type**: DOUBLE          |
| NODE_ID                     | STRING               | **Return Type**: DOUBLE          |
| TENANT                                           | STRING               | **Parameter Type**:              |
| USER                                             | STRING               | **Return Type**: DOUBLE          |
| API                                              | STRING               | **Return Type**: DOUBLE          |
| HOST                                             | STRING               | 服务端口                                             |
| VALUE                                            | BIGINT UNSIGNED      | 用户查询次数                                           |

Syntax

### HTTP_WRITES

**Parameter Type**:

Example

#### **Return Type**: DOUBLE

| **Parameter Type**: Numeric type | **SQL Syntax**  | **Parameter Type**: Numeric type |
| ------------------------------------------------ | --------------- | ------------------------------------------------ |
| TIME                                             | TIMESTAMP       | **Parameter Type**: Numeric type |
| DATABASE                                         | STRING          | **Return Type**: DOUBLE          |
| NODE_ID                     | STRING          | **Return Type**: DOUBLE          |
| TENANT                                           | STRING          | **Parameter Type**:              |
| USER                                             | STRING          | **Return Type**: DOUBLE          |
| HOST                                             | STRING          | 服务端口                                             |
| API                                              | STRING          | **Return Type**: DOUBLE          |
| VALUE                                            | BIGINT UNSIGNED | 用户写入次数                                           |

Syntax

### COORD_DATA_IN

Syntax

#### **Return Type**: DOUBLE

| **Parameter Type**: Numeric type | Syntax          | **Parameter Type**: Numeric type |
| ------------------------------------------------ | --------------- | ------------------------------------------------ |
| **Parameter Type**: Numeric type | TIMESTAMP       | **Parameter Type**: Numeric type |
| **Parameter Type**: Numeric type | STRING          | **Return Type**: DOUBLE          |
| **Return Type**: DOUBLE          | STRING          | **Return Type**: DOUBLE          |
| **Numeric type**: DOUBLE         | STRING          | **Parameter Type**:              |
| **Return Type**: DOUBLE          | BIGINT UNSIGNED | **Return Type**: DOUBLE          |

Syntax

### COORD_DATA_OUT

**Return Type**: DOUBLE

#### **Return Type**: DOUBLE

| **Return Type**: DOUBLE | Syntax          | **Parameter Type**:     |
| --------------------------------------- | --------------- | --------------------------------------- |
| **Return Type**: DOUBLE | TIMESTAMP       | **Return Type**: DOUBLE |
| **Return Type**: DOUBLE | STRING          | **Return Type**: DOUBLE |
| **Return Type**: DOUBLE | STRING          | **Return Type**: DOUBLE |
| **Parameter Type**:     | STRING          | **Parameter Type**:     |
| **Return Type**: DOUBLE | BIGINT UNSIGNED | **Return Type**: DOUBLE |

Syntax

### COORD_QUERIES

记录通过Coordinator的接受数据次数

#### **Return Type**: DOUBLE

| **Return Type**: DOUBLE | Syntax          | **Return Type**: DOUBLE |
| --------------------------------------- | --------------- | --------------------------------------- |
| **Return Type**: DOUBLE | TIMESTAMP       | **Return Type**: DOUBLE |
| **Return Type**: DOUBLE | STRING          | **Return Type**: DOUBLE |
| **Return Type**: DOUBLE | STRING          | Example                                 |
| **Data Types**                          | STRING          | Example                                 |
| Data Type                               | BIGINT UNSIGNED | Syntax                                  |

Syntax

### COORD_WRITES

Example

#### Example

| Example | Syntax          | Example |
| ------- | --------------- | ------- |
| Example | TIMESTAMP       | Example |
| Example | STRING          | Example |
| Example | STRING          | Example |
| Example | STRING          | Example |
| Example | BIGINT UNSIGNED | Syntax  |

Syntax

### Syntax

```sql
SELECT * FROM usage_schema.http_data_in ORDER BY time DESC LIMIT 2;
```

```
+----------------------------+--------------+--------------+---------+--------+------+-------+-----------+
| time                       | api          | host         | node_id | tenant | user | value | database  |
+----------------------------+--------------+--------------+---------+--------+------+-------+-----------+
| 2023-10-18T08:41:09.948999 | api/v1/write | 0.0.0.0:8902 | 1001    | cnosdb | root | 144   | sqlancer2 |
| 2023-10-18T08:41:09.948995 | api/v1/write | 0.0.0.0:8902 | 1001    | cnosdb | root | 251   | sqlancer1 |
+----------------------------+--------------+--------------+---------+--------+------+-------+-----------+
```

## Syntax

### Syntax

Syntax

#### Syntax

```sql
Syntax
```

Syntax

Syntax

Syntax

#### Syntax

Syntax

```sql
CREATE DATABASE oceanic_station;
```

```
\c oceanic_station
```

```
CREATE TABLE air(pressure DOUBLE, temperature DOUBLE, visibility DOUBLE, TAGS(station));
```

Syntax

```sql
CREATE STREAM TABLE air_stream(time TIMESTAMP, station STRING, pressure DOUBLE, temperature DOUBLE, visibility DOUBLE) 
    WITH (db = 'oceanic_station', table = 'air', event_time_column = 'time')
    engine = tskv;
```

### 删除流表

> 与删除普通表语法相同，请参考[删除表](#删除表)

### Syntax

Syntax

Syntax

Syntax

Syntax

#### Syntax

Syntax

Syntax

```sql
CREATE TABLE air_down_sampling_1hour(max_pressure DOUBLE, avg_temperature DOUBLE, sum_temperature DOUBLE, count_pressure BIGINT, TAGS(station));
```

Syntax

```sql
INSERT INTO air_down_sampling_1hour(time, station, max_pressure, avg_temperature, sum_temperature, count_pressure) 
SELECT 
	date_bin(INTERVAL '1' HOUR, time, TIMESTAMP '2023-01-14T16:00:00') time, 
	station, 
	MAX(pressure) max_pressure, 
	AVG(temperature) avg_temperature, 
	SUM(temperature) sum_temperature, 
	COUNT(pressure) count_pressure 
FROM air_stream 
GROUP BY date_bin(INTERVAL '1' HOUR, time, TIMESTAMP '2023-01-14T16:00:00'), station;
```

Syntax

Syntax

```sql
\w oceanic_station.txt
```

Syntax

```sql
SELECT * FROM air_down_sampling_1hour LIMIT 10;
```

```
+---------------------+------------+--------------+-----------------+-----------------+----------------+
| time                | station    | max_pressure | avg_temperature | sum_temperature | count_pressure |
+---------------------+------------+--------------+-----------------+-----------------+----------------+
| 2023-01-14T16:00:00 | XiaoMaiDao | 80.0         | 68.05           | 1361.0          | 20             |
| 2023-01-14T17:00:00 | XiaoMaiDao | 79.0         | 63.75           | 1275.0          | 20             |
| 2023-01-14T18:00:00 | XiaoMaiDao | 79.0         | 66.35           | 1327.0          | 20             |
| 2023-01-14T19:00:00 | XiaoMaiDao | 78.0         | 68.05           | 1361.0          | 20             |
| 2023-01-14T20:00:00 | XiaoMaiDao | 80.0         | 64.35           | 1287.0          | 20             |
| 2023-01-14T21:00:00 | XiaoMaiDao | 77.0         | 61.05           | 1221.0          | 20             |
| 2023-01-14T22:00:00 | XiaoMaiDao | 80.0         | 64.8            | 1296.0          | 20             |
| 2023-01-14T23:00:00 | XiaoMaiDao | 80.0         | 66.35           | 1327.0          | 20             |
| 2023-01-15T00:00:00 | XiaoMaiDao | 80.0         | 65.15           | 1303.0          | 20             |
| 2023-01-15T01:00:00 | XiaoMaiDao | 80.0         | 69.55           | 1391.0          | 20             |
+---------------------+------------+--------------+-----------------+-----------------+----------------+
```

## **KILL QUERY**

### Syntax

```sql
KILL [QUERY] query_id;
```

Syntax

## Syntax

```sql
SHOW QUERIES;
```

```
+----------+------+------------------------------------------------------------------+------------+----------+
| query_id | user | query                                                            | state      | duration |
+----------+------+------------------------------------------------------------------+------------+----------+
| 4        | root | select * from air join sea on air.temperature = sea.temperature; | SCHEDULING | 2703     |
| 5        | root | show queries;                                                    | SCHEDULING | 0        |
+----------+------+------------------------------------------------------------------+------------+----------+
```

```sql
KILL 4;
```

```
Query took 0.016 seconds.
```
